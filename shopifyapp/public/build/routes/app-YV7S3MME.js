import{a as Rv}from"/build/_shared/chunk-6UARRT53.js";import{a as pl}from"/build/_shared/chunk-W64OBUQM.js";import{a as dl}from"/build/_shared/chunk-S5VEJNDF.js";import"/build/_shared/chunk-ZBDK2LSI.js";import{a as Av}from"/build/_shared/chunk-5TRFQBKG.js";import{a as rl,b as Nr,c as nl,d as ol,e as Ot,f as Ss,g as il,h as sl,i as Wn,k as al,l as cl,o as Fn,s as ul}from"/build/_shared/chunk-I75X6G2I.js";import{a as Sv,b as ll}from"/build/_shared/chunk-3RWUHEQO.js";import{a as m,b as p,c as Vt,d as it,e as R}from"/build/_shared/chunk-G5WX4PPA.js";var H={};Vt(H,{__addDisposableResource:()=>Hl,__assign:()=>Jn,__asyncDelegator:()=>Rl,__asyncGenerator:()=>Al,__asyncValues:()=>xl,__await:()=>Gt,__awaiter:()=>vl,__classPrivateFieldGet:()=>Tl,__classPrivateFieldIn:()=>ql,__classPrivateFieldSet:()=>Il,__createBinding:()=>Bn,__decorate:()=>ml,__disposeResources:()=>kl,__esDecorate:()=>xv,__exportStar:()=>bl,__extends:()=>fl,__generator:()=>wl,__importDefault:()=>Ol,__importStar:()=>Pl,__makeTemplateObject:()=>Cl,__metadata:()=>gl,__param:()=>yl,__propKey:()=>Pv,__read:()=>Rs,__rest:()=>hl,__runInitializers:()=>Cv,__setFunctionName:()=>Ov,__spread:()=>_l,__spreadArray:()=>Sl,__spreadArrays:()=>El,__values:()=>jn,default:()=>qv});function fl(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");As(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function hl(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function ml(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(o<3?s(i):o>3?s(t,r,i):s(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function yl(e,t){return function(r,n){t(r,n,e)}}function xv(e,t,r,n,o,i){function s(xe){if(xe!==void 0&&typeof xe!="function")throw new TypeError("Function expected");return xe}for(var a=n.kind,c=a==="getter"?"get":a==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,l=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,h=!1,f=r.length-1;f>=0;f--){var y={};for(var b in n)y[b]=b==="access"?{}:n[b];for(var b in n.access)y.access[b]=n.access[b];y.addInitializer=function(xe){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(xe||null))};var J=(0,r[f])(a==="accessor"?{get:l.get,set:l.set}:l[c],y);if(a==="accessor"){if(J===void 0)continue;if(J===null||typeof J!="object")throw new TypeError("Object expected");(d=s(J.get))&&(l.get=d),(d=s(J.set))&&(l.set=d),(d=s(J.init))&&o.unshift(d)}else(d=s(J))&&(a==="field"?o.unshift(d):l[c]=d)}u&&Object.defineProperty(u,n.name,l),h=!0}function Cv(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function Pv(e){return typeof e=="symbol"?e:"".concat(e)}function Ov(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function gl(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function vl(e,t,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function a(l){try{u(n.next(l))}catch(d){s(d)}}function c(l){try{u(n.throw(l))}catch(d){s(d)}}function u(l){l.done?i(l.value):o(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})}function wl(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(r=0)),r;)try{if(n=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(l){u=[6,l],o=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function bl(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Bn(t,e,r)}function jn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rs(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}function _l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Rs(arguments[t]));return e}function El(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function Sl(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function Gt(e){return this instanceof Gt?(this.v=e,this):new Gt(e)}function Al(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),o,i=[];return o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o;function s(h){n[h]&&(o[h]=function(f){return new Promise(function(y,b){i.push([h,f,y,b])>1||a(h,f)})})}function a(h,f){try{c(n[h](f))}catch(y){d(i[0][3],y)}}function c(h){h.value instanceof Gt?Promise.resolve(h.value.v).then(u,l):d(i[0][2],h)}function u(h){a("next",h)}function l(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Rl(e){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,i){t[o]=e[o]?function(s){return(r=!r)?{value:Gt(e[o](s)),done:!1}:i?i(s):s}:i}}function xl(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof jn=="function"?jn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(s){return new Promise(function(a,c){s=e[i](s),o(a,c,s.done,s.value)})}}function o(i,s,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},s)}}function Cl(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Pl(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Bn(t,e,r);return Tv(t,e),t}function Ol(e){return e&&e.__esModule?e:{default:e}}function Tl(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function Il(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r}function ql(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Hl(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}function kl(e){function t(n){e.error=e.hasError?new Iv(n,e.error,"An error was suppressed during disposal."):n,e.hasError=!0}function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,function(i){return t(i),r()})}catch(i){t(i)}}if(e.hasError)throw e.error}return r()}var As,Jn,Bn,Tv,Iv,qv,k=m(()=>{As=function(e,t){return As=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},As(e,t)};Jn=function(){return Jn=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Jn.apply(this,arguments)};Bn=Object.create?function(e,t,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};Tv=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};Iv=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};qv={__extends:fl,__assign:Jn,__rest:hl,__decorate:ml,__param:yl,__metadata:gl,__awaiter:vl,__generator:wl,__createBinding:Bn,__exportStar:bl,__values:jn,__read:Rs,__spread:_l,__spreadArrays:El,__spreadArray:Sl,__await:Gt,__asyncGenerator:Al,__asyncDelegator:Rl,__asyncValues:xl,__makeTemplateObject:Cl,__importStar:Pl,__importDefault:Ol,__classPrivateFieldGet:Tl,__classPrivateFieldSet:Il,__classPrivateFieldIn:ql,__addDisposableResource:Hl,__disposeResources:kl}});var W=p(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.FeatureDeprecatedError=_.BillingError=_.InvalidRequestError=_.UnsupportedClientType=_.MissingRequiredArgument=_.SessionStorageError=_.MissingWebhookCallbackError=_.InvalidWebhookError=_.InvalidSession=_.CookieNotFound=_.BotActivityDetected=_.InvalidOAuthError=_.GraphqlQueryError=_.RestResourceError=_.HttpThrottlingError=_.HttpInternalError=_.HttpRetriableError=_.HttpResponseError=_.HttpMaxRetriesError=_.HttpRequestError=_.PrivateAppError=_.SafeCompareError=_.InvalidDeliveryMethodError=_.MissingJwtTokenError=_.InvalidJwtError=_.InvalidHostError=_.InvalidShopError=_.InvalidHmacError=_.ShopifyError=void 0;var Hv=(k(),R(H)),N=class extends Error{constructor(...t){super(...t),Object.setPrototypeOf(this,new.target.prototype)}};_.ShopifyError=N;var xs=class extends N{};_.InvalidHmacError=xs;var Cs=class extends N{};_.InvalidShopError=Cs;var Ps=class extends N{};_.InvalidHostError=Ps;var Os=class extends N{};_.InvalidJwtError=Os;var Ts=class extends N{};_.MissingJwtTokenError=Ts;var Is=class extends N{};_.InvalidDeliveryMethodError=Is;var qs=class extends N{};_.SafeCompareError=qs;var Hs=class extends N{};_.PrivateAppError=Hs;var ks=class extends N{};_.HttpRequestError=ks;var $s=class extends N{};_.HttpMaxRetriesError=$s;var Vn=class extends N{constructor({message:t,code:r,statusText:n,body:o,headers:i}){super(t),this.response={code:r,statusText:n,body:o,headers:i}}};_.HttpResponseError=Vn;var Dr=class extends Vn{};_.HttpRetriableError=Dr;var Ms=class extends Dr{};_.HttpInternalError=Ms;var Ns=class extends Dr{constructor(t){var{retryAfter:r}=t,n=Hv.__rest(t,["retryAfter"]);super(n),this.response.retryAfter=r}};_.HttpThrottlingError=Ns;var Ds=class extends N{};_.RestResourceError=Ds;var Us=class extends N{constructor({message:t,response:r,headers:n}){super(t),this.response=r,this.headers=n}};_.GraphqlQueryError=Us;var Ls=class extends N{};_.InvalidOAuthError=Ls;var Ks=class extends N{};_.BotActivityDetected=Ks;var Ws=class extends N{};_.CookieNotFound=Ws;var Fs=class extends N{};_.InvalidSession=Fs;var Gn=class extends N{constructor({message:t,response:r}){super(t),this.response=r}};_.InvalidWebhookError=Gn;var Js=class extends Gn{};_.MissingWebhookCallbackError=Js;var js=class extends N{};_.SessionStorageError=js;var Bs=class extends N{};_.MissingRequiredArgument=Bs;var Vs=class extends N{};_.UnsupportedClientType=Vs;var Gs=class extends N{};_.InvalidRequestError=Gs;var zs=class extends N{constructor({message:t,errorData:r}){super(t),this.message=t,this.errorData=r}};_.BillingError=zs;var Xs=class extends N{};_.FeatureDeprecatedError=Xs});var Qs=p(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});st.crypto=st.setCrypto=void 0;var Ys;st.crypto=Ys;try{st.crypto=Ys=crypto}catch{}function kv(e){st.crypto=Ys=e}st.setCrypto=kv});var Tt=p(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.HashFormat=void 0;var $v;(function(e){e.Base64="base64",e.Hex="hex"})($v=Ur.HashFormat||(Ur.HashFormat={}))});var ta=p($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.hashString=$e.asBase64=$e.asHex=$e.createSHA256HMAC=void 0;var Mv=(k(),R(H)),Nv=W(),Lr=Qs(),Xn=Tt();function Dv(e,t,r=Xn.HashFormat.Base64){return Mv.__awaiter(this,void 0,void 0,function*(){let n=typeof(Lr.crypto===null||Lr.crypto===void 0?void 0:Lr.crypto.webcrypto)>"u"?Lr.crypto:Lr.crypto.webcrypto;if(n?.subtle){let o=new TextEncoder,i=yield n.subtle.importKey("raw",o.encode(e),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),s=yield n.subtle.sign("HMAC",i,o.encode(t));return r===Xn.HashFormat.Base64?ea(s):Zs(s)}return n.createHmac("sha256",e).update(t).digest(r)})}$e.createSHA256HMAC=Dv;function Zs(e){return[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join("")}$e.asHex=Zs;var zn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ea(e){let t="",r=new Uint8Array(e);for(let n=0;n<r.length;){let o=r[n++],i=r[n++],s=r[n++],a=o>>2,c=(o&3)<<4|i>>4,u=(i&15)<<2|s>>6,l=s&63;isNaN(i)&&(u=64),isNaN(s)&&(l=64),t+=zn[a]+zn[c]+zn[u]+zn[l]}return t}$e.asBase64=ea;function Uv(e,t){let r=new TextEncoder().encode(e);switch(t){case Xn.HashFormat.Base64:return ea(r);case Xn.HashFormat.Hex:return Zs(r);default:throw new Nv.ShopifyError(`Unrecognized hash format '${t}'`)}}$e.hashString=Uv});var ra=p(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.splitN=void 0;function Lv(e,t,r){let n=e.split(t),o=Math.min(Math.abs(r),n.length);return[...n.slice(0,o-1),n.slice(o-1).join(t)]}Yn.splitN=Lv});var na=p(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.flatHeaders=X.removeHeader=X.canonicalizeHeaders=X.addHeader=X.setHeader=X.getHeader=X.getHeaders=X.canonicalizeHeaderName=void 0;function It(e){return e.replace(/(^|-)(\w+)/g,(t,r,n)=>r+n.slice(0,1).toUpperCase()+n.slice(1).toLowerCase())}X.canonicalizeHeaderName=It;function Ml(e,t){let r=[];if(!e)return r;let n=It(t);for(let[o,i]of Object.entries(e))It(o)===n&&(Array.isArray(i)?r.push(...i):r.push(i));return r}X.getHeaders=Ml;function Kv(e,t){var r;if(e)return(r=Ml(e,t))===null||r===void 0?void 0:r[0]}X.getHeader=Kv;function Wv(e,t,r){Qn(e),e[It(t)]=[r]}X.setHeader=Wv;function Fv(e,t,r){Qn(e);let n=It(t),o=e[n];o?Array.isArray(o)||(o=[o]):o=[],e[n]=o,o.push(r)}X.addHeader=Fv;function $l(e){return typeof e=="number"?e.toString():e}function Qn(e){for(let[t,r]of Object.entries(e)){let n=It(t);e[n]||(e[n]=[]),Array.isArray(e[n])||(e[n]=[$l(e[n])]),t!==n&&(delete e[t],e[n].push(...[r].flat().map(o=>$l(o))))}return e}X.canonicalizeHeaders=Qn;function Jv(e,t){Qn(e);let r=It(t);delete e[r]}X.removeHeader=Jv;function jv(e){return Object.entries(e).flatMap(([t,r])=>Array.isArray(r)?r.map(n=>[t,n]):[[t,r]])}X.flatHeaders=jv});var Ul=p(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.Cookies=void 0;var oa=(k(),R(H)),Nl=ta(),Dl=ra(),Zn=na(),qt=class{constructor(t,r,{keys:n=[]}={}){var o,i;this.response=r,this.receivedCookieJar={},this.outgoingCookieJar={},this.keys=[],n&&(this.keys=n);let s=(o=(0,Zn.getHeader)(t.headers,"Cookie"))!==null&&o!==void 0?o:"";this.receivedCookieJar=qt.parseCookies(s.split(";"));let a=(i=(0,Zn.getHeaders)(r.headers,"Set-Cookie"))!==null&&i!==void 0?i:[];this.outgoingCookieJar=qt.parseCookies(a)}static parseCookies(t){let r=t.filter(o=>o.trim().length>0).map(o=>{let[i,...s]=o.split(";"),[a,c]=(0,Dl.splitN)(i,"=",2).map(u=>u.trim());return[a,Object.assign({name:a,value:c},Object.fromEntries(s.map(u=>(0,Dl.splitN)(u,"=",2).map(l=>l.trim()))))]}),n=Object.fromEntries(r);for(let o of Object.values(n))typeof o.expires=="string"&&(o.expires=new Date(o.expires));return n}static encodeCookie(t){let r="";return r+=`${t.name}=${t.value};`,r+=Object.entries(t).filter(([n])=>!["name","value","expires"].includes(n)).map(([n,o])=>`${n}=${o}`).join("; "),t.expires&&(r+=";",r+=`expires=${t.expires.toUTCString()}`),r}toHeaders(){return Object.values(this.outgoingCookieJar).map(t=>qt.encodeCookie(t))}updateHeader(){this.response.headers||(this.response.headers={}),(0,Zn.removeHeader)(this.response.headers,"Set-Cookie"),this.toHeaders().map(t=>(0,Zn.addHeader)(this.response.headers,"Set-Cookie",t))}get(t){var r;return(r=this.receivedCookieJar[t])===null||r===void 0?void 0:r.value}deleteCookie(t){this.set(t,"",{path:"/",expires:new Date(0)})}getAndVerify(t){return oa.__awaiter(this,void 0,void 0,function*(){let r=this.get(t);if(r&&(yield this.isSignedCookieValid(t)))return r})}get canSign(){var t;return((t=this.keys)===null||t===void 0?void 0:t.length)>0}set(t,r,n={}){this.outgoingCookieJar[t]=Object.assign(Object.assign({},n),{name:t,value:r}),this.updateHeader()}setAndSign(t,r,n={}){return oa.__awaiter(this,void 0,void 0,function*(){if(!this.canSign)throw Error("No keys provided for signing.");this.set(t,r,n);let o=`${t}.sig`,i=yield(0,Nl.createSHA256HMAC)(this.keys[0],r);this.set(o,i,n),this.updateHeader()})}isSignedCookieValid(t){return oa.__awaiter(this,void 0,void 0,function*(){let r=`${t}.sig`;if(!this.get(t)||!this.get(r))return this.deleteCookie(r),this.deleteCookie(t),!1;let n=this.get(t),o=this.get(r);return(yield Promise.all(this.keys.map(s=>(0,Nl.createSHA256HMAC)(s,n)))).includes(o)?!0:(this.deleteCookie(r),this.deleteCookie(t),!1)})}};eo.Cookies=qt});var Kl=p(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0})});var je=p(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.setAbstractConvertHeadersFunc=O.abstractConvertHeaders=O.setAbstractConvertResponseFunc=O.abstractConvertResponse=O.setAbstractConvertIncomingResponseFunc=O.abstractConvertIncomingResponse=O.setAbstractConvertRequestFunc=O.abstractConvertRequest=O.setAbstractFetchFunc=O.abstractFetch=O.isOK=void 0;var to=(k(),R(H));to.__exportStar(Ul(),O);to.__exportStar(na(),O);to.__exportStar(ra(),O);to.__exportStar(Kl(),O);function Bv(e){return e.statusCode>=200&&e.statusCode<=299}O.isOK=Bv;var Vv=()=>{throw new Error("Missing adapter implementation for 'abstractFetch' - make sure to import the appropriate adapter for your platform")};O.abstractFetch=Vv;function Gv(e){O.abstractFetch=e}O.setAbstractFetchFunc=Gv;var zv=()=>{throw new Error("Missing adapter implementation for 'abstractConvertRequest' - make sure to import the appropriate adapter for your platform")};O.abstractConvertRequest=zv;function Xv(e){O.abstractConvertRequest=e}O.setAbstractConvertRequestFunc=Xv;var Yv=()=>Promise.resolve({});O.abstractConvertIncomingResponse=Yv;function Qv(e){O.abstractConvertIncomingResponse=e}O.setAbstractConvertIncomingResponseFunc=Qv;var Zv=()=>{throw new Error("Missing adapter implementation for 'abstractConvertResponse' - make sure to import the appropriate adapter for your platform")};O.abstractConvertResponse=Zv;function e0(e){O.abstractConvertResponse=e}O.setAbstractConvertResponseFunc=e0;var t0=()=>{throw new Error("Missing adapter implementation for 'abstractConvertHeaders' - make sure to import the appropriate adapter for your platform")};O.abstractConvertHeaders=t0;function r0(e){O.abstractConvertHeaders=e}O.setAbstractConvertHeadersFunc=r0});var Ht=p(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});var ia=(k(),R(H));ia.__exportStar(Tt(),Kr);ia.__exportStar(Qs(),Kr);ia.__exportStar(ta(),Kr)});var Fl=p(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0})});var Jl=p(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.setAbstractRuntimeString=kt.abstractRuntimeString=void 0;var n0=()=>{throw new Error("Missing adapter implementation for 'abstractRuntimeString' - make sure to import the appropriate adapter for your platform")};kt.abstractRuntimeString=n0;function o0(e){kt.abstractRuntimeString=e}kt.setAbstractRuntimeString=o0});var no=p(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});var jl=(k(),R(H));jl.__exportStar(Fl(),ro);jl.__exportStar(Jl(),ro)});var Fr=p(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});var sa=(k(),R(H));sa.__exportStar(je(),Wr);sa.__exportStar(Ht(),Wr);sa.__exportStar(no(),Wr)});var Vl=p(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.webApiRuntimeString=Ee.webApiFetch=Ee.webApiConvertResponse=Ee.webApiConvertHeaders=Ee.webApiConvertRequest=void 0;var io=(k(),R(H)),oo=Fr();function i0(e){var t;return io.__awaiter(this,void 0,void 0,function*(){let r=e.rawRequest,n={};for(let[o,i]of r.headers.entries())(0,oo.addHeader)(n,o,i);return{headers:n,method:(t=r.method)!==null&&t!==void 0?t:"GET",url:new URL(r.url).toString()}})}Ee.webApiConvertRequest=i0;function Bl(e,t){return io.__awaiter(this,void 0,void 0,function*(){let r=new Headers;return(0,oo.flatHeaders)(e??{}).forEach(([n,o])=>r.append(n,o)),Promise.resolve(r)})}Ee.webApiConvertHeaders=Bl;function s0(e,t){var r;return io.__awaiter(this,void 0,void 0,function*(){return new Response(e.body,{status:e.statusCode,statusText:e.statusText,headers:yield Bl((r=e.headers)!==null&&r!==void 0?r:{},t)})})}Ee.webApiConvertResponse=s0;function a0({headers:e,method:t,url:r,body:n}){return io.__awaiter(this,void 0,void 0,function*(){let o=yield fetch(r,{method:t,headers:(0,oo.flatHeaders)(e),body:n}),i=yield o.text();return{statusCode:o.status,statusText:o.statusText,body:i,headers:(0,oo.canonicalizeHeaders)(Object.fromEntries(o.headers.entries()))}})}Ee.webApiFetch=a0;function c0(){return"Web API"}Ee.webApiRuntimeString=c0});var zl=p(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});var Jr=Fr(),jr=Vl();(0,Jr.setAbstractFetchFunc)(jr.webApiFetch);(0,Jr.setAbstractConvertRequestFunc)(jr.webApiConvertRequest);(0,Jr.setAbstractConvertResponseFunc)(jr.webApiConvertResponse);(0,Jr.setAbstractConvertHeadersFunc)(jr.webApiConvertHeaders);(0,Jr.setAbstractRuntimeString)(jr.webApiRuntimeString)});var ao={};Vt(ao,{compare:()=>ed,compareVersions:()=>Zl,satisfies:()=>l0,validate:()=>u0});var Zl,u0,ed,l0,td,so,Xl,Yl,d0,p0,zt,rd,Ql,f0,co=m(()=>{Zl=(e,t)=>{let r=so(e),n=so(t),o=r.pop(),i=n.pop(),s=zt(r,n);return s!==0?s:o&&i?zt(o.split("."),i.split(".")):o||i?o?-1:1:0},u0=e=>typeof e=="string"&&/^[v\d]/.test(e)&&td.test(e),ed=(e,t,r)=>{f0(r);let n=Zl(e,t);return rd[r].includes(n)},l0=(e,t)=>{let r=t.match(/^([<>=~^]+)/),n=r?r[1]:"=";if(n!=="^"&&n!=="~")return ed(e,t,n);let[o,i,s,,a]=so(e),[c,u,l,,d]=so(t),h=[o,i,s],f=[c,u??"x",l??"x"];if(d&&(!a||zt(h,f)!==0||zt(a.split("."),d.split("."))===-1))return!1;let y=f.findIndex(J=>J!=="0")+1,b=n==="~"?2:y>1?y:1;return!(zt(h.slice(0,b),f.slice(0,b))!==0||zt(h.slice(b),f.slice(b))===-1)},td=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,so=e=>{if(typeof e!="string")throw new TypeError("Invalid argument expected string");let t=e.match(td);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},Xl=e=>e==="*"||e==="x"||e==="X",Yl=e=>{let t=parseInt(e,10);return isNaN(t)?e:t},d0=(e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t],p0=(e,t)=>{if(Xl(e)||Xl(t))return 0;let[r,n]=d0(Yl(e),Yl(t));return r>n?1:r<n?-1:0},zt=(e,t)=>{for(let r=0;r<Math.max(e.length,t.length);r++){let n=p0(e[r]||"0",t[r]||"0");if(n!==0)return n}return 0},rd={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},Ql=Object.keys(rd),f0=e=>{if(typeof e!="string")throw new TypeError(`Invalid operator type, expected string but got ${typeof e}`);if(Ql.indexOf(e)===-1)throw new Error(`Invalid operator, expected one of ${Ql.join("|")}`)}});var be=p(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.BillingReplacementBehavior=D.BillingInterval=D.gdprTopics=D.ClientType=D.ShopifyHeader=D.LATEST_API_VERSION=D.LIBRARY_NAME=D.ApiVersion=D.LogSeverity=void 0;var h0;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Debug=3]="Debug"})(h0=D.LogSeverity||(D.LogSeverity={}));var nd;(function(e){e.April22="2022-04",e.July22="2022-07",e.October22="2022-10",e.January23="2023-01",e.April23="2023-04",e.July23="2023-07",e.Unstable="unstable"})(nd=D.ApiVersion||(D.ApiVersion={}));D.LIBRARY_NAME="Shopify API Library";D.LATEST_API_VERSION=nd.July23;var m0;(function(e){e.AccessToken="X-Shopify-Access-Token",e.ApiVersion="X-Shopify-API-Version",e.Domain="X-Shopify-Shop-Domain",e.Hmac="X-Shopify-Hmac-Sha256",e.Topic="X-Shopify-Topic",e.WebhookId="X-Shopify-Webhook-Id",e.StorefrontAccessToken="X-Shopify-Storefront-Access-Token",e.StorefrontSDKVariant="X-SDK-Variant",e.StorefrontSDKVersion="X-SDK-Version"})(m0=D.ShopifyHeader||(D.ShopifyHeader={}));var y0;(function(e){e.Rest="rest",e.Graphql="graphql"})(y0=D.ClientType||(D.ClientType={}));D.gdprTopics=["CUSTOMERS_DATA_REQUEST","CUSTOMERS_REDACT","SHOP_REDACT"];var g0;(function(e){e.OneTime="ONE_TIME",e.Every30Days="EVERY_30_DAYS",e.Annual="ANNUAL",e.Usage="USAGE"})(g0=D.BillingInterval||(D.BillingInterval={}));var v0;(function(e){e.ApplyImmediately="APPLY_IMMEDIATELY",e.ApplyOnNextBillingCycle="APPLY_ON_NEXT_BILLING_CYCLE",e.Standard="STANDARD"})(v0=D.BillingReplacementBehavior||(D.BillingReplacementBehavior={}))});var Xt=p(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.SHOPIFY_API_LIBRARY_VERSION=void 0;uo.SHOPIFY_API_LIBRARY_VERSION="7.5.0"});var od=p(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.log=void 0;var lo=be();function w0(e){return function(t,r,n={}){if(t>e.logger.level)return;let o=[];e.logger.timestamps&&o.push(`${new Date().toISOString().slice(0,-5)}Z`);let i=n.package||"shopify-api";switch(delete n.package,t){case lo.LogSeverity.Debug:i=`${i}/DEBUG`;break;case lo.LogSeverity.Info:i=`${i}/INFO`;break;case lo.LogSeverity.Warning:i=`${i}/WARNING`;break;case lo.LogSeverity.Error:i=`${i}/ERROR`;break}o.push(i);let s=[];Object.entries(n).forEach(([c,u])=>{s.push(`${c}: ${u}`)});let a="";s.length>0&&(a=` | {${s.join(", ")}}`),e.logger.log(t,`[${o.join("] [")}] ${r}${a}`)}}po.log=w0});var me=p(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.logger=void 0;var fo=(k(),R(H)),b0=(co(),R(ao)),Br=be(),_0=W(),E0=Xt(),S0=od();function A0(e){let t=(0,S0.log)(e);return{log:t,debug:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Br.LogSeverity.Debug,r,n)}),info:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Br.LogSeverity.Info,r,n)}),warning:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Br.LogSeverity.Warning,r,n)}),error:(r,n={})=>fo.__awaiter(this,void 0,void 0,function*(){return t(Br.LogSeverity.Error,r,n)}),deprecated:R0(t)}}ho.logger=A0;function R0(e){return function(t,r){if((0,b0.compare)(E0.SHOPIFY_API_LIBRARY_VERSION,t,">="))throw new _0.FeatureDeprecatedError(`Feature was deprecated in version ${t}`);return e(Br.LogSeverity.Warning,`[Deprecated | ${t}] ${r}`)}}});var id=p(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.loadRestResources=void 0;var x0=me();function C0({resources:e,config:t,RestClient:r}){let n=Object.keys(e)[0];return t.apiVersion!==e[n].apiVersion&&(0,x0.logger)(t).warning(`Loading REST resources for API version ${e[n].apiVersion}, which doesn't match the default ${t.apiVersion}`),Object.fromEntries(Object.entries(e).map(([o,i])=>{class s extends i{}return s.setClassProperties({Client:r,config:t}),Object.entries(s.hasOne).map(([a,c])=>{c.setClassProperties({Client:r,config:t})}),Object.entries(s.hasMany).map(([a,c])=>{c.setClassProperties({Client:r,config:t})}),Reflect.defineProperty(s,"name",{value:o}),[o,s]}))}mo.loadRestResources=C0});var aa=p(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.AuthScopes=void 0;var Ce=class{constructor(t){let r=[];typeof t=="string"?r=t.split(new RegExp(`${Ce.SCOPE_DELIMITER}\\s*`)):Array.isArray(t)?r=t:t&&(r=Array.from(t.expandedScopes)),r=r.map(s=>s.trim()).filter(s=>s.length);let n=this.getImpliedScopes(r),o=new Set(r),i=new Set(n);this.compressedScopes=new Set([...o].filter(s=>!i.has(s))),this.expandedScopes=new Set([...o,...i])}has(t){let r;return t instanceof Ce?r=t:r=new Ce(t),r.toArray().filter(n=>!this.expandedScopes.has(n)).length===0}equals(t){let r;return t instanceof Ce?r=t:r=new Ce(t),this.compressedScopes.size===r.compressedScopes.size&&this.toArray().filter(n=>!r.has(n)).length===0}toString(){return this.toArray().join(Ce.SCOPE_DELIMITER)}toArray(){return[...this.compressedScopes]}getImpliedScopes(t){return t.reduce((r,n)=>{let o=n.match(/^(unauthenticated_)?write_(.*)$/);return o&&r.push(`${o[1]?o[1]:""}read_${o[2]}`),r},[])}};yo.AuthScopes=Ce;Ce.SCOPE_DELIMITER=","});var sd=p(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.enableCodeAfterVersion=void 0;var P0=(co(),R(ao)),O0=Xt();function T0(e,t){(0,P0.compare)(O0.SHOPIFY_API_LIBRARY_VERSION,e,">=")&&t()}go.enableCodeAfterVersion=T0});var cd=p(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.validateConfig=void 0;var I0=(k(),R(H)),q0=W(),Yt=be(),ca=aa(),ad=me(),H0=sd();function k0(e){var t;let r={apiKey:"",apiSecretKey:"",scopes:new ca.AuthScopes([]),hostName:"",hostScheme:"https",apiVersion:Yt.LATEST_API_VERSION,isEmbeddedApp:!0,isCustomStoreApp:!1,logger:{log:M0,level:Yt.LogSeverity.Info,httpRequests:!1,timestamps:!1}},n=["apiSecretKey","hostName"];(!("isCustomStoreApp"in e)||!e.isCustomStoreApp)&&(n.push("apiKey"),n.push("scopes")),(0,H0.enableCodeAfterVersion)("8.0.0",()=>{var y;"isCustomStoreApp"in e&&e.isCustomStoreApp&&(!("adminApiAccessToken"in e)||((y=e.adminApiAccessToken)===null||y===void 0?void 0:y.length)===0)&&n.push("adminApiAccessToken")});let o=[];if(n.forEach(y=>{$0(e[y])||o.push(y)}),o.length)throw new q0.ShopifyError(`Cannot initialize Shopify API Library. Missing values for: ${o.join(", ")}`);let{hostScheme:i,isCustomStoreApp:s,adminApiAccessToken:a,userAgentPrefix:c,logger:u,privateAppStorefrontAccessToken:l,customShopDomains:d,billing:h}=e,f=I0.__rest(e,["hostScheme","isCustomStoreApp","adminApiAccessToken","userAgentPrefix","logger","privateAppStorefrontAccessToken","customShopDomains","billing"]);return Object.assign(r,f,{hostName:e.hostName.replace(/\/$/,""),scopes:e.scopes instanceof ca.AuthScopes?e.scopes:new ca.AuthScopes(e.scopes),hostScheme:i??r.hostScheme,isCustomStoreApp:s??r.isCustomStoreApp,adminApiAccessToken:a??r.adminApiAccessToken,userAgentPrefix:c??r.userAgentPrefix,logger:Object.assign(Object.assign({},r.logger),u||{}),privateAppStorefrontAccessToken:l??r.privateAppStorefrontAccessToken,customShopDomains:d??r.customShopDomains,billing:h??r.billing}),"isCustomStoreApp"in e&&e.isCustomStoreApp&&(!("adminApiAccessToken"in e)||((t=e.adminApiAccessToken)===null||t===void 0?void 0:t.length)===0?(0,ad.logger)(r).deprecated("8.0.0","adminApiAccessToken should be set to the Admin API access token for custom store apps; apiSecretKey should be set to the custom store app's API secret key."):e.adminApiAccessToken===e.apiSecretKey&&(0,ad.logger)(r).warning("adminApiAccessToken is set to the same value as apiSecretKey. adminApiAccessToken should be set to the Admin API access token for custom store apps; apiSecretKey should be set to the custom store app's API secret key.")),r}vo.validateConfig=k0;function $0(e){return e==null?!1:typeof e=="string"||Array.isArray(e)?e.length>0:!0}function M0(e,t){switch(e){case Yt.LogSeverity.Debug:console.debug(t);break;case Yt.LogSeverity.Info:console.log(t);break;case Yt.LogSeverity.Warning:console.warn(t);break;case Yt.LogSeverity.Error:console.error(t);break}}});var ud=p(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.Method=void 0;(function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Patch="PATCH",e.Delete="DELETE",e.Head="HEAD",e.Options="OPTIONS",e.Connect="CONNECT"})(A.Method||(A.Method={}));A.StatusCode=void 0;(function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported"})(A.StatusCode||(A.StatusCode={}));A.Header=void 0;(function(e){e.Accept="Accept",e.AcceptEncoding="Accept-Encoding",e.AcceptLanguage="Accept-Language",e.AccessControlAllowCredentials="Access-Control-Allow-Credentials",e.AccessControlAllowHeaders="Access-Control-Allow-Headers",e.AccessControlAllowMethods="Access-Control-Allow-Methods",e.AccessControlAllowOrigin="Access-Control-Allow-Origin",e.AccessControlExposeHeaders="Access-Control-Expose-Headers",e.AccessControlMaxAge="Access-Control-Max-Age",e.AccessControlRequestHeaders="Access-Control-Request-Headers",e.AccessControlRequestMethod="Access-Control-Request-Method",e.Authorization="Authorization",e.CacheControl="Cache-Control",e.CacheStatus="Cache-Status",e.Connection="Connection",e.ContentDisposition="Content-Disposition",e.ContentEncoding="Content-Encoding",e.ContentLength="Content-Length",e.ContentSecurityPolicy="Content-Security-Policy",e.ContentSecurityPolicyReportOnly="Content-Security-Policy-Report-Only",e.ContentType="Content-Type",e.ContentTypeOptions="X-Content-Type-Options",e.Cookie="Cookie",e.DownloadOptions="X-Download-Options",e.ETag="ETag",e.Forwarded="Forwarded",e.ForwardedFor="X-Forwarded-For",e.ForwardedHost="X-Forwarded-Host",e.ForwardedProtocol="X-Forwarded-Proto",e.FrameOptions="X-Frame-Options",e.Host="Host",e.IfNoneMatch="If-None-Match",e.Location="Location",e.Origin="Origin",e.ReferrerPolicy="Referrer-Policy",e.ServerTiming="Server-Timing",e.StrictTransportSecurity="Strict-Transport-Security",e.TimingAllowOrigin="Timing-Allow-Origin",e.Trailer="Trailer",e.TransferEncoding="Transfer-Encoding",e.UserAgent="User-Agent",e.WwwAuthenticate="WWW-Authenticate",e.XhrRedirectedTo="X-XHR-Redirected-To",e.XhrReferer="X-XHR-Referer",e.XssProtecton="X-XSS-Protection",e.XContentTypeOptions="X-Content-Type-Options",e.XDownloadOptions="X-Download-Options",e.XForwardedFor="X-Forwarded-For",e.XForwardedHost="X-Forwarded-Host",e.XForwardedProto="X-Forwarded-Proto",e.XFrameOptions="X-Frame-Options",e.XXhrRedirectedTo="X-XHR-Redirected-To",e.XXhrReferer="X-XHR-Referer",e.XXssProtecton="X-XSS-Protection",e.XXssProtection="X-XSS-Protection"})(A.Header||(A.Header={}));A.CspDirective=void 0;(function(e){e.ChildSrc="child-src",e.ConnectSrc="connect-src",e.DefaultSrc="default-src",e.FontSrc="font-src",e.FrameSrc="frame-src",e.ImgSrc="img-src",e.ManifestSrc="manifest-src",e.MediaSrc="media-src",e.ObjectSrc="object-src",e.PrefetchSrc="prefetch-src",e.ScriptSrc="script-src",e.StyleSrc="style-src",e.WebrtcSrc="webrtc-src",e.WorkerSrc="worker-src",e.BaseUri="base-uri",e.PluginTypes="plugin-types",e.Sandbox="sandbox",e.FormAction="form-action",e.FrameAncestors="frame-ancestors",e.ReportUri="report-uri",e.BlockAllMixedContent="block-all-mixed-content",e.RequireSriFor="require-sri-for",e.UpgradeInsecureRequests="upgrade-insecure-requests"})(A.CspDirective||(A.CspDirective={}));A.CspSandboxAllow=void 0;(function(e){e.Forms="allow-forms",e.SameOrigin="allow-same-origin",e.Scripts="allow-scripts",e.Popups="allow-popups",e.Modals="allow-modals",e.OrientationLock="allow-orientation-lock",e.PointerLock="allow-pointer-lock",e.Presentation="allow-presentation",e.PopupsToEscapeSandbox="allow-popups-to-escape-sandbox",e.TopNavigation="allow-top-navigation"})(A.CspSandboxAllow||(A.CspSandboxAllow={}));A.SpecialSource=void 0;(function(e){e.Any="*",e.Self="'self'",e.UnsafeInline="'unsafe-inline'",e.UnsafeEval="'unsafe-eval'",e.None="'none'",e.StrictDynamic="'strict-dynamic'",e.ReportSample="'report-sample'",e.Data="data:",e.Blob="blob:",e.FileSystem="filesystem:"})(A.SpecialSource||(A.SpecialSource={}));A.SriAsset=void 0;(function(e){e.Script="script",e.Style="style"})(A.SriAsset||(A.SriAsset={}));A.HashAlgorithm=void 0;(function(e){e.Sha256="sha256",e.Sha384="sha384",e.Sha512="sha512"})(A.HashAlgorithm||(A.HashAlgorithm={}));A.ResponseType=void 0;(function(e){e.Informational="1xx",e.Success="2xx",e.Redirection="3xx",e.ClientError="4xx",e.ServerError="5xx",e.Unknown="Unknown"})(A.ResponseType||(A.ResponseType={}));function N0(e){return e>=100&&e<200?A.ResponseType.Informational:e>=200&&e<300?A.ResponseType.Success:e>=300&&e<400?A.ResponseType.Redirection:e>=400&&e<500?A.ResponseType.ClientError:e>=500&&e<600?A.ResponseType.ServerError:A.ResponseType.Unknown}function D0(e){return`'nonce-${e}'`}function U0(e,t){return`'${e}-${t}'`}A.CacheControl=void 0;(function(e){e.NoCache="no-cache",e.NoStore="no-store",e.MustRevalidate="must-revalidate",e.MaxAge="max-age"})(A.CacheControl||(A.CacheControl={}));var L0=`${A.CacheControl.NoCache},${A.CacheControl.NoStore},${A.CacheControl.MustRevalidate},${A.CacheControl.MaxAge}=0`;A.getResponseType=N0;A.hashSource=U0;A.noCache=L0;A.nonceSource=D0});var ld=p(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});var ye=ud();Object.defineProperty(oe,"CacheControl",{enumerable:!0,get:function(){return ye.CacheControl}});Object.defineProperty(oe,"CspDirective",{enumerable:!0,get:function(){return ye.CspDirective}});Object.defineProperty(oe,"CspSandboxAllow",{enumerable:!0,get:function(){return ye.CspSandboxAllow}});Object.defineProperty(oe,"HashAlgorithm",{enumerable:!0,get:function(){return ye.HashAlgorithm}});Object.defineProperty(oe,"Header",{enumerable:!0,get:function(){return ye.Header}});Object.defineProperty(oe,"Method",{enumerable:!0,get:function(){return ye.Method}});Object.defineProperty(oe,"ResponseType",{enumerable:!0,get:function(){return ye.ResponseType}});Object.defineProperty(oe,"SpecialSource",{enumerable:!0,get:function(){return ye.SpecialSource}});Object.defineProperty(oe,"SriAsset",{enumerable:!0,get:function(){return ye.SriAsset}});Object.defineProperty(oe,"StatusCode",{enumerable:!0,get:function(){return ye.StatusCode}});oe.getResponseType=ye.getResponseType;oe.hashSource=ye.hashSource;oe.noCache=ye.noCache;oe.nonceSource=ye.nonceSource});var ua=p((H1,dd)=>{dd.exports=ld()});var wo=p(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});var Vr=class{constructor(){this.processedQuery=new URLSearchParams}static stringify(t){return!t||Object.keys(t).length===0?"":new Vr().putAll(t).stringify()}putAll(t){return Object.entries(t).forEach(([r,n])=>this.put(r,n)),this}put(t,r){Array.isArray(r)?this.putArray(t,r):r?.constructor===Object?this.putObject(t,r):this.putSimple(t,r)}putArray(t,r){r.forEach(n=>this.processedQuery.append(`${t}[]`,`${n}`))}putObject(t,r){Object.entries(r).forEach(([n,o])=>{this.processedQuery.append(`${t}[${n}]`,`${o}`)})}putSimple(t,r){this.processedQuery.append(t,`${r}`)}stringify(t=!1){let r=this.processedQuery.toString();return t?r:`?${r}`}};la.default=Vr});var zr=p(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.DataType=void 0;var K0;(function(e){e.JSON="application/json",e.GraphQL="application/graphql",e.URLEncoded="application/x-www-form-urlencoded"})(K0=Gr.DataType||(Gr.DataType={}))});var er=p(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.httpClientClass=Zt.HttpClient=void 0;var Be=(k(),R(H)),at=ua(),ct=Be.__importStar(W()),W0=be(),F0=Xt(),J0=Be.__importDefault(wo()),j0=Ht(),B0=Tt(),Qt=je(),V0=no(),pd=me(),bo=zr(),ut=class{constructor(t){this.loggedDeprecations={},this.domain=t.domain}get(t){return Be.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Get},t))})}post(t){return Be.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Post},t))})}put(t){return Be.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Put},t))})}delete(t){return Be.__awaiter(this,void 0,void 0,function*(){return this.request(Object.assign({method:at.Method.Delete},t))})}request(t){var r;return Be.__awaiter(this,void 0,void 0,function*(){let n=t.tries?t.tries:1;if(n<=0)throw new ct.HttpRequestError(`Number of tries must be >= 0, got ${n}`);let o=`${W0.LIBRARY_NAME} v${F0.SHOPIFY_API_LIBRARY_VERSION} | ${(0,V0.abstractRuntimeString)()}`;this.httpClass().config.userAgentPrefix&&(o=`${this.httpClass().config.userAgentPrefix} | ${o}`),t.extraHeaders&&(t.extraHeaders["user-agent"]?(o=`${t.extraHeaders["user-agent"]} | ${o}`,delete t.extraHeaders["user-agent"]):t.extraHeaders["User-Agent"]&&(o=`${t.extraHeaders["User-Agent"]} | ${o}`));let i=Object.assign(Object.assign({},t.extraHeaders),{"User-Agent":o}),s;if(t.method===at.Method.Post||t.method===at.Method.Put){let d=(r=t.type)!==null&&r!==void 0?r:bo.DataType.JSON,h=t.data;if(h){switch(d){case bo.DataType.JSON:s=typeof h=="string"?h:JSON.stringify(h);break;case bo.DataType.URLEncoded:s=typeof h=="string"?h:new URLSearchParams(h).toString();break;case bo.DataType.GraphQL:s=h;break}i=Object.assign(Object.assign({},i),{"Content-Type":d,"Content-Length":new TextEncoder().encode(s).length})}}let a=`${this.httpClass().scheme}://${this.domain}${this.getRequestPath(t.path)}${J0.default.stringify(t.query)}`,c={method:t.method,url:a,headers:(0,Qt.canonicalizeHeaders)(i),body:s};if(this.httpClass().config.logger.httpRequests){let d=["Making HTTP request",`${c.method} ${c.url}`,`Headers: ${JSON.stringify(i)}`];s&&d.push(`Body: ${JSON.stringify(s).replace(/\n/g,"\\n  ")}`),(0,pd.logger)(this.httpClass().config).debug(d.join("  -  "))}function u(d){return Be.__awaiter(this,void 0,void 0,function*(){return new Promise(h=>setTimeout(h,d))})}let l=0;for(;l<n;)try{return yield this.doRequest(c)}catch(d){if(l++,d instanceof ct.HttpRetriableError){if(l<n){let h=this.httpClass().RETRY_WAIT_TIME;d instanceof ct.HttpThrottlingError&&d.response.retryAfter&&(h=d.response.retryAfter*1e3),yield u(h);continue}if(n>1)throw new ct.HttpMaxRetriesError(`Exceeded maximum retry count of ${n}. Last message: ${d.message}`)}throw d}throw new ct.ShopifyError("Unexpected flow, reached maximum HTTP tries but did not throw an error")})}getRequestPath(t){return`/${t.replace(/^\//,"")}`}httpClass(){return this.constructor}throwFailedRequest(t,r){let n=[];t.errors&&n.push(JSON.stringify(t.errors,null,2));let o=(0,Qt.getHeader)(r.headers,"x-request-id");o&&n.push(`If you report this error, please include this id: ${o}`);let i=n.length?`:
${n.join(`
`)}`:"",s=r.headers?r.headers:{},a=r.statusCode,c=r.statusText;switch(!0){case r.statusCode===at.StatusCode.TooManyRequests:{let u=(0,Qt.getHeader)(r.headers,"Retry-After");throw new ct.HttpThrottlingError({message:`Shopify is throttling requests${i}`,code:a,statusText:c,body:t,headers:s,retryAfter:u?parseFloat(u):void 0})}case r.statusCode>=at.StatusCode.InternalServerError:throw new ct.HttpInternalError({message:`Shopify internal error${i}`,code:a,statusText:c,body:t,headers:s});default:throw new ct.HttpResponseError({message:`Received an error response (${r.statusCode} ${r.statusText}) from Shopify${i}`,code:a,statusText:c,body:t,headers:s})}}doRequest(t){var r;return Be.__awaiter(this,void 0,void 0,function*(){let n=(0,pd.logger)(this.httpClass().config),o=yield(0,Qt.abstractFetch)(t);this.httpClass().config.logger.httpRequests&&n.debug(`Completed HTTP request, received ${o.statusCode} ${o.statusText}`);let i={};if(o.body)try{i=JSON.parse(o.body)}catch{i=o.body}(0,Qt.isOK)(o)||this.throwFailedRequest(i,o);let s=(0,Qt.getHeader)(o.headers,"X-Shopify-API-Deprecated-Reason");if(s){let a={message:s,path:t.url};t.body&&(a.body=`${t.body.substring(0,100)}...`);let c=yield(0,j0.createSHA256HMAC)(this.httpClass().config.apiSecretKey,JSON.stringify(a),B0.HashFormat.Hex);if(!Object.keys(this.loggedDeprecations).includes(c)||Date.now()-this.loggedDeprecations[c]>=ut.DEPRECATION_ALERT_DELAY){this.loggedDeprecations[c]=Date.now();let u=new Error().stack,l=`API Deprecation Notice ${new Date().toLocaleString()} : ${JSON.stringify(a)}  -  Stack Trace: ${u}`;yield n.warning(l)}}return{body:i,headers:(r=o.headers)!==null&&r!==void 0?r:{}}})}};Zt.HttpClient=ut;ut.RETRY_WAIT_TIME=1e3;ut.DEPRECATION_ALERT_DELAY=3e5;function G0(e,t="https"){class r extends ut{}return r.config=e,r.scheme=t,Reflect.defineProperty(r,"name",{value:"HttpClient"}),r}Zt.httpClientClass=G0});var hd=p(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.restClientClass=tr.RestClient=void 0;var fd=(k(),R(H)),z0=je(),X0=be(),Y0=fd.__importStar(W()),Q0=er(),Z0=me(),Ve=class extends Q0.HttpClient{constructor(t){super({domain:t.session.shop});let r=this.restClass().config;if(!r.isCustomStoreApp&&!t.session.accessToken)throw new Y0.MissingRequiredArgument("Missing access token when creating REST client");if(t.apiVersion){let n=t.apiVersion===r.apiVersion?`REST client has a redundant API version override to the default ${t.apiVersion}`:`REST client overriding default API version ${r.apiVersion} with ${t.apiVersion}`;(0,Z0.logger)(r).debug(n)}this.session=t.session,this.apiVersion=t.apiVersion}request(t){let r=Object.create(null,{request:{get:()=>super.request}});var n,o,i;return fd.__awaiter(this,void 0,void 0,function*(){let s=(n=this.restClass().config.adminApiAccessToken)!==null&&n!==void 0?n:this.restClass().config.apiSecretKey;t.extraHeaders=Object.assign({[X0.ShopifyHeader.AccessToken]:this.restClass().config.isCustomStoreApp?s:this.session.accessToken},t.extraHeaders);let a=yield r.request.call(this,t),c=(0,z0.getHeader)(a.headers,"link");if(c!==void 0){let u={limit:!((o=t.query)===null||o===void 0)&&o.limit?(i=t.query)===null||i===void 0?void 0:i.limit.toString():Ve.DEFAULT_LIMIT};if(c){let l=c.split(", ");for(let d of l){let h=d.match(Ve.LINK_HEADER_REGEXP);if(!h)continue;let f=h[2],y=new URL(h[1]),b=y.searchParams.get("fields"),J=y.searchParams.get("page_info");if(!u.fields&&b&&(u.fields=b.split(",")),J)switch(f){case"previous":u.previousPageUrl=h[1],u.prevPage=this.buildRequestParams(h[1]);break;case"next":u.nextPageUrl=h[1],u.nextPage=this.buildRequestParams(h[1]);break}}}a.pageInfo=u}return a})}getRequestPath(t){let r=super.getRequestPath(t);return r.startsWith("/admin")?`${r.replace(/\.json$/,"")}.json`:`/admin/api/${this.apiVersion||this.restClass().config.apiVersion}${r.replace(/\.json$/,"")}.json`}restClass(){return this.constructor}buildRequestParams(t){let r="^/admin/api/[^/]+/(.*).json$",n=new URL(t);return{path:n.pathname.replace(new RegExp(r),"$1"),query:Object.fromEntries(n.searchParams.entries())}}};tr.RestClient=Ve;Ve.LINK_HEADER_REGEXP=/<([^<]+)>; rel="([^"]+)"/;Ve.DEFAULT_LIMIT="50";function ew(e){let{config:t}=e;class r extends Ve{}return r.config=t,r.scheme="https",Reflect.defineProperty(r,"name",{value:"RestClient"}),r}tr.restClientClass=ew});var Ge=p(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.graphqlClientClass=rr.GraphqlClient=void 0;var yd=(k(),R(H)),tw=be(),rw=er(),md=zr(),nw=me(),da=yd.__importStar(W()),_o=class{constructor(t){this.baseApiPath="/admin/api";let r=this.graphqlClass().config;if(!r.isCustomStoreApp&&!t.session.accessToken)throw new da.MissingRequiredArgument("Missing access token when creating GraphQL client");if(t.apiVersion){let n=t.apiVersion===r.apiVersion?`GraphQL client has a redundant API version override to the default ${t.apiVersion}`:`GraphQL client overriding default API version ${r.apiVersion} with ${t.apiVersion}`;(0,nw.logger)(r).debug(n)}this.session=t.session,this.apiVersion=t.apiVersion,this.client=new(this.graphqlClass()).HttpClient({domain:this.session.shop})}query(t){var r,n;return yd.__awaiter(this,void 0,void 0,function*(){if(typeof t.data=="string"&&t.data.length===0||Object.entries(t.data).length===0)throw new da.MissingRequiredArgument("Query missing.");let o=this.getApiHeaders();t.extraHeaders=Object.assign(Object.assign({},o),t.extraHeaders);let i=`${this.baseApiPath}/${this.apiVersion||this.graphqlClass().config.apiVersion}/graphql.json`,s;typeof t.data=="object"?s=md.DataType.JSON:s=md.DataType.GraphQL;let a=yield this.client.post(Object.assign({path:i,type:s},t)),c=a.body.errors;if(c?.length>0)throw new da.GraphqlQueryError({message:(n=(r=c[0])===null||r===void 0?void 0:r.message)!==null&&n!==void 0?n:"GraphQL query returned errors",response:a.body,headers:a.headers});return a})}getApiHeaders(){var t;let r=(t=this.graphqlClass().config.adminApiAccessToken)!==null&&t!==void 0?t:this.graphqlClass().config.apiSecretKey;return{[tw.ShopifyHeader.AccessToken]:this.graphqlClass().config.isCustomStoreApp?r:this.session.accessToken}}graphqlClass(){return this.constructor}};rr.GraphqlClient=_o;function ow(e){let{config:t}=e,{HttpClient:r}=e;r||(r=(0,rw.httpClientClass)(e.config));class n extends _o{}return n.config=t,n.HttpClient=r,Reflect.defineProperty(n,"name",{value:"GraphqlClient"}),n}rr.graphqlClientClass=ow});var Yr=p(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.Session=void 0;var iw=W(),gd=aa(),sw=["id","shop","state","isOnline","scope","accessToken","expires","onlineAccessInfo"],Xr=class{constructor(t){Object.assign(this,t)}static fromPropertyArray(t){if(!Array.isArray(t))throw new iw.InvalidSession("The parameter is not an array: a Session cannot be created from this object.");let r=Object.fromEntries(t.filter(([n,o])=>o!=null).map(([n,o])=>{switch(n.toLowerCase()){case"isonline":return["isOnline",o];case"accesstoken":return["accessToken",o];case"onlineaccessinfo":return["onlineAccessInfo",o];default:return[n.toLowerCase(),o]}}).map(([n,o])=>{switch(n){case"isOnline":return typeof o=="string"?[n,o.toString().toLowerCase()==="true"]:typeof o=="number"?[n,Boolean(o)]:[n,o];case"scope":return[n,o.toString()];case"expires":return[n,o?new Date(Number(o)):void 0];case"onlineAccessInfo":return[n,{associated_user:{id:Number(o)}}];default:return[n,o]}}));return Object.setPrototypeOf(r,Xr.prototype),r}isActive(t){return!!((t instanceof gd.AuthScopes?t:new gd.AuthScopes(t)).equals(this.scope)&&this.accessToken&&(!this.expires||this.expires>=new Date))}toObject(){let t={id:this.id,shop:this.shop,state:this.state,isOnline:this.isOnline};return this.scope&&(t.scope=this.scope),this.expires&&(t.expires=this.expires),this.accessToken&&(t.accessToken=this.accessToken),this.onlineAccessInfo&&(t.onlineAccessInfo=this.onlineAccessInfo),t}equals(t){if(!t||!(this.id===t.id&&this.shop===t.shop&&this.state===t.state&&this.isOnline===t.isOnline))return!1;let n=this.toPropertyArray();n.sort(([i],[s])=>i<s?-1:1);let o=t.toPropertyArray();return o.sort(([i],[s])=>i<s?-1:1),JSON.stringify(n)===JSON.stringify(o)}toPropertyArray(){return Object.entries(this).filter(([t,r])=>sw.includes(t)&&r!==void 0&&r!==null).map(([t,r])=>{var n;switch(t){case"expires":return[t,r?r.getTime():void 0];case"onlineAccessInfo":return[t,(n=r?.associated_user)===null||n===void 0?void 0:n.id];default:return[t,r]}})}};Eo.Session=Xr});var vd=p(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.storefrontClientClass=nr.StorefrontClient=void 0;var aw=Xt(),So=be(),cw=er(),uw=Yr(),lw=me(),dw=Ge(),Ao=class extends dw.GraphqlClient{constructor(t){let r=new uw.Session({shop:t.domain,id:"",state:"",isOnline:!0,accessToken:t.storefrontAccessToken});super({session:r,apiVersion:t.apiVersion}),this.baseApiPath="/api";let n=this.storefrontClass().config;if(t.apiVersion){let o=t.apiVersion===n.apiVersion?`Storefront client has a redundant API version override to the default ${t.apiVersion}`:`Storefront client overriding default API version ${n.apiVersion} with ${t.apiVersion}`;(0,lw.logger)(n).debug(o)}this.domain=t.domain,this.storefrontAccessToken=t.storefrontAccessToken}getApiHeaders(){let t=So.LIBRARY_NAME.toLowerCase().split(" ").join("-");return{[So.ShopifyHeader.StorefrontAccessToken]:this.storefrontClass().config.isCustomStoreApp?this.storefrontClass().config.privateAppStorefrontAccessToken||this.storefrontAccessToken:this.storefrontAccessToken,[So.ShopifyHeader.StorefrontSDKVariant]:t,[So.ShopifyHeader.StorefrontSDKVersion]:aw.SHOPIFY_API_LIBRARY_VERSION}}storefrontClass(){return this.constructor}};nr.StorefrontClient=Ao;function pw(e){let{config:t}=e,{HttpClient:r}=e;r||(r=(0,cw.httpClientClass)(t));class n extends Ao{}return n.config=t,n.HttpClient=r,Reflect.defineProperty(n,"name",{value:"StorefrontClient"}),n}nr.storefrontClientClass=pw});var bd=p(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.graphqlProxy=void 0;var wd=(k(),R(H)),fw=wd.__importStar(W()),hw=Ge();function mw(e){return({session:t,rawBody:r})=>wd.__awaiter(this,void 0,void 0,function*(){if(!t.accessToken)throw new fw.InvalidSession("Cannot proxy query. Session not authenticated.");let n=(0,hw.graphqlClientClass)({config:e});return new n({session:t}).query({data:r})})}Ro.graphqlProxy=mw});var _d=p(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.clientClasses=void 0;var yw=er(),gw=hd(),vw=Ge(),ww=vd(),bw=bd();function _w(e){let t=(0,yw.httpClientClass)(e);return{Rest:(0,gw.restClientClass)({config:e}),Graphql:(0,vw.graphqlClientClass)({config:e,HttpClient:t}),Storefront:(0,ww.storefrontClientClass)({config:e,HttpClient:t}),graphqlProxy:(0,bw.graphqlProxy)(e)}}xo.clientClasses=_w});var fa=p(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.default=Sw;var Co,Ew=new Uint8Array(16);function Sw(){if(!Co&&(Co=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Co))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Co(Ew)}});var Ed=p(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.default=void 0;var Aw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;Po.default=Aw});var Qr=p(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.default=void 0;var Rw=xw(Ed());function xw(e){return e&&e.__esModule?e:{default:e}}function Cw(e){return typeof e=="string"&&Rw.default.test(e)}var Pw=Cw;Oo.default=Pw});var en=p(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.default=void 0;Zr.unsafeStringify=Sd;var Ow=Tw(Qr());function Tw(e){return e&&e.__esModule?e:{default:e}}var Z=[];for(let e=0;e<256;++e)Z.push((e+256).toString(16).slice(1));function Sd(e,t=0){return(Z[e[t+0]]+Z[e[t+1]]+Z[e[t+2]]+Z[e[t+3]]+"-"+Z[e[t+4]]+Z[e[t+5]]+"-"+Z[e[t+6]]+Z[e[t+7]]+"-"+Z[e[t+8]]+Z[e[t+9]]+"-"+Z[e[t+10]]+Z[e[t+11]]+Z[e[t+12]]+Z[e[t+13]]+Z[e[t+14]]+Z[e[t+15]]).toLowerCase()}function Iw(e,t=0){let r=Sd(e,t);if(!(0,Ow.default)(r))throw TypeError("Stringified UUID is invalid");return r}var qw=Iw;Zr.default=qw});var Rd=p(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.default=void 0;var Hw=$w(fa()),kw=en();function $w(e){return e&&e.__esModule?e:{default:e}}var Ad,ha,ma=0,ya=0;function Mw(e,t,r){let n=t&&r||0,o=t||new Array(16);e=e||{};let i=e.node||Ad,s=e.clockseq!==void 0?e.clockseq:ha;if(i==null||s==null){let h=e.random||(e.rng||Hw.default)();i==null&&(i=Ad=[h[0]|1,h[1],h[2],h[3],h[4],h[5]]),s==null&&(s=ha=(h[6]<<8|h[7])&16383)}let a=e.msecs!==void 0?e.msecs:Date.now(),c=e.nsecs!==void 0?e.nsecs:ya+1,u=a-ma+(c-ya)/1e4;if(u<0&&e.clockseq===void 0&&(s=s+1&16383),(u<0||a>ma)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ma=a,ya=c,ha=s,a+=122192928e5;let l=((a&268435455)*1e4+c)%4294967296;o[n++]=l>>>24&255,o[n++]=l>>>16&255,o[n++]=l>>>8&255,o[n++]=l&255;let d=a/4294967296*1e4&268435455;o[n++]=d>>>8&255,o[n++]=d&255,o[n++]=d>>>24&15|16,o[n++]=d>>>16&255,o[n++]=s>>>8|128,o[n++]=s&255;for(let h=0;h<6;++h)o[n+h]=i[h];return t||(0,kw.unsafeStringify)(o)}var Nw=Mw;To.default=Nw});var ga=p(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.default=void 0;var Dw=Uw(Qr());function Uw(e){return e&&e.__esModule?e:{default:e}}function Lw(e){if(!(0,Dw.default)(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}var Kw=Lw;Io.default=Kw});var va=p($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.URL=$t.DNS=void 0;$t.default=Bw;var Ww=en(),Fw=Jw(ga());function Jw(e){return e&&e.__esModule?e:{default:e}}function jw(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var xd="6ba7b810-9dad-11d1-80b4-00c04fd430c8";$t.DNS=xd;var Cd="6ba7b811-9dad-11d1-80b4-00c04fd430c8";$t.URL=Cd;function Bw(e,t,r){function n(o,i,s,a){var c;if(typeof o=="string"&&(o=jw(o)),typeof i=="string"&&(i=(0,Fw.default)(i)),((c=i)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+o.length);if(u.set(i),u.set(o,i.length),u=r(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,s){a=a||0;for(let l=0;l<16;++l)s[a+l]=u[l];return s}return(0,Ww.unsafeStringify)(u)}try{n.name=e}catch{}return n.DNS=xd,n.URL=Cd,n}});var Od=p(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.default=void 0;function Vw(e){if(typeof e=="string"){let t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return Gw(zw(Xw(e),e.length*8))}function Gw(e){let t=[],r=e.length*32,n="0123456789abcdef";for(let o=0;o<r;o+=8){let i=e[o>>5]>>>o%32&255,s=parseInt(n.charAt(i>>>4&15)+n.charAt(i&15),16);t.push(s)}return t}function Pd(e){return(e+64>>>9<<4)+14+1}function zw(e,t){e[t>>5]|=128<<t%32,e[Pd(t)-1]=t;let r=1732584193,n=-271733879,o=-1732584194,i=271733878;for(let s=0;s<e.length;s+=16){let a=r,c=n,u=o,l=i;r=ie(r,n,o,i,e[s],7,-680876936),i=ie(i,r,n,o,e[s+1],12,-389564586),o=ie(o,i,r,n,e[s+2],17,606105819),n=ie(n,o,i,r,e[s+3],22,-1044525330),r=ie(r,n,o,i,e[s+4],7,-176418897),i=ie(i,r,n,o,e[s+5],12,1200080426),o=ie(o,i,r,n,e[s+6],17,-1473231341),n=ie(n,o,i,r,e[s+7],22,-45705983),r=ie(r,n,o,i,e[s+8],7,1770035416),i=ie(i,r,n,o,e[s+9],12,-1958414417),o=ie(o,i,r,n,e[s+10],17,-42063),n=ie(n,o,i,r,e[s+11],22,-1990404162),r=ie(r,n,o,i,e[s+12],7,1804603682),i=ie(i,r,n,o,e[s+13],12,-40341101),o=ie(o,i,r,n,e[s+14],17,-1502002290),n=ie(n,o,i,r,e[s+15],22,1236535329),r=se(r,n,o,i,e[s+1],5,-165796510),i=se(i,r,n,o,e[s+6],9,-1069501632),o=se(o,i,r,n,e[s+11],14,643717713),n=se(n,o,i,r,e[s],20,-373897302),r=se(r,n,o,i,e[s+5],5,-701558691),i=se(i,r,n,o,e[s+10],9,38016083),o=se(o,i,r,n,e[s+15],14,-660478335),n=se(n,o,i,r,e[s+4],20,-405537848),r=se(r,n,o,i,e[s+9],5,568446438),i=se(i,r,n,o,e[s+14],9,-1019803690),o=se(o,i,r,n,e[s+3],14,-187363961),n=se(n,o,i,r,e[s+8],20,1163531501),r=se(r,n,o,i,e[s+13],5,-1444681467),i=se(i,r,n,o,e[s+2],9,-51403784),o=se(o,i,r,n,e[s+7],14,1735328473),n=se(n,o,i,r,e[s+12],20,-1926607734),r=ae(r,n,o,i,e[s+5],4,-378558),i=ae(i,r,n,o,e[s+8],11,-2022574463),o=ae(o,i,r,n,e[s+11],16,1839030562),n=ae(n,o,i,r,e[s+14],23,-35309556),r=ae(r,n,o,i,e[s+1],4,-1530992060),i=ae(i,r,n,o,e[s+4],11,1272893353),o=ae(o,i,r,n,e[s+7],16,-155497632),n=ae(n,o,i,r,e[s+10],23,-1094730640),r=ae(r,n,o,i,e[s+13],4,681279174),i=ae(i,r,n,o,e[s],11,-358537222),o=ae(o,i,r,n,e[s+3],16,-722521979),n=ae(n,o,i,r,e[s+6],23,76029189),r=ae(r,n,o,i,e[s+9],4,-640364487),i=ae(i,r,n,o,e[s+12],11,-421815835),o=ae(o,i,r,n,e[s+15],16,530742520),n=ae(n,o,i,r,e[s+2],23,-995338651),r=ce(r,n,o,i,e[s],6,-198630844),i=ce(i,r,n,o,e[s+7],10,1126891415),o=ce(o,i,r,n,e[s+14],15,-1416354905),n=ce(n,o,i,r,e[s+5],21,-57434055),r=ce(r,n,o,i,e[s+12],6,1700485571),i=ce(i,r,n,o,e[s+3],10,-1894986606),o=ce(o,i,r,n,e[s+10],15,-1051523),n=ce(n,o,i,r,e[s+1],21,-2054922799),r=ce(r,n,o,i,e[s+8],6,1873313359),i=ce(i,r,n,o,e[s+15],10,-30611744),o=ce(o,i,r,n,e[s+6],15,-1560198380),n=ce(n,o,i,r,e[s+13],21,1309151649),r=ce(r,n,o,i,e[s+4],6,-145523070),i=ce(i,r,n,o,e[s+11],10,-1120210379),o=ce(o,i,r,n,e[s+2],15,718787259),n=ce(n,o,i,r,e[s+9],21,-343485551),r=lt(r,a),n=lt(n,c),o=lt(o,u),i=lt(i,l)}return[r,n,o,i]}function Xw(e){if(e.length===0)return[];let t=e.length*8,r=new Uint32Array(Pd(t));for(let n=0;n<t;n+=8)r[n>>5]|=(e[n/8]&255)<<n%32;return r}function lt(e,t){let r=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(r>>16)<<16|r&65535}function Yw(e,t){return e<<t|e>>>32-t}function qo(e,t,r,n,o,i){return lt(Yw(lt(lt(t,e),lt(n,i)),o),r)}function ie(e,t,r,n,o,i,s){return qo(t&r|~t&n,e,t,o,i,s)}function se(e,t,r,n,o,i,s){return qo(t&n|r&~n,e,t,o,i,s)}function ae(e,t,r,n,o,i,s){return qo(t^r^n,e,t,o,i,s)}function ce(e,t,r,n,o,i,s){return qo(r^(t|~n),e,t,o,i,s)}var Qw=Vw;Ho.default=Qw});var Id=p(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.default=void 0;var Zw=Td(va()),eb=Td(Od());function Td(e){return e&&e.__esModule?e:{default:e}}var tb=(0,Zw.default)("v3",48,eb.default),rb=tb;ko.default=rb});var qd=p($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.default=void 0;var nb=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ob={randomUUID:nb};$o.default=ob});var $d=p(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.default=void 0;var Hd=kd(qd()),ib=kd(fa()),sb=en();function kd(e){return e&&e.__esModule?e:{default:e}}function ab(e,t,r){if(Hd.default.randomUUID&&!t&&!e)return Hd.default.randomUUID();e=e||{};let n=e.random||(e.rng||ib.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let o=0;o<16;++o)t[r+o]=n[o];return t}return(0,sb.unsafeStringify)(n)}var cb=ab;Mo.default=cb});var Md=p(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.default=void 0;function ub(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function wa(e,t){return e<<t|e>>>32-t}function lb(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let s=unescape(encodeURIComponent(e));e=[];for(let a=0;a<s.length;++a)e.push(s.charCodeAt(a))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,o=Math.ceil(n/16),i=new Array(o);for(let s=0;s<o;++s){let a=new Uint32Array(16);for(let c=0;c<16;++c)a[c]=e[s*64+c*4]<<24|e[s*64+c*4+1]<<16|e[s*64+c*4+2]<<8|e[s*64+c*4+3];i[s]=a}i[o-1][14]=(e.length-1)*8/Math.pow(2,32),i[o-1][14]=Math.floor(i[o-1][14]),i[o-1][15]=(e.length-1)*8&4294967295;for(let s=0;s<o;++s){let a=new Uint32Array(80);for(let f=0;f<16;++f)a[f]=i[s][f];for(let f=16;f<80;++f)a[f]=wa(a[f-3]^a[f-8]^a[f-14]^a[f-16],1);let c=r[0],u=r[1],l=r[2],d=r[3],h=r[4];for(let f=0;f<80;++f){let y=Math.floor(f/20),b=wa(c,5)+ub(y,u,l,d)+h+t[y]+a[f]>>>0;h=d,d=l,l=wa(u,30)>>>0,u=c,c=b}r[0]=r[0]+c>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+h>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var db=lb;No.default=db});var Dd=p(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.default=void 0;var pb=Nd(va()),fb=Nd(Md());function Nd(e){return e&&e.__esModule?e:{default:e}}var hb=(0,pb.default)("v5",80,fb.default),mb=hb;Do.default=mb});var Ud=p(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.default=void 0;var yb="00000000-0000-0000-0000-000000000000";Uo.default=yb});var Ld=p(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.default=void 0;var gb=vb(Qr());function vb(e){return e&&e.__esModule?e:{default:e}}function wb(e){if(!(0,gb.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}var bb=wb;Lo.default=bb});var Kd=p(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Object.defineProperty(Pe,"NIL",{enumerable:!0,get:function(){return Rb.default}});Object.defineProperty(Pe,"parse",{enumerable:!0,get:function(){return Ob.default}});Object.defineProperty(Pe,"stringify",{enumerable:!0,get:function(){return Pb.default}});Object.defineProperty(Pe,"v1",{enumerable:!0,get:function(){return _b.default}});Object.defineProperty(Pe,"v3",{enumerable:!0,get:function(){return Eb.default}});Object.defineProperty(Pe,"v4",{enumerable:!0,get:function(){return Sb.default}});Object.defineProperty(Pe,"v5",{enumerable:!0,get:function(){return Ab.default}});Object.defineProperty(Pe,"validate",{enumerable:!0,get:function(){return Cb.default}});Object.defineProperty(Pe,"version",{enumerable:!0,get:function(){return xb.default}});var _b=ze(Rd()),Eb=ze(Id()),Sb=ze($d()),Ab=ze(Dd()),Rb=ze(Ud()),xb=ze(Ld()),Cb=ze(Qr()),Pb=ze(en()),Ob=ze(ga());function ze(e){return e&&e.__esModule?e:{default:e}}});var pt=p((iO,tp)=>{function Tb(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,s,a=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(l){u=!0,o=l}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function Ib(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zd(n.key),n)}}function qb(e,t,r){return t&&Wd(e.prototype,t),r&&Wd(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fd(e,t,r){return t=zd(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gd(e,t){return Hb(e)||Tb(e,t)||kb(e,t)||$b()}function Hb(e){if(Array.isArray(e))return e}function kb(e,t){if(e){if(typeof e=="string")return Jd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jd(e,t)}}function Jd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $b(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mb(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zd(e){var t=Mb(e,"string");return typeof t=="symbol"?t:String(t)}function Xe(e,t){var r=Yd(e,t,"get");return Nb(e,r)}function Xd(e,t,r){var n=Yd(e,t,"set");return Db(e,n,r),r}function Yd(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Nb(e,t){return t.get?t.get.call(e):t.value}function Db(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function tn(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Qd(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jd(e,t,r){Qd(e,t),t.set(e,r)}function Bd(e,t){Qd(e,t),t.add(e)}var Zd=[" daum[ /]"," deusu/"," yadirectfetcher","(?:^| )site","(?:^|[^g])news","@[a-z]","\\(at\\)[a-z]","\\(github\\.com/","\\[at\\][a-z]","^12345","^<","^[\\w \\.\\-\\(\\)]+(/v?\\d+(\\.\\d+)?(\\.\\d{1,10})?)?$","^[^ ]{50,}$","^active","^ad muncher","^amaya","^anglesharp/","^anonymous","^avsdevicesdk/","^axios/","^bidtellect/","^biglotron","^btwebclient/","^castro","^clamav[ /]","^client/","^cobweb/","^coccoc","^custom","^ddg[_-]android","^discourse","^dispatch/\\d","^downcast/","^duckduckgo","^facebook","^fdm[ /]\\d","^getright/","^gozilla/","^hatena","^hobbit","^hotzonu","^hwcdn/","^jeode/","^jetty/","^jigsaw","^linkdex","^lwp[-: ]","^metauri","^microsoft bits","^movabletype","^mozilla/\\d\\.\\d \\(compatible;?\\)$","^mozilla/\\d\\.\\d \\w*$","^navermailapp","^netsurf","^offline explorer","^php","^postman","^postrank","^python","^read","^reed","^restsharp/","^snapchat","^space bison","^svn","^swcd ","^taringa","^test certificate info","^thumbor/","^tumblr/","^user-agent:mozilla","^valid","^venus/fedoraplanet","^w3c","^webbandit/","^webcopier","^wget","^whatsapp","^xenu link sleuth","^yahoo","^yandex","^zdm/\\d","^zoom marketplace/","^{{.*}}$","adbeat\\.com","appinsights","archive","ask jeeves/teoma","bit\\.ly/","bluecoat drtr","bot","browsex","burpcollaborator","capture","catch","check","chrome-lighthouse","chromeframe","cloud","crawl","cryptoapi","dareboost","datanyze","dataprovider","dejaclick","dmbrowser","download","evc-batch/","feed","firephp","freesafeip","ghost","gomezagent","google","headlesschrome/","http","httrack","hubspot marketing grader","hydra","ibisbrowser","images","iplabel","ips-agent","java","library","mail\\.ru/","manager","monitor","morningscore/","neustar wpm","nutch","offbyone","optimize","pageburst","pagespeed","perl","phantom","pingdom","powermarks","preview","proxy","ptst[ /]\\d","reader","rexx;","rigor","rss","scan","scrape","search","serp ?reputation ?management","server","sogou","sparkler/","speedcurve","spider","splash","statuscake","stumbleupon\\.com","supercleaner","synapse","synthetic","taginspector/","torrent","tracemyfile","transcoder","trendsmapresolver","twingly recon","url","virtuoso","wappalyzer","webglance","webkit2png","websitemetadataretriever","whatcms/","wordpress","zgrab"];function Ub(e){try{new RegExp("(?<! cu)bot").test("dangerbot")}catch{return e}return[["bot","(?<! cu)bot"],["google","(?<! (?:channel/|google/))google(?!(app|/google| pixel))"],["http","(?<!(?:lib))http"],["java","java(?!;)"],["search","(?<! ya(?:yandex)?)search"]].forEach(function(t){var r=Gd(t,2),n=r[0],o=r[1],i=e.lastIndexOf(n);~i&&e.splice(i,1,o)}),e}Ub(Zd);var ep="i",dt=new WeakMap,rn=new WeakMap,Ko=new WeakSet,ba=new WeakSet,Lb=function(){function e(t){var r=this;Ib(this,e),Bd(this,ba),Bd(this,Ko),jd(this,dt,{writable:!0,value:void 0}),jd(this,rn,{writable:!0,value:void 0}),Xd(this,dt,t||Zd.slice()),tn(this,Ko,_a).call(this);var n=function(i){return r.test(i)};return Object.defineProperties(n,Object.entries(Object.getOwnPropertyDescriptors(e.prototype)).reduce(function(o,i){var s=Gd(i,2),a=s[0],c=s[1];return typeof c.value=="function"&&Object.assign(o,Fd({},a,{value:r[a].bind(r)})),typeof c.get=="function"&&Object.assign(o,Fd({},a,{get:function(){return r[a]}})),o},{}))}return qb(e,[{key:"pattern",get:function(){return new RegExp(Xe(this,rn))}},{key:"test",value:function(r){return Boolean(r)&&Xe(this,rn).test(r)}},{key:"find",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r.match(Xe(this,rn));return n&&n[0]}},{key:"matches",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Xe(this,dt).filter(function(n){return new RegExp(n,ep).test(r)})}},{key:"clear",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.exclude(this.matches(r))}},{key:"extend",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];[].push.apply(Xe(this,dt),n.filter(function(o){return tn(r,ba,Vd).call(r,o)===-1}).map(function(o){return o.toLowerCase()})),tn(this,Ko,_a).call(this)}},{key:"exclude",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=r.length;n--;){var o=tn(this,ba,Vd).call(this,r[n]);o>-1&&Xe(this,dt).splice(o,1)}tn(this,Ko,_a).call(this)}},{key:"spawn",value:function(r){return new e(r||Xe(this,dt))}}]),e}();function _a(){Xd(this,rn,new RegExp(Xe(this,dt).join("|"),ep))}function Vd(e){return Xe(this,dt).indexOf(e.toLowerCase())}var Kb=new Lb;tp.exports=Kb});var nn=p(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.safeCompare=void 0;var Wb=(k(),R(H)),Fb=Wb.__importStar(W());function Jb(e,t){if(typeof e==typeof t){let r=new TextEncoder,n=r.encode(JSON.stringify(e)),o=r.encode(JSON.stringify(t));if(n.length===o.length)return jb(n,o)}else throw new Fb.SafeCompareError(`Mismatched data types provided: ${typeof e} and ${typeof t}`);return!1}Wo.safeCompare=Jb;function jb(e,t){let r=new Uint8Array(e),n=new Uint8Array(t),o=0;for(let i=0;i<r.length;i++)o|=r[i]^n[i];return o===0}});var Ea=p(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.getCurrentTimeInSec=ft.validateHmac=ft.generateLocalHmac=void 0;var on=(k(),R(H)),Bb=Ht(),Vb=Tt(),rp=on.__importStar(W()),Gb=nn(),zb=on.__importDefault(wo()),Xb=90;function Yb(e){let t=new zb.default;return Object.keys(e).sort((r,n)=>r.localeCompare(n)).forEach(r=>t.put(r,e[r])),t.stringify(!0)}function np(e){return t=>on.__awaiter(this,void 0,void 0,function*(){let{hmac:r,signature:n}=t,o=on.__rest(t,["hmac","signature"]),i=Yb(o);return(0,Bb.createSHA256HMAC)(e.apiSecretKey,i,Vb.HashFormat.Hex)})}ft.generateLocalHmac=np;function Qb(e){return t=>on.__awaiter(this,void 0,void 0,function*(){if(!t.hmac&&!t.signature)throw new rp.InvalidHmacError("Query does not contain an HMAC value.");Zb(t);let r=t.signature||t.hmac,n=yield np(e)(t);return(0,Gb.safeCompare)(r,n)})}ft.validateHmac=Qb;function op(){return Math.trunc(Date.now()/1e3)}ft.getCurrentTimeInSec=op;function Zb(e){if(Math.abs(op()-Number(e.timestamp))>Xb)throw new rp.InvalidHmacError("HMAC timestamp is outside of the tolerance range")}});var Sa=p(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.decodeHost=void 0;function e_(e){return typeof atob>"u"?Buffer.from(e,"base64").toString():atob(e)}Fo.decodeHost=e_});var sn=p(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.sanitizeHost=or.sanitizeShop=void 0;var ip=W(),t_=Sa();function sp(e){return(t,r=!1)=>{let n=["myshopify\\.com","shopify\\.com","myshopify\\.io"];e.customShopDomains&&n.push(...e.customShopDomains.map(s=>typeof s=="string"?s:s.source));let i=new RegExp(`^[a-zA-Z0-9][a-zA-Z0-9-_]*\\.(${n.join("|")})[/]*$`).test(t)?t:null;if(!i&&r)throw new ip.InvalidShopError("Received invalid shop argument");return i}}or.sanitizeShop=sp;function r_(e){return(t,r=!1)=>{let o=/^[0-9a-zA-Z+/]+={0,2}$/.test(t)?t:null;if(o){let i=new URL(`https://${(0,t_.decodeHost)(o)}`);sp(e)(i.hostname,!1)||(o=null)}if(!o&&r)throw new ip.InvalidHostError("Received invalid host argument");return o}}or.sanitizeHost=r_});var Jo=p(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.STATE_COOKIE_NAME=ir.SESSION_COOKIE_NAME=void 0;ir.SESSION_COOKIE_NAME="shopify_app_session";ir.STATE_COOKIE_NAME="shopify_app_state"});var E,F,ee=m(()=>{E=crypto,F=e=>e instanceof CryptoKey});var n_,jo,Aa=m(()=>{ee();n_=async(e,t)=>{let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await E.subtle.digest(r,t))},jo=n_});function te(...e){let t=e.reduce((o,{length:i})=>o+i,0),r=new Uint8Array(t),n=0;return e.forEach(o=>{r.set(o,n),n+=o.length}),r}function ap(e,t){return te($.encode(e),new Uint8Array([0]),t)}function Ra(e,t,r){if(t<0||t>=Bo)throw new RangeError(`value must be >= 0 and <= ${Bo-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,t&255],r)}function Vo(e){let t=Math.floor(e/Bo),r=e%Bo,n=new Uint8Array(8);return Ra(n,t,0),Ra(n,r,4),n}function Go(e){let t=new Uint8Array(4);return Ra(t,e),t}function zo(e){return te(Go(e.length),e)}async function cp(e,t,r){let n=Math.ceil((t>>3)/32),o=new Uint8Array(n*32);for(let i=0;i<n;i++){let s=new Uint8Array(4+e.length+r.length);s.set(Go(i+1)),s.set(e,4),s.set(r,4+e.length),o.set(await jo("sha256",s),i*32)}return o.slice(0,t>>3)}var $,j,Bo,z=m(()=>{Aa();$=new TextEncoder,j=new TextDecoder,Bo=2**32});var Xo,M,xa,U,re=m(()=>{z();Xo=e=>{let t=e;typeof t=="string"&&(t=$.encode(t));let r=32768,n=[];for(let o=0;o<t.length;o+=r)n.push(String.fromCharCode.apply(null,t.subarray(o,o+r)));return btoa(n.join(""))},M=e=>Xo(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),xa=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r},U=e=>{let t=e;t instanceof Uint8Array&&(t=j.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return xa(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}});var Ca={};Vt(Ca,{JOSEAlgNotAllowed:()=>ht,JOSEError:()=>V,JOSENotSupported:()=>S,JWEDecryptionFailed:()=>Ye,JWEInvalid:()=>g,JWKInvalid:()=>an,JWKSInvalid:()=>mt,JWKSMultipleMatchingKeys:()=>cn,JWKSNoMatchingKey:()=>Mt,JWKSTimeout:()=>un,JWSInvalid:()=>P,JWSSignatureVerificationFailed:()=>Nt,JWTClaimValidationFailed:()=>Y,JWTExpired:()=>sr,JWTInvalid:()=>B});var V,Y,sr,ht,S,Ye,g,P,B,an,mt,Mt,cn,un,Nt,x=m(()=>{V=class extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(t){var r;super(t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}},Y=class extends V{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(t,r="unspecified",n="unspecified"){super(t),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=n}},sr=class extends V{static get code(){return"ERR_JWT_EXPIRED"}constructor(t,r="unspecified",n="unspecified"){super(t),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=n}},ht=class extends V{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},S=class extends V{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},Ye=class extends V{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},g=class extends V{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}},P=class extends V{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}},B=class extends V{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}},an=class extends V{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}},mt=class extends V{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}},Mt=class extends V{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}},cn=class extends V{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}},un=class extends V{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}},Nt=class extends V{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}});var yt,ln=m(()=>{ee();yt=E.getRandomValues.bind(E)});function Pa(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new S(`Unsupported JWE Algorithm: ${e}`)}}var Yo,Qo=m(()=>{x();ln();Yo=e=>yt(new Uint8Array(Pa(e)>>3))});var o_,Zo,Oa=m(()=>{x();Qo();o_=(e,t)=>{if(t.length<<3!==Pa(e))throw new g("Invalid Initialization Vector length")},Zo=o_});var i_,ar,Ta=m(()=>{x();i_=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new g(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)},ar=i_});var s_,lp,dp=m(()=>{s_=(e,t)=>{if(!(e instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");if(e.length!==t.length)throw new TypeError("Input buffers must have the same length");let r=e.length,n=0,o=-1;for(;++o<r;)n|=e[o]^t[o];return n===0},lp=s_});function ne(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function gt(e,t){return e.name===t}function ei(e){return parseInt(e.name.slice(4),10)}function a_(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function pp(e,t){if(t.length&&!t.some(r=>e.usages.includes(r))){let r="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let n=t.pop();r+=`one of ${t.join(", ")}, or ${n}.`}else t.length===2?r+=`one of ${t[0]} or ${t[1]}.`:r+=`${t[0]}.`;throw new TypeError(r)}}function fp(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!gt(e.algorithm,"HMAC"))throw ne("HMAC");let n=parseInt(t.slice(2),10);if(ei(e.algorithm.hash)!==n)throw ne(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!gt(e.algorithm,"RSASSA-PKCS1-v1_5"))throw ne("RSASSA-PKCS1-v1_5");let n=parseInt(t.slice(2),10);if(ei(e.algorithm.hash)!==n)throw ne(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!gt(e.algorithm,"RSA-PSS"))throw ne("RSA-PSS");let n=parseInt(t.slice(2),10);if(ei(e.algorithm.hash)!==n)throw ne(`SHA-${n}`,"algorithm.hash");break}case"EdDSA":{if(e.algorithm.name!=="Ed25519"&&e.algorithm.name!=="Ed448")throw ne("Ed25519 or Ed448");break}case"ES256":case"ES384":case"ES512":{if(!gt(e.algorithm,"ECDSA"))throw ne("ECDSA");let n=a_(t);if(e.algorithm.namedCurve!==n)throw ne(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}pp(e,r)}function ge(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!gt(e.algorithm,"AES-GCM"))throw ne("AES-GCM");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw ne(n,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!gt(e.algorithm,"AES-KW"))throw ne("AES-KW");let n=parseInt(t.slice(1,4),10);if(e.algorithm.length!==n)throw ne(n,"algorithm.length");break}case"ECDH":{switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw ne("ECDH, X25519, or X448")}break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!gt(e.algorithm,"PBKDF2"))throw ne("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!gt(e.algorithm,"RSA-OAEP"))throw ne("RSA-OAEP");let n=parseInt(t.slice(9),10)||1;if(ei(e.algorithm.hash)!==n)throw ne(`SHA-${n}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}pp(e,r)}var vt=m(()=>{});function hp(e,t,...r){if(r.length>2){let n=r.pop();e+=`one of type ${r.join(", ")}, or ${n}.`}else r.length===2?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}function Ia(e,t,...r){return hp(`Key for the ${e} algorithm must be `,t,...r)}var L,Oe=m(()=>{L=(e,...t)=>hp("Key must be ",e,...t)});var qa,T,Te=m(()=>{ee();qa=e=>F(e),T=["CryptoKey"]});async function c_(e,t,r,n,o,i){if(!(t instanceof Uint8Array))throw new TypeError(L(t,"Uint8Array"));let s=parseInt(e.slice(1,4),10),a=await E.subtle.importKey("raw",t.subarray(s>>3),"AES-CBC",!1,["decrypt"]),c=await E.subtle.importKey("raw",t.subarray(0,s>>3),{hash:`SHA-${s<<1}`,name:"HMAC"},!1,["sign"]),u=te(i,n,r,Vo(i.length<<3)),l=new Uint8Array((await E.subtle.sign("HMAC",c,u)).slice(0,s>>3)),d;try{d=lp(o,l)}catch{}if(!d)throw new Ye;let h;try{h=new Uint8Array(await E.subtle.decrypt({iv:n,name:"AES-CBC"},a,r))}catch{}if(!h)throw new Ye;return h}async function u_(e,t,r,n,o,i){let s;t instanceof Uint8Array?s=await E.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(ge(t,e,"decrypt"),s=t);try{return new Uint8Array(await E.subtle.decrypt({additionalData:i,iv:n,name:"AES-GCM",tagLength:128},s,te(r,o)))}catch{throw new Ye}}var l_,ti,Ha=m(()=>{z();Oa();Ta();dp();x();ee();vt();Oe();Te();l_=async(e,t,r,n,o,i)=>{if(!F(t)&&!(t instanceof Uint8Array))throw new TypeError(L(t,...T,"Uint8Array"));switch(Zo(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&ar(t,parseInt(e.slice(-3),10)),c_(e,t,r,n,o,i);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&ar(t,parseInt(e.slice(1,4),10)),u_(e,t,r,n,o,i);default:throw new S("Unsupported JWE Content Encryption Algorithm")}},ti=l_});var mp,yp,ka=m(()=>{x();mp=async()=>{throw new S('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')},yp=async()=>{throw new S('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `deflateRaw` encrypt option to provide Deflate Raw implementation.')}});var d_,Me,cr=m(()=>{d_=(...e)=>{let t=e.filter(Boolean);if(t.length===0||t.length===1)return!0;let r;for(let n of t){let o=Object.keys(n);if(!r||r.size===0){r=new Set(o);continue}for(let i of o){if(r.has(i))return!1;r.add(i)}}return!0},Me=d_});function p_(e){return typeof e=="object"&&e!==null}function I(e){if(!p_(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var ve=m(()=>{});var f_,ur,$a=m(()=>{f_=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]],ur=f_});function gp(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${t}`)}function vp(e,t,r){if(F(e))return ge(e,t,r),e;if(e instanceof Uint8Array)return E.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw new TypeError(L(e,...T,"Uint8Array"))}var dn,pn,ri=m(()=>{$a();ee();vt();Oe();Te();dn=async(e,t,r)=>{let n=await vp(t,e,"wrapKey");gp(n,e);let o=await E.subtle.importKey("raw",r,...ur);return new Uint8Array(await E.subtle.wrapKey("raw",o,n,"AES-KW"))},pn=async(e,t,r)=>{let n=await vp(t,e,"unwrapKey");gp(n,e);let o=await E.subtle.unwrapKey("raw",r,n,"AES-KW",...ur);return new Uint8Array(await E.subtle.exportKey("raw",o))}});async function ni(e,t,r,n,o=new Uint8Array(0),i=new Uint8Array(0)){if(!F(e))throw new TypeError(L(e,...T));if(ge(e,"ECDH"),!F(t))throw new TypeError(L(t,...T));ge(t,"ECDH","deriveBits");let s=te(zo($.encode(r)),zo(o),zo(i),Go(n)),a;e.algorithm.name==="X25519"?a=256:e.algorithm.name==="X448"?a=448:a=Math.ceil(parseInt(e.algorithm.namedCurve.substr(-3),10)/8)<<3;let c=new Uint8Array(await E.subtle.deriveBits({name:e.algorithm.name,public:e},t,a));return cp(c,n,s)}async function wp(e){if(!F(e))throw new TypeError(L(e,...T));return E.subtle.generateKey(e.algorithm,!0,["deriveBits"])}function oi(e){if(!F(e))throw new TypeError(L(e,...T));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)||e.algorithm.name==="X25519"||e.algorithm.name==="X448"}var Ma=m(()=>{z();ee();vt();Oe();Te()});function Na(e){if(!(e instanceof Uint8Array)||e.length<8)throw new g("PBES2 Salt Input must be 8 or more octets")}var _p=m(()=>{x()});function h_(e,t){if(e instanceof Uint8Array)return E.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if(F(e))return ge(e,t,"deriveBits","deriveKey"),e;throw new TypeError(L(e,...T,"Uint8Array"))}async function Ep(e,t,r,n){Na(e);let o=ap(t,e),i=parseInt(t.slice(13,16),10),s={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:o},a={length:i,name:"AES-KW"},c=await h_(n,t);if(c.usages.includes("deriveBits"))return new Uint8Array(await E.subtle.deriveBits(s,c,i));if(c.usages.includes("deriveKey"))return E.subtle.deriveKey(s,c,a,!1,["wrapKey","unwrapKey"]);throw new TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}var Sp,Ap,Da=m(()=>{ln();z();re();ri();_p();ee();vt();Oe();Te();Sp=async(e,t,r,n=2048,o=yt(new Uint8Array(16)))=>{let i=await Ep(o,e,n,t);return{encryptedKey:await dn(e.slice(-6),i,r),p2c:n,p2s:M(o)}},Ap=async(e,t,r,n,o)=>{let i=await Ep(o,e,n,t);return pn(e.slice(-6),i,r)}});function lr(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new S(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}var Rp=m(()=>{x()});var Dt,ii=m(()=>{Dt=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}}});var xp,Cp,Ua=m(()=>{Rp();$a();ee();vt();ii();Oe();Te();xp=async(e,t,r)=>{if(!F(t))throw new TypeError(L(t,...T));if(ge(t,e,"encrypt","wrapKey"),Dt(e,t),t.usages.includes("encrypt"))return new Uint8Array(await E.subtle.encrypt(lr(e),t,r));if(t.usages.includes("wrapKey")){let n=await E.subtle.importKey("raw",r,...ur);return new Uint8Array(await E.subtle.wrapKey("raw",n,t,lr(e)))}throw new TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')},Cp=async(e,t,r)=>{if(!F(t))throw new TypeError(L(t,...T));if(ge(t,e,"decrypt","unwrapKey"),Dt(e,t),t.usages.includes("decrypt"))return new Uint8Array(await E.subtle.decrypt(lr(e),t,r));if(t.usages.includes("unwrapKey")){let n=await E.subtle.unwrapKey("raw",r,t,lr(e),...ur);return new Uint8Array(await E.subtle.exportKey("raw",n))}throw new TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')}});function fn(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new S(`Unsupported JWE Algorithm: ${e}`)}}var Ne,hn=m(()=>{x();ln();Ne=e=>yt(new Uint8Array(fn(e)>>3))});var La,Pp=m(()=>{La=(e,t)=>{let r=(e.match(/.{1,64}/g)||[]).join(`
`);return`-----BEGIN ${t}-----
${r}
-----END ${t}-----`}});function Tp(e){let t=[],r=0;for(;r<e.length;){let n=Mp(e.subarray(r));t.push(n),r+=n.byteLength}return t}function Mp(e){let t=0,r=e[0]&31;if(t++,r===31){for(r=0;e[t]>=128;)r=r*128+e[t]-128,t++;r=r*128+e[t]-128,t++}let n=0;if(e[t]<128)n=e[t],t++;else if(n===128){for(n=0;e[t+n]!==0||e[t+n+1]!==0;){if(n>e.byteLength)throw new TypeError("invalid indefinite form length");n++}let i=t+n+2;return{byteLength:i,contents:e.subarray(t,t+n),raw:e.subarray(0,i)}}else{let i=e[t]&127;t++,n=0;for(let s=0;s<i;s++)n=n*256+e[t],t++}let o=t+n;return{byteLength:o,contents:e.subarray(t,o),raw:e.subarray(0,o)}}function m_(e){let t=Tp(Tp(Mp(e).contents)[0].contents);return Xo(t[t[0].raw[0]===160?6:5].raw)}function y_(e){let t=e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),r=xa(t);return La(m_(r),"PUBLIC KEY")}var Ip,qp,Hp,wt,Op,kp,$p,Ka,Np,si=m(()=>{ee();Oe();re();Pp();x();Te();Ip=async(e,t,r)=>{if(!F(r))throw new TypeError(L(r,...T));if(!r.extractable)throw new TypeError("CryptoKey is not extractable");if(r.type!==e)throw new TypeError(`key is not a ${e} key`);return La(Xo(new Uint8Array(await E.subtle.exportKey(t,r))),`${e.toUpperCase()} KEY`)},qp=e=>Ip("public","spki",e),Hp=e=>Ip("private","pkcs8",e),wt=(e,t,r=0)=>{r===0&&(t.unshift(t.length),t.unshift(6));let n=e.indexOf(t[0],r);if(n===-1)return!1;let o=e.subarray(n,n+t.length);return o.length!==t.length?!1:o.every((i,s)=>i===t[s])||wt(e,t,n+1)},Op=e=>{switch(!0){case wt(e,[42,134,72,206,61,3,1,7]):return"P-256";case wt(e,[43,129,4,0,34]):return"P-384";case wt(e,[43,129,4,0,35]):return"P-521";case wt(e,[43,101,110]):return"X25519";case wt(e,[43,101,111]):return"X448";case wt(e,[43,101,112]):return"Ed25519";case wt(e,[43,101,113]):return"Ed448";default:throw new S("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},kp=async(e,t,r,n,o)=>{var i;let s,a,c=new Uint8Array(atob(r.replace(e,"")).split("").map(l=>l.charCodeAt(0))),u=t==="spki";switch(n){case"PS256":case"PS384":case"PS512":s={name:"RSA-PSS",hash:`SHA-${n.slice(-3)}`},a=u?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${n.slice(-3)}`},a=u?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s={name:"RSA-OAEP",hash:`SHA-${parseInt(n.slice(-3),10)||1}`},a=u?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":s={name:"ECDSA",namedCurve:"P-256"},a=u?["verify"]:["sign"];break;case"ES384":s={name:"ECDSA",namedCurve:"P-384"},a=u?["verify"]:["sign"];break;case"ES512":s={name:"ECDSA",namedCurve:"P-521"},a=u?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let l=Op(c);s=l.startsWith("P-")?{name:"ECDH",namedCurve:l}:{name:l},a=u?[]:["deriveBits"];break}case"EdDSA":s={name:Op(c)},a=u?["verify"]:["sign"];break;default:throw new S('Invalid or unsupported "alg" (Algorithm) value')}return E.subtle.importKey(t,c,s,(i=o?.extractable)!==null&&i!==void 0?i:!1,a)},$p=(e,t,r)=>kp(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r),Ka=(e,t,r)=>kp(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",e,t,r);Np=(e,t,r)=>{let n;try{n=y_(e)}catch(o){throw new TypeError("failed to parse the X.509 certificate",{cause:o})}return Ka(n,t,r)}});function g_(e){let t,r;switch(e.kty){case"oct":{switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.slice(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new S(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"RSA":{switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(e.alg){case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new S('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}var v_,Wa,Dp=m(()=>{ee();x();re();v_=async e=>{var t,r;if(!e.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:n,keyUsages:o}=g_(e),i=[n,(t=e.ext)!==null&&t!==void 0?t:!1,(r=e.key_ops)!==null&&r!==void 0?r:o];if(n.name==="PBKDF2")return E.subtle.importKey("raw",U(e.k),...i);let s={...e};return delete s.alg,delete s.use,E.subtle.importKey("jwk",s,...i)},Wa=v_});async function Up(e,t,r){if(typeof e!="string"||e.indexOf("-----BEGIN PUBLIC KEY-----")!==0)throw new TypeError('"spki" must be SPKI formatted string');return Ka(e,t,r)}async function Lp(e,t,r){if(typeof e!="string"||e.indexOf("-----BEGIN CERTIFICATE-----")!==0)throw new TypeError('"x509" must be X.509 formatted string');return Np(e,t,r)}async function Kp(e,t,r){if(typeof e!="string"||e.indexOf("-----BEGIN PRIVATE KEY-----")!==0)throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return $p(e,t,r)}async function bt(e,t,r){var n;if(!I(e))throw new TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if(typeof e.k!="string"||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return r??(r=e.ext!==!0),r?Wa({...e,alg:t,ext:(n=e.ext)!==null&&n!==void 0?n:!1}):U(e.k);case"RSA":if(e.oth!==void 0)throw new S('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return Wa({...e,alg:t});default:throw new S('Unsupported "kty" (Key Type) Parameter value')}}var mn=m(()=>{re();si();Dp();x();ve()});var w_,b_,__,_t,yn=m(()=>{Oe();Te();w_=(e,t)=>{if(!(t instanceof Uint8Array)){if(!qa(t))throw new TypeError(Ia(e,t,...T,"Uint8Array"));if(t.type!=="secret")throw new TypeError(`${T.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},b_=(e,t,r)=>{if(!qa(t))throw new TypeError(Ia(e,t,...T));if(t.type==="secret")throw new TypeError(`${T.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if(r==="sign"&&t.type==="public")throw new TypeError(`${T.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if(r==="decrypt"&&t.type==="public")throw new TypeError(`${T.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&r==="verify"&&t.type==="private")throw new TypeError(`${T.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&r==="encrypt"&&t.type==="private")throw new TypeError(`${T.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},__=(e,t,r)=>{e.startsWith("HS")||e==="dir"||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?w_(e,t):b_(e,t,r)},_t=__});async function E_(e,t,r,n,o){if(!(r instanceof Uint8Array))throw new TypeError(L(r,"Uint8Array"));let i=parseInt(e.slice(1,4),10),s=await E.subtle.importKey("raw",r.subarray(i>>3),"AES-CBC",!1,["encrypt"]),a=await E.subtle.importKey("raw",r.subarray(0,i>>3),{hash:`SHA-${i<<1}`,name:"HMAC"},!1,["sign"]),c=new Uint8Array(await E.subtle.encrypt({iv:n,name:"AES-CBC"},s,t)),u=te(o,n,c,Vo(o.length<<3)),l=new Uint8Array((await E.subtle.sign("HMAC",a,u)).slice(0,i>>3));return{ciphertext:c,tag:l}}async function S_(e,t,r,n,o){let i;r instanceof Uint8Array?i=await E.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(ge(r,e,"encrypt"),i=r);let s=new Uint8Array(await E.subtle.encrypt({additionalData:o,iv:n,name:"AES-GCM",tagLength:128},i,t)),a=s.slice(-16);return{ciphertext:s.slice(0,-16),tag:a}}var A_,gn,Fa=m(()=>{z();Oa();Ta();ee();vt();Oe();x();Te();A_=async(e,t,r,n,o)=>{if(!F(r)&&!(r instanceof Uint8Array))throw new TypeError(L(r,...T,"Uint8Array"));switch(Zo(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&ar(r,parseInt(e.slice(-3),10)),E_(e,t,r,n,o);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&ar(r,parseInt(e.slice(1,4),10)),S_(e,t,r,n,o);default:throw new S("Unsupported JWE Content Encryption Algorithm")}},gn=A_});async function Wp(e,t,r,n){let o=e.slice(0,7);n||(n=Yo(o));let{ciphertext:i,tag:s}=await gn(o,r,t,n,new Uint8Array(0));return{encryptedKey:i,iv:M(n),tag:M(s)}}async function Fp(e,t,r,n,o){let i=e.slice(0,7);return ti(i,t,r,n,o,new Uint8Array(0))}var Ja=m(()=>{Fa();Ha();Qo();re()});async function R_(e,t,r,n,o){switch(_t(e,t,"decrypt"),e){case"dir":{if(r!==void 0)throw new g("Encountered unexpected JWE Encrypted Key");return t}case"ECDH-ES":if(r!==void 0)throw new g("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!I(n.epk))throw new g('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!oi(t))throw new S("ECDH with the provided key is not allowed or not supported by your javascript runtime");let i=await bt(n.epk,e),s,a;if(n.apu!==void 0){if(typeof n.apu!="string")throw new g('JOSE Header "apu" (Agreement PartyUInfo) invalid');s=U(n.apu)}if(n.apv!==void 0){if(typeof n.apv!="string")throw new g('JOSE Header "apv" (Agreement PartyVInfo) invalid');a=U(n.apv)}let c=await ni(i,t,e==="ECDH-ES"?n.enc:e,e==="ECDH-ES"?fn(n.enc):parseInt(e.slice(-5,-2),10),s,a);if(e==="ECDH-ES")return c;if(r===void 0)throw new g("JWE Encrypted Key missing");return pn(e.slice(-6),c,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(r===void 0)throw new g("JWE Encrypted Key missing");return Cp(e,t,r)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(r===void 0)throw new g("JWE Encrypted Key missing");if(typeof n.p2c!="number")throw new g('JOSE Header "p2c" (PBES2 Count) missing or invalid');let i=o?.maxPBES2Count||1e4;if(n.p2c>i)throw new g('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if(typeof n.p2s!="string")throw new g('JOSE Header "p2s" (PBES2 Salt) missing or invalid');return Ap(e,t,r,n.p2c,U(n.p2s))}case"A128KW":case"A192KW":case"A256KW":{if(r===void 0)throw new g("JWE Encrypted Key missing");return pn(e,t,r)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(r===void 0)throw new g("JWE Encrypted Key missing");if(typeof n.iv!="string")throw new g('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof n.tag!="string")throw new g('JOSE Header "tag" (Authentication Tag) missing or invalid');let i=U(n.iv),s=U(n.tag);return Fp(e,t,r,i,s)}default:throw new S('Invalid or unsupported "alg" (JWE Algorithm) header value')}}var Jp,jp=m(()=>{ri();Ma();Da();Ua();re();x();hn();mn();yn();ve();Ja();Jp=R_});function x_(e,t,r,n,o){if(o.crit!==void 0&&n.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(s=>typeof s!="string"||s.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let i;r!==void 0?i=new Map([...Object.entries(r),...t.entries()]):i=t;for(let s of n.crit){if(!i.has(s))throw new S(`Extension Header Parameter "${s}" is not recognized`);if(o[s]===void 0)throw new e(`Extension Header Parameter "${s}" is missing`);if(i.get(s)&&n[s]===void 0)throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(n.crit)}var De,dr=m(()=>{x();De=x_});var C_,vn,ja=m(()=>{C_=(e,t)=>{if(t!==void 0&&(!Array.isArray(t)||t.some(r=>typeof r!="string")))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)},vn=C_});async function pr(e,t,r){var n;if(!I(e))throw new g("Flattened JWE must be an object");if(e.protected===void 0&&e.header===void 0&&e.unprotected===void 0)throw new g("JOSE Header missing");if(typeof e.iv!="string")throw new g("JWE Initialization Vector missing or incorrect type");if(typeof e.ciphertext!="string")throw new g("JWE Ciphertext missing or incorrect type");if(typeof e.tag!="string")throw new g("JWE Authentication Tag missing or incorrect type");if(e.protected!==void 0&&typeof e.protected!="string")throw new g("JWE Protected Header incorrect type");if(e.encrypted_key!==void 0&&typeof e.encrypted_key!="string")throw new g("JWE Encrypted Key incorrect type");if(e.aad!==void 0&&typeof e.aad!="string")throw new g("JWE AAD incorrect type");if(e.header!==void 0&&!I(e.header))throw new g("JWE Shared Unprotected Header incorrect type");if(e.unprotected!==void 0&&!I(e.unprotected))throw new g("JWE Per-Recipient Unprotected Header incorrect type");let o;if(e.protected)try{let Pt=U(e.protected);o=JSON.parse(j.decode(Pt))}catch{throw new g("JWE Protected Header is invalid")}if(!Me(o,e.header,e.unprotected))throw new g("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let i={...o,...e.header,...e.unprotected};if(De(g,new Map,r?.crit,o,i),i.zip!==void 0){if(!o||!o.zip)throw new g('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if(i.zip!=="DEF")throw new S('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:s,enc:a}=i;if(typeof s!="string"||!s)throw new g("missing JWE Algorithm (alg) in JWE Header");if(typeof a!="string"||!a)throw new g("missing JWE Encryption Algorithm (enc) in JWE Header");let c=r&&vn("keyManagementAlgorithms",r.keyManagementAlgorithms),u=r&&vn("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(c&&!c.has(s))throw new ht('"alg" (Algorithm) Header Parameter not allowed');if(u&&!u.has(a))throw new ht('"enc" (Encryption Algorithm) Header Parameter not allowed');let l;e.encrypted_key!==void 0&&(l=U(e.encrypted_key));let d=!1;typeof t=="function"&&(t=await t(o,e),d=!0);let h;try{h=await Jp(s,t,l,i,r)}catch(Pt){if(Pt instanceof TypeError||Pt instanceof g||Pt instanceof S)throw Pt;h=Ne(a)}let f=U(e.iv),y=U(e.tag),b=$.encode((n=e.protected)!==null&&n!==void 0?n:""),J;e.aad!==void 0?J=te(b,$.encode("."),$.encode(e.aad)):J=b;let xe=await ti(a,h,U(e.ciphertext),f,y,J);i.zip==="DEF"&&(xe=await(r?.inflateRaw||mp)(xe));let ke={plaintext:xe};return e.protected!==void 0&&(ke.protectedHeader=o),e.aad!==void 0&&(ke.additionalAuthenticatedData=U(e.aad)),e.unprotected!==void 0&&(ke.sharedUnprotectedHeader=e.unprotected),e.header!==void 0&&(ke.unprotectedHeader=e.header),d?{...ke,key:t}:ke}var ai=m(()=>{re();Ha();ka();x();cr();ve();jp();z();hn();dr();ja()});async function ci(e,t,r){if(e instanceof Uint8Array&&(e=j.decode(e)),typeof e!="string")throw new g("Compact JWE must be a string or Uint8Array");let{0:n,1:o,2:i,3:s,4:a,length:c}=e.split(".");if(c!==5)throw new g("Invalid Compact JWE");let u=await pr({ciphertext:s,iv:i||void 0,protected:n||void 0,tag:a||void 0,encrypted_key:o||void 0},t,r),l={plaintext:u.plaintext,protectedHeader:u.protectedHeader};return typeof t=="function"?{...l,key:u.key}:l}var Ba=m(()=>{ai();x();z()});async function Bp(e,t,r){if(!I(e))throw new g("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(I))throw new g("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new g("JWE Recipients has no members");for(let n of e.recipients)try{return await pr({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch{}throw new Ye}var Vp=m(()=>{ai();x();ve()});var P_,Gp,zp=m(()=>{ee();Oe();re();Te();P_=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:M(e)};if(!F(e))throw new TypeError(L(e,...T,"Uint8Array"));if(!e.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:n,use:o,...i}=await E.subtle.exportKey("jwk",e);return i},Gp=P_});async function Xp(e){return qp(e)}async function Yp(e){return Hp(e)}async function ui(e){return Gp(e)}var Va=m(()=>{si();si();zp()});async function O_(e,t,r,n,o={}){let i,s,a;switch(_t(e,r,"encrypt"),e){case"dir":{a=r;break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!oi(r))throw new S("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:c,apv:u}=o,{epk:l}=o;l||(l=(await wp(r)).privateKey);let{x:d,y:h,crv:f,kty:y}=await ui(l),b=await ni(r,l,e==="ECDH-ES"?t:e,e==="ECDH-ES"?fn(t):parseInt(e.slice(-5,-2),10),c,u);if(s={epk:{x:d,crv:f,kty:y}},y==="EC"&&(s.epk.y=h),c&&(s.apu=M(c)),u&&(s.apv=M(u)),e==="ECDH-ES"){a=b;break}a=n||Ne(t);let J=e.slice(-6);i=await dn(J,b,a);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{a=n||Ne(t),i=await xp(e,r,a);break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{a=n||Ne(t);let{p2c:c,p2s:u}=o;({encryptedKey:i,...s}=await Sp(e,r,a,c,u));break}case"A128KW":case"A192KW":case"A256KW":{a=n||Ne(t),i=await dn(e,r,a);break}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{a=n||Ne(t);let{iv:c}=o;({encryptedKey:i,...s}=await Wp(e,r,a,c));break}default:throw new S('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:a,encryptedKey:i,parameters:s}}var li,Ga=m(()=>{ri();Ma();Da();Ua();re();hn();x();Va();yn();Ja();li=O_});var za,Qe,di=m(()=>{re();Fa();ka();Qo();Ga();x();cr();z();dr();za=Symbol(),Qe=class{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this._plaintext=t}setKeyManagementParameters(t){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._sharedUnprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}setContentEncryptionKey(t){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=t,this}async encrypt(t,r){if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new g("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!Me(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new g("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let n={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(De(g,new Map,r?.crit,this._protectedHeader,n),n.zip!==void 0){if(!this._protectedHeader||!this._protectedHeader.zip)throw new g('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if(n.zip!=="DEF")throw new S('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:o,enc:i}=n;if(typeof o!="string"||!o)throw new g('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof i!="string"||!i)throw new g('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let s;if(o==="dir"){if(this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if(o==="ECDH-ES"&&this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");let a;{let y;({cek:a,encryptedKey:s,parameters:y}=await li(o,i,t,this._cek,this._keyManagementParameters)),y&&(r&&za in r?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...y}:this.setUnprotectedHeader(y):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...y}:this.setProtectedHeader(y))}this._iv||(this._iv=Yo(i));let c,u,l;this._protectedHeader?u=$.encode(M(JSON.stringify(this._protectedHeader))):u=$.encode(""),this._aad?(l=M(this._aad),c=te(u,$.encode("."),$.encode(l))):c=u;let d,h;if(n.zip==="DEF"){let y=await(r?.deflateRaw||yp)(this._plaintext);({ciphertext:d,tag:h}=await gn(i,y,a,this._iv,c))}else({ciphertext:d,tag:h}=await gn(i,this._plaintext,a,this._iv,c));let f={ciphertext:M(d),iv:M(this._iv),tag:M(h)};return s&&(f.encrypted_key=M(s)),l&&(f.aad=l),this._protectedHeader&&(f.protected=j.decode(u)),this._sharedUnprotectedHeader&&(f.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(f.header=this._unprotectedHeader),f}}});var Xa,pi,Qp=m(()=>{di();x();hn();cr();Ga();re();dr();Xa=class{constructor(t,r,n){this.parent=t,this.key=r,this.options=n}setUnprotectedHeader(t){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addRecipient(...t){return this.parent.addRecipient(...t)}encrypt(...t){return this.parent.encrypt(...t)}done(){return this.parent}},pi=class{constructor(t){this._recipients=[],this._plaintext=t}addRecipient(t,r){let n=new Xa(this,t,{crit:r?.crit});return this._recipients.push(n),n}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}async encrypt(t){var r,n,o;if(!this._recipients.length)throw new g("at least one recipient must be added");if(t={deflateRaw:t?.deflateRaw},this._recipients.length===1){let[c]=this._recipients,u=await new Qe(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(c.unprotectedHeader).encrypt(c.key,{...c.options,...t}),l={ciphertext:u.ciphertext,iv:u.iv,recipients:[{}],tag:u.tag};return u.aad&&(l.aad=u.aad),u.protected&&(l.protected=u.protected),u.unprotected&&(l.unprotected=u.unprotected),u.encrypted_key&&(l.recipients[0].encrypted_key=u.encrypted_key),u.header&&(l.recipients[0].header=u.header),l}let i;for(let c=0;c<this._recipients.length;c++){let u=this._recipients[c];if(!Me(this._protectedHeader,this._unprotectedHeader,u.unprotectedHeader))throw new g("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let l={...this._protectedHeader,...this._unprotectedHeader,...u.unprotectedHeader},{alg:d}=l;if(typeof d!="string"||!d)throw new g('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(d==="dir"||d==="ECDH-ES")throw new g('"dir" and "ECDH-ES" alg may only be used with a single recipient');if(typeof l.enc!="string"||!l.enc)throw new g('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(!i)i=l.enc;else if(i!==l.enc)throw new g('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients');if(De(g,new Map,u.options.crit,this._protectedHeader,l),l.zip!==void 0&&(!this._protectedHeader||!this._protectedHeader.zip))throw new g('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let s=Ne(i),a={ciphertext:"",iv:"",recipients:[],tag:""};for(let c=0;c<this._recipients.length;c++){let u=this._recipients[c],l={};a.recipients.push(l);let h={...this._protectedHeader,...this._unprotectedHeader,...u.unprotectedHeader}.alg.startsWith("PBES2")?2048+c:void 0;if(c===0){let b=await new Qe(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(s).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(u.unprotectedHeader).setKeyManagementParameters({p2c:h}).encrypt(u.key,{...u.options,...t,[za]:!0});a.ciphertext=b.ciphertext,a.iv=b.iv,a.tag=b.tag,b.aad&&(a.aad=b.aad),b.protected&&(a.protected=b.protected),b.unprotected&&(a.unprotected=b.unprotected),l.encrypted_key=b.encrypted_key,b.header&&(l.header=b.header);continue}let{encryptedKey:f,parameters:y}=await li(((r=u.unprotectedHeader)===null||r===void 0?void 0:r.alg)||((n=this._protectedHeader)===null||n===void 0?void 0:n.alg)||((o=this._unprotectedHeader)===null||o===void 0?void 0:o.alg),i,u.key,s,{p2c:h});l.encrypted_key=M(f),(u.unprotectedHeader||y)&&(l.header={...u.unprotectedHeader,...y})}return a}}});function wn(e,t){let r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":return{name:t.name};default:throw new S(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}var Ya=m(()=>{x()});function bn(e,t,r){if(F(t))return fp(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(L(t,...T));return E.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(L(t,...T,"Uint8Array"))}var Qa=m(()=>{ee();vt();Oe();Te()});var T_,Zp,ef=m(()=>{Ya();ee();ii();Qa();T_=async(e,t,r,n)=>{let o=await bn(e,t,"verify");Dt(e,o);let i=wn(e,o.algorithm);try{return await E.subtle.verify(i,o,r,n)}catch{return!1}},Zp=T_});async function fr(e,t,r){var n;if(!I(e))throw new P("Flattened JWS must be an object");if(e.protected===void 0&&e.header===void 0)throw new P('Flattened JWS must have either of the "protected" or "header" members');if(e.protected!==void 0&&typeof e.protected!="string")throw new P("JWS Protected Header incorrect type");if(e.payload===void 0)throw new P("JWS Payload missing");if(typeof e.signature!="string")throw new P("JWS Signature missing or incorrect type");if(e.header!==void 0&&!I(e.header))throw new P("JWS Unprotected Header incorrect type");let o={};if(e.protected)try{let J=U(e.protected);o=JSON.parse(j.decode(J))}catch{throw new P("JWS Protected Header is invalid")}if(!Me(o,e.header))throw new P("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let i={...o,...e.header},s=De(P,new Map([["b64",!0]]),r?.crit,o,i),a=!0;if(s.has("b64")&&(a=o.b64,typeof a!="boolean"))throw new P('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:c}=i;if(typeof c!="string"||!c)throw new P('JWS "alg" (Algorithm) Header Parameter missing or invalid');let u=r&&vn("algorithms",r.algorithms);if(u&&!u.has(c))throw new ht('"alg" (Algorithm) Header Parameter not allowed');if(a){if(typeof e.payload!="string")throw new P("JWS Payload must be a string")}else if(typeof e.payload!="string"&&!(e.payload instanceof Uint8Array))throw new P("JWS Payload must be a string or an Uint8Array instance");let l=!1;typeof t=="function"&&(t=await t(o,e),l=!0),_t(c,t,"verify");let d=te($.encode((n=e.protected)!==null&&n!==void 0?n:""),$.encode("."),typeof e.payload=="string"?$.encode(e.payload):e.payload),h=U(e.signature);if(!await Zp(c,t,h,d))throw new Nt;let y;a?y=U(e.payload):typeof e.payload=="string"?y=$.encode(e.payload):y=e.payload;let b={payload:y};return e.protected!==void 0&&(b.protectedHeader=o),e.header!==void 0&&(b.unprotectedHeader=e.header),l?{...b,key:t}:b}var fi=m(()=>{re();ef();x();z();cr();ve();yn();dr();ja()});async function hi(e,t,r){if(e instanceof Uint8Array&&(e=j.decode(e)),typeof e!="string")throw new P("Compact JWS must be a string or Uint8Array");let{0:n,1:o,2:i,length:s}=e.split(".");if(s!==3)throw new P("Invalid Compact JWS");let a=await fr({payload:o,protected:n,signature:i},t,r),c={payload:a.payload,protectedHeader:a.protectedHeader};return typeof t=="function"?{...c,key:a.key}:c}var Za=m(()=>{fi();x();z()});async function tf(e,t,r){if(!I(e))throw new P("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(I))throw new P("JWS Signatures missing or incorrect type");for(let n of e.signatures)try{return await fr({header:n.header,payload:e.payload,protected:n.protected,signature:n.signature},t,r)}catch{}throw new Nt}var rf=m(()=>{fi();x();ve()});var hr,ec=m(()=>{hr=e=>Math.floor(e.getTime()/1e3)});var I_,mr,tc=m(()=>{I_=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,mr=e=>{let t=I_.exec(e);if(!t)throw new TypeError("Invalid time period format");let r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(r*60);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(r*3600);case"day":case"days":case"d":return Math.round(r*86400);case"week":case"weeks":case"w":return Math.round(r*604800);default:return Math.round(r*31557600)}}});var nf,q_,yr,mi=m(()=>{x();z();ec();tc();ve();nf=e=>e.toLowerCase().replace(/^application\//,""),q_=(e,t)=>typeof e=="string"?t.includes(e):Array.isArray(e)?t.some(Set.prototype.has.bind(new Set(e))):!1,yr=(e,t,r={})=>{let{typ:n}=r;if(n&&(typeof e.typ!="string"||nf(e.typ)!==nf(n)))throw new Y('unexpected "typ" JWT header value',"typ","check_failed");let o;try{o=JSON.parse(j.decode(t))}catch{}if(!I(o))throw new B("JWT Claims Set must be a top-level JSON object");let{requiredClaims:i=[],issuer:s,subject:a,audience:c,maxTokenAge:u}=r;u!==void 0&&i.push("iat"),c!==void 0&&i.push("aud"),a!==void 0&&i.push("sub"),s!==void 0&&i.push("iss");for(let f of new Set(i.reverse()))if(!(f in o))throw new Y(`missing required "${f}" claim`,f,"missing");if(s&&!(Array.isArray(s)?s:[s]).includes(o.iss))throw new Y('unexpected "iss" claim value',"iss","check_failed");if(a&&o.sub!==a)throw new Y('unexpected "sub" claim value',"sub","check_failed");if(c&&!q_(o.aud,typeof c=="string"?[c]:c))throw new Y('unexpected "aud" claim value',"aud","check_failed");let l;switch(typeof r.clockTolerance){case"string":l=mr(r.clockTolerance);break;case"number":l=r.clockTolerance;break;case"undefined":l=0;break;default:throw new TypeError("Invalid clockTolerance option type")}let{currentDate:d}=r,h=hr(d||new Date);if((o.iat!==void 0||u)&&typeof o.iat!="number")throw new Y('"iat" claim must be a number',"iat","invalid");if(o.nbf!==void 0){if(typeof o.nbf!="number")throw new Y('"nbf" claim must be a number',"nbf","invalid");if(o.nbf>h+l)throw new Y('"nbf" claim timestamp check failed',"nbf","check_failed")}if(o.exp!==void 0){if(typeof o.exp!="number")throw new Y('"exp" claim must be a number',"exp","invalid");if(o.exp<=h-l)throw new sr('"exp" claim timestamp check failed',"exp","check_failed")}if(u){let f=h-o.iat,y=typeof u=="number"?u:mr(u);if(f-l>y)throw new sr('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(f<0-l)throw new Y('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return o}});async function of(e,t,r){var n;let o=await hi(e,t,r);if(!((n=o.protectedHeader.crit)===null||n===void 0)&&n.includes("b64")&&o.protectedHeader.b64===!1)throw new B("JWTs MUST NOT use unencoded payload");let s={payload:yr(o.protectedHeader,o.payload,r),protectedHeader:o.protectedHeader};return typeof t=="function"?{...s,key:o.key}:s}var sf=m(()=>{Za();mi();x()});async function af(e,t,r){let n=await ci(e,t,r),o=yr(n.protectedHeader,n.plaintext,r),{protectedHeader:i}=n;if(i.iss!==void 0&&i.iss!==o.iss)throw new Y('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(i.sub!==void 0&&i.sub!==o.sub)throw new Y('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(i.aud!==void 0&&JSON.stringify(i.aud)!==JSON.stringify(o.aud))throw new Y('replicated "aud" claim header parameter mismatch',"aud","mismatch");let s={payload:o,protectedHeader:i};return typeof t=="function"?{...s,key:n.key}:s}var cf=m(()=>{Ba();mi();x()});var gr,rc=m(()=>{di();gr=class{constructor(t){this._flattened=new Qe(t)}setContentEncryptionKey(t){return this._flattened.setContentEncryptionKey(t),this}setInitializationVector(t){return this._flattened.setInitializationVector(t),this}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}setKeyManagementParameters(t){return this._flattened.setKeyManagementParameters(t),this}async encrypt(t,r){let n=await this._flattened.encrypt(t,r);return[n.protected,n.encrypted_key,n.iv,n.ciphertext,n.tag].join(".")}}});var H_,uf,lf=m(()=>{Ya();ee();ii();Qa();H_=async(e,t,r)=>{let n=await bn(e,t,"sign");Dt(e,n);let o=await E.subtle.sign(wn(e,n.algorithm),n,r);return new Uint8Array(o)},uf=H_});var Et,yi=m(()=>{re();lf();cr();x();z();yn();dr();Et=class{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=t}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}async sign(t,r){if(!this._protectedHeader&&!this._unprotectedHeader)throw new P("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!Me(this._protectedHeader,this._unprotectedHeader))throw new P("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let n={...this._protectedHeader,...this._unprotectedHeader},o=De(P,new Map([["b64",!0]]),r?.crit,this._protectedHeader,n),i=!0;if(o.has("b64")&&(i=this._protectedHeader.b64,typeof i!="boolean"))throw new P('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:s}=n;if(typeof s!="string"||!s)throw new P('JWS "alg" (Algorithm) Header Parameter missing or invalid');_t(s,t,"sign");let a=this._payload;i&&(a=$.encode(M(a)));let c;this._protectedHeader?c=$.encode(M(JSON.stringify(this._protectedHeader))):c=$.encode("");let u=te(c,$.encode("."),a),l=await uf(s,t,u),d={signature:M(l),payload:""};return i&&(d.payload=j.decode(a)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=j.decode(c)),d}}});var vr,nc=m(()=>{yi();vr=class{constructor(t){this._flattened=new Et(t)}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}async sign(t,r){let n=await this._flattened.sign(t,r);if(n.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}}});var oc,gi,df=m(()=>{yi();x();oc=class{constructor(t,r,n){this.parent=t,this.key=r,this.options=n}setProtectedHeader(t){if(this.protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this.protectedHeader=t,this}setUnprotectedHeader(t){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addSignature(...t){return this.parent.addSignature(...t)}sign(...t){return this.parent.sign(...t)}done(){return this.parent}},gi=class{constructor(t){this._signatures=[],this._payload=t}addSignature(t,r){let n=new oc(this,t,r);return this._signatures.push(n),n}async sign(){if(!this._signatures.length)throw new P("at least one signature must be added");let t={signatures:[],payload:""};for(let r=0;r<this._signatures.length;r++){let n=this._signatures[r],o=new Et(this._payload);o.setProtectedHeader(n.protectedHeader),o.setUnprotectedHeader(n.unprotectedHeader);let{payload:i,...s}=await o.sign(n.key,n.options);if(r===0)t.payload=i;else if(t.payload!==i)throw new P("inconsistent use of JWS Unencoded Payload (RFC7797)");t.signatures.push(s)}return t}}});var St,vi=m(()=>{ec();ve();tc();St=class{constructor(t){if(!I(t))throw new TypeError("JWT Claims Set MUST be an object");this._payload=t}setIssuer(t){return this._payload={...this._payload,iss:t},this}setSubject(t){return this._payload={...this._payload,sub:t},this}setAudience(t){return this._payload={...this._payload,aud:t},this}setJti(t){return this._payload={...this._payload,jti:t},this}setNotBefore(t){return typeof t=="number"?this._payload={...this._payload,nbf:t}:this._payload={...this._payload,nbf:hr(new Date)+mr(t)},this}setExpirationTime(t){return typeof t=="number"?this._payload={...this._payload,exp:t}:this._payload={...this._payload,exp:hr(new Date)+mr(t)},this}setIssuedAt(t){return typeof t>"u"?this._payload={...this._payload,iat:hr(new Date)}:this._payload={...this._payload,iat:t},this}}});var wi,pf=m(()=>{nc();x();z();vi();wi=class extends St{setProtectedHeader(t){return this._protectedHeader=t,this}async sign(t,r){var n;let o=new vr($.encode(JSON.stringify(this._payload)));if(o.setProtectedHeader(this._protectedHeader),Array.isArray((n=this._protectedHeader)===null||n===void 0?void 0:n.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new B("JWTs MUST NOT use unencoded payload");return o.sign(t,r)}}});var bi,ff=m(()=>{rc();z();vi();bi=class extends St{setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setKeyManagementParameters(t){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setContentEncryptionKey(t){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=t,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(t,r){let n=new gr($.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),n.setProtectedHeader(this._protectedHeader),this._iv&&n.setInitializationVector(this._iv),this._cek&&n.setContentEncryptionKey(this._cek),this._keyManagementParameters&&n.setKeyManagementParameters(this._keyManagementParameters),n.encrypt(t,r)}}});async function ic(e,t){if(!I(e))throw new TypeError("JWK must be an object");if(t??(t="sha256"),t!=="sha256"&&t!=="sha384"&&t!=="sha512")throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let r;switch(e.kty){case"EC":At(e.crv,'"crv" (Curve) Parameter'),At(e.x,'"x" (X Coordinate) Parameter'),At(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":At(e.crv,'"crv" (Subtype of Key Pair) Parameter'),At(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":At(e.e,'"e" (Exponent) Parameter'),At(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":At(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new S('"kty" (Key Type) Parameter missing or unsupported')}let n=$.encode(JSON.stringify(r));return M(await jo(t,n))}async function hf(e,t){t??(t="sha256");let r=await ic(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}var At,mf=m(()=>{Aa();re();x();z();ve();At=(e,t)=>{if(typeof e!="string"||!e)throw new an(`${t} missing or invalid`)}});async function yf(e,t){let r={...e,...t?.header};if(!I(r.jwk))throw new P('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let n=await bt({...r.jwk,ext:!0},r.alg,!0);if(n instanceof Uint8Array||n.type!=="public")throw new P('"jwk" (JSON Web Key) Header Parameter must be a public key');return n}var gf=m(()=>{mn();ve();x()});function k_(e){switch(typeof e=="string"&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new S('Unsupported "alg" value for a JSON Web Key Set')}}function sc(e){return e&&typeof e=="object"&&Array.isArray(e.keys)&&e.keys.every($_)}function $_(e){return I(e)}function M_(e){return typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}async function vf(e,t,r){let n=e.get(t)||e.set(t,{}).get(t);if(n[r]===void 0){let o=await bt({...t,ext:!0},r);if(o instanceof Uint8Array||o.type!=="public")throw new mt("JSON Web Key Set members must be public keys");n[r]=o}return n[r]}function wf(e){let t=new _n(e);return async function(r,n){return t.getKey(r,n)}}var _n,ac=m(()=>{mn();x();ve();_n=class{constructor(t){if(this._cached=new WeakMap,!sc(t))throw new mt("JSON Web Key Set malformed");this._jwks=M_(t)}async getKey(t,r){let{alg:n,kid:o}={...t,...r?.header},i=k_(n),s=this._jwks.keys.filter(u=>{let l=i===u.kty;if(l&&typeof o=="string"&&(l=o===u.kid),l&&typeof u.alg=="string"&&(l=n===u.alg),l&&typeof u.use=="string"&&(l=u.use==="sig"),l&&Array.isArray(u.key_ops)&&(l=u.key_ops.includes("verify")),l&&n==="EdDSA"&&(l=u.crv==="Ed25519"||u.crv==="Ed448"),l)switch(n){case"ES256":l=u.crv==="P-256";break;case"ES256K":l=u.crv==="secp256k1";break;case"ES384":l=u.crv==="P-384";break;case"ES512":l=u.crv==="P-521";break}return l}),{0:a,length:c}=s;if(c===0)throw new Mt;if(c!==1){let u=new cn,{_cached:l}=this;throw u[Symbol.asyncIterator]=async function*(){for(let d of s)try{yield await vf(l,d,n)}catch{continue}},u}return vf(this._cached,a,n)}}});var N_,bf,_f=m(()=>{x();N_=async(e,t,r)=>{let n,o,i=!1;typeof AbortController=="function"&&(n=new AbortController,o=setTimeout(()=>{i=!0,n.abort()},t));let s=await fetch(e.href,{signal:n?n.signal:void 0,redirect:"manual",headers:r.headers}).catch(a=>{throw i?new un:a});if(o!==void 0&&clearTimeout(o),s.status!==200)throw new V("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await s.json()}catch{throw new V("Failed to parse the JSON Web Key Set HTTP response as JSON")}},bf=N_});function D_(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}function Ef(e,t){let r=new cc(e,t);return async function(n,o){return r.getKey(n,o)}}var cc,Sf=m(()=>{_f();x();ac();cc=class extends _n{constructor(t,r){if(super({keys:[]}),this._jwks=void 0,!(t instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(t.href),this._options={agent:r?.agent,headers:r?.headers},this._timeoutDuration=typeof r?.timeoutDuration=="number"?r?.timeoutDuration:5e3,this._cooldownDuration=typeof r?.cooldownDuration=="number"?r?.cooldownDuration:3e4,this._cacheMaxAge=typeof r?.cacheMaxAge=="number"?r?.cacheMaxAge:6e5}coolingDown(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cooldownDuration:!1}fresh(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cacheMaxAge:!1}async getKey(t,r){(!this._jwks||!this.fresh())&&await this.reload();try{return await super.getKey(t,r)}catch(n){if(n instanceof Mt&&this.coolingDown()===!1)return await this.reload(),super.getKey(t,r);throw n}}async reload(){this._pendingFetch&&D_()&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=bf(this._url,this._timeoutDuration,this._options).then(t=>{if(!sc(t))throw new mt("JSON Web Key Set malformed");this._jwks={keys:t.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(t=>{throw this._pendingFetch=void 0,t})),await this._pendingFetch}}});var _i,Af=m(()=>{re();z();x();mi();vi();_i=class extends St{encode(){let t=M(JSON.stringify({alg:"none"})),r=M(JSON.stringify(this._payload));return`${t}.${r}.`}static decode(t,r){if(typeof t!="string")throw new B("Unsecured JWT must be a string");let{0:n,1:o,2:i,length:s}=t.split(".");if(s!==3||i!=="")throw new B("Invalid Unsecured JWT");let a;try{if(a=JSON.parse(j.decode(U(n))),a.alg!=="none")throw new Error}catch{throw new B("Invalid Unsecured JWT")}return{payload:yr(a,U(o),r),header:a}}}});var uc={};Vt(uc,{decode:()=>En,encode:()=>U_});var U_,En,Ei=m(()=>{re();U_=M,En=U});function Rf(e){let t;if(typeof e=="string"){let r=e.split(".");(r.length===3||r.length===5)&&([t]=r)}else if(typeof e=="object"&&e)if("protected"in e)t=e.protected;else throw new TypeError("Token does not contain a Protected Header");try{if(typeof t!="string"||!t)throw new Error;let r=JSON.parse(j.decode(En(t)));if(!I(r))throw new Error;return r}catch{throw new TypeError("Invalid Token or Protected Header formatting")}}var xf=m(()=>{Ei();z();ve()});function Cf(e){if(typeof e!="string")throw new B("JWTs must use Compact JWS serialization, JWT must be a string");let{1:t,length:r}=e.split(".");if(r===5)throw new B("Only JWTs using Compact JWS serialization can be decoded");if(r!==3)throw new B("Invalid JWT");if(!t)throw new B("JWTs must contain a payload");let n;try{n=En(t)}catch{throw new B("Failed to parse the base64url encoded payload")}let o;try{o=JSON.parse(j.decode(n))}catch{throw new B("Failed to parse the decoded payload as JSON")}if(!I(o))throw new B("Invalid JWT Claims Set");return o}var Pf=m(()=>{Ei();z();ve();x()});async function Of(e,t){var r;let n,o,i;switch(e){case"HS256":case"HS384":case"HS512":n=parseInt(e.slice(-3),10),o={name:"HMAC",hash:`SHA-${n}`,length:n},i=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return n=parseInt(e.slice(-3),10),yt(new Uint8Array(n>>3));case"A128KW":case"A192KW":case"A256KW":n=parseInt(e.slice(1,4),10),o={name:"AES-KW",length:n},i=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":n=parseInt(e.slice(1,4),10),o={name:"AES-GCM",length:n},i=["encrypt","decrypt"];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return E.subtle.generateKey(o,(r=t?.extractable)!==null&&r!==void 0?r:!1,i)}function lc(e){var t;let r=(t=e?.modulusLength)!==null&&t!==void 0?t:2048;if(typeof r!="number"||r<2048)throw new S("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}async function Tf(e,t){var r,n,o;let i,s;switch(e){case"PS256":case"PS384":case"PS512":i={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:lc(t)},s=["sign","verify"];break;case"RS256":case"RS384":case"RS512":i={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:lc(t)},s=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":i={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:lc(t)},s=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":i={name:"ECDSA",namedCurve:"P-256"},s=["sign","verify"];break;case"ES384":i={name:"ECDSA",namedCurve:"P-384"},s=["sign","verify"];break;case"ES512":i={name:"ECDSA",namedCurve:"P-521"},s=["sign","verify"];break;case"EdDSA":s=["sign","verify"];let a=(r=t?.crv)!==null&&r!==void 0?r:"Ed25519";switch(a){case"Ed25519":case"Ed448":i={name:a};break;default:throw new S("Invalid or unsupported crv option provided")}break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{s=["deriveKey","deriveBits"];let c=(n=t?.crv)!==null&&n!==void 0?n:"P-256";switch(c){case"P-256":case"P-384":case"P-521":{i={name:"ECDH",namedCurve:c};break}case"X25519":case"X448":i={name:c};break;default:throw new S("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return E.subtle.generateKey(i,(o=t?.extractable)!==null&&o!==void 0?o:!1,s)}var dc=m(()=>{ee();x();ln()});async function If(e,t){return Tf(e,t)}var qf=m(()=>{dc()});async function Hf(e,t){return Of(e,t)}var kf=m(()=>{dc()});var $f={};Vt($f,{CompactEncrypt:()=>gr,CompactSign:()=>vr,EmbeddedJWK:()=>yf,EncryptJWT:()=>bi,FlattenedEncrypt:()=>Qe,FlattenedSign:()=>Et,GeneralEncrypt:()=>pi,GeneralSign:()=>gi,SignJWT:()=>wi,UnsecuredJWT:()=>_i,base64url:()=>uc,calculateJwkThumbprint:()=>ic,calculateJwkThumbprintUri:()=>hf,compactDecrypt:()=>ci,compactVerify:()=>hi,createLocalJWKSet:()=>wf,createRemoteJWKSet:()=>Ef,decodeJwt:()=>Cf,decodeProtectedHeader:()=>Rf,errors:()=>Ca,exportJWK:()=>ui,exportPKCS8:()=>Yp,exportSPKI:()=>Xp,flattenedDecrypt:()=>pr,flattenedVerify:()=>fr,generalDecrypt:()=>Bp,generalVerify:()=>tf,generateKeyPair:()=>If,generateSecret:()=>Hf,importJWK:()=>bt,importPKCS8:()=>Kp,importSPKI:()=>Up,importX509:()=>Lp,jwtDecrypt:()=>af,jwtVerify:()=>of});var Mf=m(()=>{Ba();ai();Vp();Qp();Za();fi();rf();sf();cf();rc();di();nc();yi();df();pf();ff();mf();gf();ac();Sf();Af();Va();mn();xf();Pf();x();qf();kf();Ei()});var Nf=p(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.getHMACKey=void 0;function L_(e){let t=new Uint8Array(e.length);for(let r=0,n=e.length;r<n;r++)t[r]=e.charCodeAt(r);return t}Si.getHMACKey=L_});var fc=p(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.decodeSessionToken=void 0;var pc=(k(),R(H)),K_=pc.__importStar((Mf(),R($f))),Df=pc.__importStar(W()),W_=Nf(),F_=10;function J_(e){return t=>pc.__awaiter(this,void 0,void 0,function*(){let r;try{r=(yield K_.jwtVerify(t,(0,W_.getHMACKey)(e.apiSecretKey),{algorithms:["HS256"],clockTolerance:F_})).payload}catch(n){throw new Df.InvalidJwtError(`Failed to parse session token '${t}': ${n.message}`)}if(r.aud!==e.apiKey)throw new Df.InvalidJwtError("Session token had invalid API key");return r})}Ai.decodeSessionToken=J_});var yc=p(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.customAppSession=Ue.getCurrentSessionId=Ue.getOfflineId=Ue.getJwtSessionId=void 0;var hc=(k(),R(H)),j_=Jo(),Uf=je(),mc=sn(),B_=me(),V_=hc.__importStar(W()),G_=fc(),z_=Yr();function Lf(e){return(t,r)=>`${(0,mc.sanitizeShop)(e)(t,!0)}_${r}`}Ue.getJwtSessionId=Lf;function Kf(e){return t=>`offline_${(0,mc.sanitizeShop)(e)(t,!0)}`}Ue.getOfflineId=Kf;function X_(e){return function(r){var{isOnline:n}=r,o=hc.__rest(r,["isOnline"]);return hc.__awaiter(this,void 0,void 0,function*(){let i=yield(0,Uf.abstractConvertRequest)(o),s=(0,B_.logger)(e);if(e.isEmbeddedApp){s.debug("App is embedded, looking for session id in JWT payload",{isOnline:n});let a=i.headers.Authorization;if(a){let c=(typeof a=="string"?a:a[0]).match(/^Bearer (.+)$/);if(!c)throw s.error("Missing Bearer token in authorization header",{isOnline:n}),new V_.MissingJwtTokenError("Missing Bearer token in authorization header");let u=yield(0,G_.decodeSessionToken)(e)(c[1]),l=u.dest.replace(/^https:\/\//,"");return s.debug("Found valid JWT payload",{shop:l,isOnline:n}),n?Lf(e)(l,u.sub):Kf(e)(l)}else s.error("Missing Authorization header, was the request made with authenticatedFetch?",{isOnline:n})}else return s.debug("App is not embedded, looking for session id in cookies",{isOnline:n}),new Uf.Cookies(i,{},{keys:[e.apiSecretKey]}).getAndVerify(j_.SESSION_COOKIE_NAME)})}}Ue.getCurrentSessionId=X_;function Y_(e){return t=>new z_.Session({id:"",shop:`${(0,mc.sanitizeShop)(e)(t,!0)}`,state:"",isOnline:!1})}Ue.customAppSession=Y_});var vc=p(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.nonce=void 0;var gc=Ht();function Q_(){return(gc.crypto.getRandomValues?gc.crypto.getRandomValues(new Uint8Array(15)):gc.crypto.randomBytes(15)).map(n=>n%10).join("")}Ri.nonce=Q_});var Gf=p(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.callback=wr.begin=void 0;var Ze=(k(),R(H)),Z_=Kd(),Jf=Ze.__importDefault(pt()),eE=Ze.__importDefault(wo()),xi=Ze.__importStar(W()),tE=Ea(),jf=sn(),Wf=Yr(),Ff=yc(),rE=er(),nE=zr(),Rt=je(),wc=me(),Ci=Jo(),oE=vc(),iE=nn(),Bf=({request:e,log:t,func:r})=>{t.debug(`Possible bot request to auth ${r}: `,{userAgent:e.headers["User-Agent"]})};function sE(e){return t=>Ze.__awaiter(this,void 0,void 0,function*(){var{shop:r,callbackPath:n,isOnline:o}=t,i=Ze.__rest(t,["shop","callbackPath","isOnline"]);Vf(e.isCustomStoreApp,"Cannot perform OAuth for private apps");let s=(0,wc.logger)(e);s.info("Beginning OAuth",{shop:r,isOnline:o,callbackPath:n});let a=yield(0,Rt.abstractConvertRequest)(i),c=yield(0,Rt.abstractConvertIncomingResponse)(i);if((0,Jf.default)(a.headers["User-Agent"]))return Bf({request:a,log:s,func:"begin"}),c.statusCode=410,(0,Rt.abstractConvertResponse)(c,i);let u=new Rt.Cookies(a,c,{keys:[e.apiSecretKey],secure:!0}),l=(0,oE.nonce)();yield u.setAndSign(Ci.STATE_COOKIE_NAME,l,{expires:new Date(Date.now()+6e4),sameSite:"lax",secure:!0,path:n});let d={client_id:e.apiKey,scope:e.scopes.toString(),redirect_uri:`${e.hostScheme}://${e.hostName}${n}`,state:l,"grant_options[]":o?"per-user":""},h=new eE.default;h.putAll(d);let y=`https://${(0,jf.sanitizeShop)(e)(r,!0)}/admin/oauth/authorize${h.stringify()}`;return c.statusCode=302,c.statusText="Found",c.headers=Object.assign(Object.assign(Object.assign({},c.headers),u.response.headers),{Location:y}),s.debug(`OAuth started, redirecting to ${y}`,{shop:r,isOnline:o}),(0,Rt.abstractConvertResponse)(c,i)})}wr.begin=sE;function aE(e){return function(r){var n=Ze.__rest(r,[]);return Ze.__awaiter(this,void 0,void 0,function*(){Vf(e.isCustomStoreApp,"Cannot perform OAuth for private apps");let o=(0,wc.logger)(e),i=yield(0,Rt.abstractConvertRequest)(n),s=new URL(i.url,`${e.hostScheme}://${e.hostName}`).searchParams,a=s.get("shop"),c={};if((0,Jf.default)(i.headers["User-Agent"]))throw Bf({request:i,log:o,func:"callback"}),new xi.BotActivityDetected("Invalid OAuth callback initiated by bot");o.info("Completing OAuth",{shop:a});let u=new Rt.Cookies(i,c,{keys:[e.apiSecretKey],secure:!0}),l=yield u.getAndVerify(Ci.STATE_COOKIE_NAME);if(u.deleteCookie(Ci.STATE_COOKIE_NAME),!l)throw o.error("Could not find OAuth cookie",{shop:a}),new xi.CookieNotFound(`Cannot complete OAuth process. Could not find an OAuth cookie for shop url: ${a}`);let d=Object.fromEntries(s.entries());if(!(yield cE({config:e,query:d,stateFromCookie:l})))throw o.error("Invalid OAuth callback",{shop:a,stateFromCookie:l}),new xi.InvalidOAuthError("Invalid OAuth callback.");o.debug("OAuth request is valid, requesting access token",{shop:a});let h={client_id:e.apiKey,client_secret:e.apiSecretKey,code:s.get("code")},f={path:"/admin/oauth/access_token",type:nE.DataType.JSON,data:h},y=(0,jf.sanitizeShop)(e)(s.get("shop"),!0),b=(0,rE.httpClientClass)(e),xe=yield new b({domain:y}).post(f),ke=uE({postResponse:xe,shop:y,stateFromCookie:l,config:e});return e.isEmbeddedApp||(yield u.setAndSign(Ci.SESSION_COOKIE_NAME,ke.id,{expires:ke.expires,sameSite:"lax",secure:!0,path:"/"})),{headers:yield(0,Rt.abstractConvertHeaders)(u.response.headers,n),session:ke}})}}wr.callback=aE;function cE({config:e,query:t,stateFromCookie:r}){return Ze.__awaiter(this,void 0,void 0,function*(){return(yield(0,tE.validateHmac)(e)(t))&&(0,iE.safeCompare)(t.state,r)})}function uE({config:e,postResponse:t,shop:r,stateFromCookie:n}){let o=t.body.associated_user,i=Boolean(o);if((0,wc.logger)(e).info("Creating new session",{shop:r,isOnline:i}),i){let s,a=t.body,{access_token:c,scope:u}=a,l=Ze.__rest(a,["access_token","scope"]),d=new Date(Date.now()+a.expires_in*1e3);return e.isEmbeddedApp?s=(0,Ff.getJwtSessionId)(e)(r,`${l.associated_user.id}`):s=(0,Z_.v4)(),new Wf.Session({id:s,shop:r,state:n,isOnline:i,accessToken:c,scope:u,expires:d,onlineAccessInfo:l})}else{let s=t.body;return new Wf.Session({id:(0,Ff.getOfflineId)(e)(r),shop:r,state:n,isOnline:i,accessToken:s.access_token,scope:s.scope})}}function Vf(e,t){if(e)throw new xi.PrivateAppError(t)}});var Ec=p(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.buildEmbeddedAppUrl=br.getEmbeddedAppUrl=void 0;var _c=(k(),R(H)),bc=_c.__importStar(W()),lE=je(),dE=sn(),pE=Sa();function fE(e){return t=>_c.__awaiter(this,void 0,void 0,function*(){var r=_c.__rest(t,[]);let n=yield(0,lE.abstractConvertRequest)(r);if(!n)throw new bc.MissingRequiredArgument("getEmbeddedAppUrl requires a request object argument");if(!n.url)throw new bc.InvalidRequestError("Request does not contain a URL");let i=new URL(n.url,`https://${n.headers.host}`).searchParams.get("host");if(typeof i!="string")throw new bc.InvalidRequestError("Request does not contain a host query parameter");return zf(e)(i)})}br.getEmbeddedAppUrl=fE;function zf(e){return t=>((0,dE.sanitizeHost)(e)(t,!0),`https://${(0,pE.decodeHost)(t)}/apps/${e.apiKey}`)}br.buildEmbeddedAppUrl=zf});var Qf=p(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.shopifyAuth=void 0;var Xf=Gf(),hE=vc(),mE=nn(),Yf=Ec();function yE(e){return{begin:(0,Xf.begin)(e),callback:(0,Xf.callback)(e),nonce:hE.nonce,safeCompare:mE.safeCompare,getEmbeddedAppUrl:(0,Yf.getEmbeddedAppUrl)(e),buildEmbeddedAppUrl:(0,Yf.buildEmbeddedAppUrl)(e)}}Pi.shopifyAuth=yE});var Zf=p(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.shopifySession=void 0;var gE=fc(),Oi=yc();function vE(e){return{customAppSession:(0,Oi.customAppSession)(e),getCurrentId:(0,Oi.getCurrentSessionId)(e),getOfflineId:(0,Oi.getOfflineId)(e),getJwtSessionId:(0,Oi.getJwtSessionId)(e),decodeSessionToken:(0,gE.decodeSessionToken)(e)}}Ti.shopifySession=vE});var Sc=p(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.versionPriorTo=_r.versionCompatible=void 0;var wE=be();function eh(e){return(t,r=e.apiVersion)=>{if(r===wE.ApiVersion.Unstable)return!0;let n=s=>parseInt(s.replace("-",""),10),o=n(r),i=n(t);return o>=i}}_r.versionCompatible=eh;function bE(e){return(t,r=e.apiVersion)=>!eh(e)(t,r)}_r.versionPriorTo=bE});var nh=p(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.shopifyUtils=void 0;var th=sn(),_E=Ea(),rh=Sc();function EE(e){return{sanitizeShop:(0,th.sanitizeShop)(e),sanitizeHost:(0,th.sanitizeHost)(e),validateHmac:(0,_E.validateHmac)(e),versionCompatible:(0,rh.versionCompatible)(e),versionPriorTo:(0,rh.versionPriorTo)(e)}}Ii.shopifyUtils=EE});var Er=p(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.WebhookValidationErrorReason=Ie.WebhookOperation=Ie.DeliveryMethod=void 0;var SE;(function(e){e.Http="http",e.EventBridge="eventbridge",e.PubSub="pubsub"})(SE=Ie.DeliveryMethod||(Ie.DeliveryMethod={}));var AE;(function(e){e.Create="create",e.Update="update",e.Delete="delete"})(AE=Ie.WebhookOperation||(Ie.WebhookOperation={}));var RE;(function(e){e.MissingHeaders="missing_headers",e.MissingBody="missing_body",e.InvalidHmac="invalid_hmac"})(RE=Ie.WebhookValidationErrorReason||(Ie.WebhookValidationErrorReason={}))});var qi=p(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.addHostToCallbackUrl=ue.handlerIdentifier=ue.getHandlers=ue.getTopicsAdded=ue.addHandlers=ue.topicForStorage=ue.registry=void 0;var ih=W(),xE=me(),Sn=Er();function CE(){return{}}ue.registry=CE;function Rc(e){return e.toUpperCase().replace(/\/|\./g,"_")}ue.topicForStorage=Rc;function PE(e,t){return function(n){for(let[o,i]of Object.entries(n)){let s=Rc(o);if(Array.isArray(i))for(let a of i)oh(e,t,s,a);else oh(e,t,s,i)}}}ue.addHandlers=PE;function OE(e){return function(){return Object.keys(e)}}ue.getTopicsAdded=OE;function TE(e){return function(r){return e[Rc(r)]||[]}}ue.getHandlers=TE;function Ac(e,t){let r=t.deliveryMethod;switch(t.deliveryMethod){case Sn.DeliveryMethod.Http:return`${r}_${sh(e,t.callbackUrl)}`;case Sn.DeliveryMethod.EventBridge:return`${r}_${t.arn}`;case Sn.DeliveryMethod.PubSub:return`${r}_${t.pubSubProject}:${t.pubSubTopic}`;default:throw new ih.InvalidDeliveryMethodError(`Unrecognized delivery method '${t.deliveryMethod}'`)}}ue.handlerIdentifier=Ac;function sh(e,t){return t.startsWith("/")?`${e.hostScheme}://${e.hostName}${t}`:t}ue.addHostToCallbackUrl=sh;function oh(e,t,r,n){var o,i,s;let a=(0,xE.logger)(e);if((o=n.includeFields)===null||o===void 0||o.sort(),(i=n.metafieldNamespaces)===null||i===void 0||i.sort(),n.deliveryMethod===Sn.DeliveryMethod.Http&&(n.privateMetafieldNamespaces&&a.deprecated("8.0.0","The privateMetafieldNamespaces handler option is deprecated, and will be removed in v8.0.0. See https://shopify.dev/docs/apps/custom-data/metafields/migrate-private-metafields"),(s=n.privateMetafieldNamespaces)===null||s===void 0||s.sort()),!(r in t)){t[r]=[n];return}let c=Ac(e,n);for(let u in t[r]){if(!Object.prototype.hasOwnProperty.call(t[r],u))continue;let l=t[r][u],d=Ac(e,l);if(c===d)if(n.deliveryMethod===Sn.DeliveryMethod.Http){a.info(`Detected multiple handlers for '${r}', webhooks.process will call them sequentially`);break}else throw new ih.InvalidDeliveryMethodError(`Can only add multiple handlers when deliveryMethod is Http. Invalid handler: ${JSON.stringify(n)}`)}t[r].push(n)}});var ah=p(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});Hi.queryTemplate=void 0;function IE(e,t){let r=e;return Object.entries(t).forEach(([n,o])=>{r=r.replace(`{{${n}}}`,o)}),r}Hi.queryTemplate=IE});var fh=p(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.TEMPLATE_MUTATION=Le.TEMPLATE_GET_HANDLERS=Le.register=void 0;var Sr=(k(),R(H)),uh=Sc(),Cc=Ge(),Mi=W(),lh=me(),Pc=be(),$i=qi(),dh=ah(),G=Er();function qE(e,t){return function({session:n}){return Sr.__awaiter(this,void 0,void 0,function*(){let o=(0,lh.logger)(e);o.info("Registering webhooks",{shop:n.shop});let i=Object.keys(t).reduce((a,c)=>(a[c]=[],a),{}),s=yield HE(e,n);o.debug(`Existing topics: [${Object.keys(s).join(", ")}]`,{shop:n.shop});for(let a in t)Object.prototype.hasOwnProperty.call(t,a)&&(Pc.gdprTopics.includes(a)||(i[a]=yield NE({config:e,session:n,topic:a,existingHandlers:s[a]||[],handlers:(0,$i.getHandlers)(t)(a)}),delete s[a]));for(let a in s){if(!Object.prototype.hasOwnProperty.call(s,a))continue;let c=(0,Cc.graphqlClientClass)({config:e}),u=new c({session:n});i[a]=yield ki({config:e,client:u,topic:a,handlers:s[a],operation:G.WebhookOperation.Delete})}return i})}}Le.register=qE;function HE(e,t){return Sr.__awaiter(this,void 0,void 0,function*(){let r=(0,Cc.graphqlClientClass)({config:e}),n=new r({session:t}),o={},i,s=null;do{let a=kE(e,s),c=yield n.query({data:a});c.body.data.webhookSubscriptions.edges.forEach(u=>{let l=ME(u);o[u.node.topic]||(o[u.node.topic]=[]),o[u.node.topic].push(l)}),s=c.body.data.webhookSubscriptions.pageInfo.endCursor,i=c.body.data.webhookSubscriptions.pageInfo.hasNextPage}while(i);return o})}function kE(e,t){return $E(e,(0,dh.queryTemplate)(Le.TEMPLATE_GET_HANDLERS,{END_CURSOR:JSON.stringify(t)}))}function $E(e,t){let r=t;return(0,uh.versionCompatible)(e)(Pc.ApiVersion.July22)&&(r=r.replace("privateMetafieldNamespaces","")),r}function ME(e){var t,r,n;let o=e.node.endpoint,i;switch(o.__typename){case"WebhookHttpEndpoint":i={deliveryMethod:G.DeliveryMethod.Http,privateMetafieldNamespaces:e.node.privateMetafieldNamespaces,callbackUrl:o.callbackUrl,callback:()=>Sr.__awaiter(this,void 0,void 0,function*(){})},(t=i.privateMetafieldNamespaces)===null||t===void 0||t.sort();break;case"WebhookEventBridgeEndpoint":i={deliveryMethod:G.DeliveryMethod.EventBridge,arn:o.arn};break;case"WebhookPubSubEndpoint":i={deliveryMethod:G.DeliveryMethod.PubSub,pubSubProject:o.pubSubProject,pubSubTopic:o.pubSubTopic};break}return i.id=e.node.id,i.includeFields=e.node.includeFields,i.metafieldNamespaces=e.node.metafieldNamespaces,(r=i.includeFields)===null||r===void 0||r.sort(),(n=i.metafieldNamespaces)===null||n===void 0||n.sort(),i}function NE({config:e,session:t,topic:r,existingHandlers:n,handlers:o}){return Sr.__awaiter(this,void 0,void 0,function*(){let i=[],{toCreate:s,toUpdate:a,toDelete:c}=DE(e,n,o),u=(0,Cc.graphqlClientClass)({config:e}),l=new u({session:t}),d=G.WebhookOperation.Create;return i=i.concat(yield ki({config:e,client:l,topic:r,operation:d,handlers:s})),d=G.WebhookOperation.Update,i=i.concat(yield ki({config:e,client:l,topic:r,operation:d,handlers:a})),d=G.WebhookOperation.Delete,i=i.concat(yield ki({config:e,client:l,topic:r,operation:d,handlers:c})),i})}function DE(e,t,r){let n=r.reduce((c,u)=>(c[(0,$i.handlerIdentifier)(e,u)]=u,c),{}),o=t.reduce((c,u)=>(c[(0,$i.handlerIdentifier)(e,u)]=u,c),{}),i=Object.assign({},n),s={},a={};for(let c in o){if(!Object.prototype.hasOwnProperty.call(o,c))continue;let u=o[c],l=n[c];c in n?(delete i[c],UE(u,l)||(s[c]=l,s[c].id=u.id)):a[c]=u}return{toCreate:Object.values(i),toUpdate:Object.values(s),toDelete:Object.values(a)}}function UE(e,t){let r=xc(e.includeFields||[],t.includeFields||[]),n=xc(e.metafieldNamespaces||[],t.metafieldNamespaces||[]),o=e.deliveryMethod!==G.DeliveryMethod.Http||t.deliveryMethod!==G.DeliveryMethod.Http||xc(e.privateMetafieldNamespaces||[],t.privateMetafieldNamespaces||[]);return r&&n&&o}function xc(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function ki({config:e,client:t,topic:r,handlers:n,operation:o}){return Sr.__awaiter(this,void 0,void 0,function*(){let i=[];for(let s of n)i.push(yield LE({config:e,client:t,topic:r,handler:s,operation:o}));return i})}function LE({config:e,client:t,topic:r,handler:n,operation:o}){return Sr.__awaiter(this,void 0,void 0,function*(){let i;(0,lh.logger)(e).debug("Running webhook mutation",{topic:r,operation:o});try{let s=KE(e,r,n,o),a=yield t.query({data:s});i={deliveryMethod:n.deliveryMethod,success:WE(a.body,n,o),result:a.body,operation:o}}catch(s){if(s instanceof Mi.InvalidDeliveryMethodError)i={deliveryMethod:n.deliveryMethod,success:!1,result:{message:s.message},operation:o};else throw s}return i})}function KE(e,t,r,n){let o={},i;r.id?i=`id: "${r.id}"`:i=`topic: ${t}`;let s={MUTATION_NAME:ph(r,n),IDENTIFIER:i,MUTATION_PARAMS:""};if(n!==G.WebhookOperation.Delete){switch(r.deliveryMethod){case G.DeliveryMethod.Http:o.callbackUrl=`"${(0,$i.addHostToCallbackUrl)(e,r.callbackUrl)}"`;break;case G.DeliveryMethod.EventBridge:o.arn=`"${r.arn}"`;break;case G.DeliveryMethod.PubSub:o.pubSubProject=`"${r.pubSubProject}"`,o.pubSubTopic=`"${r.pubSubTopic}"`;break;default:throw new Mi.InvalidDeliveryMethodError(`Unrecognized delivery method '${r.deliveryMethod}'`)}r.includeFields&&(o.includeFields=JSON.stringify(r.includeFields)),r.metafieldNamespaces&&(o.metafieldNamespaces=JSON.stringify(r.metafieldNamespaces)),r.deliveryMethod===G.DeliveryMethod.Http&&r.privateMetafieldNamespaces&&(0,uh.versionPriorTo)(e)(Pc.ApiVersion.July22)&&(o.privateMetafieldNamespaces=JSON.stringify(r.privateMetafieldNamespaces));let a=Object.entries(o).map(([c,u])=>`${c}: ${u}`).join(", ");s.MUTATION_PARAMS=`webhookSubscription: {${a}}`}return(0,dh.queryTemplate)(Le.TEMPLATE_MUTATION,s)}function ph(e,t){switch(t){case G.WebhookOperation.Create:return`${ch(e)}Create`;case G.WebhookOperation.Update:return`${ch(e)}Update`;case G.WebhookOperation.Delete:return"webhookSubscriptionDelete";default:throw new Mi.ShopifyError(`Unrecognized operation '${t}'`)}}function ch(e){switch(e.deliveryMethod){case G.DeliveryMethod.Http:return"webhookSubscription";case G.DeliveryMethod.EventBridge:return"eventBridgeWebhookSubscription";case G.DeliveryMethod.PubSub:return"pubSubWebhookSubscription";default:throw new Mi.ShopifyError(`Unrecognized delivery method '${e.deliveryMethod}'`)}}function WE(e,t,r){let n=ph(t,r);return Boolean(e.data&&e.data[n]&&e.data[n].userErrors.length===0)}Le.TEMPLATE_GET_HANDLERS=`query shopifyApiReadWebhookSubscriptions {
  webhookSubscriptions(
    first: 250,
    after: {{END_CURSOR}},
  ) {
    edges {
      node {
        id
        topic
        includeFields
        metafieldNamespaces
        privateMetafieldNamespaces
        endpoint {
          __typename
          ... on WebhookHttpEndpoint {
            callbackUrl
          }
          ... on WebhookEventBridgeEndpoint {
            arn
          }
          ... on WebhookPubSubEndpoint {
            pubSubProject
            pubSubTopic
          }
        }
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}`;Le.TEMPLATE_MUTATION=`
  mutation shopifyApiCreateWebhookSubscription {
    {{MUTATION_NAME}}(
      {{IDENTIFIER}},
      {{MUTATION_PARAMS}}
    ) {
      userErrors {
        field
        message
      }
    }
  }
`});var Tc=p(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:!0});Di.validateFactory=void 0;var Ni=(k(),R(H)),hh=je(),FE=Ht(),JE=Tt(),An=be(),jE=nn(),BE=me(),Oc=Er(),VE=qi(),GE={apiVersion:An.ShopifyHeader.ApiVersion,domain:An.ShopifyHeader.Domain,hmac:An.ShopifyHeader.Hmac,topic:An.ShopifyHeader.Topic,webhookId:An.ShopifyHeader.WebhookId};function zE(e){return function(r){var{rawBody:n}=r,o=Ni.__rest(r,["rawBody"]);return Ni.__awaiter(this,void 0,void 0,function*(){let i=yield(0,hh.abstractConvertRequest)(o),s=(0,BE.logger)(e),a=XE(n,i.headers);if(!a.valid)return yield s.debug("Received malformed webhook request",a),a;let{hmac:c,valid:u}=a,l=Ni.__rest(a,["hmac","valid"]);return yield s.debug("Webhook request is well formed",l),(yield YE(e.apiSecretKey,n,c))?(yield s.debug("Webhook request is valid",l),a):(yield s.debug("Webhook validation failed",l),e.isCustomStoreApp&&s.deprecated("8.0.0","apiSecretKey should be set to the custom store app's API secret key, so that webhook validation succeeds. adminApiAccessToken should be set to the custom store app's Admin API access token"),{valid:!1,reason:Oc.WebhookValidationErrorReason.InvalidHmac})})}}Di.validateFactory=zE;function XE(e,t){if(!e.length)return{valid:!1,reason:Oc.WebhookValidationErrorReason.MissingBody};let r=[],n=Object.entries(GE).reduce((o,[i,s])=>{let a=(0,hh.getHeader)(t,s);return a?o[i]=a:r.push(s),o},{});return r.length?{valid:!1,reason:Oc.WebhookValidationErrorReason.MissingHeaders,missingHeaders:r}:Object.assign(Object.assign({valid:!0},n),{topic:(0,VE.topicForStorage)(n.topic)})}function YE(e,t,r){return Ni.__awaiter(this,void 0,void 0,function*(){let n=yield(0,FE.createSHA256HMAC)(e,t,JE.HashFormat.Base64);return(0,jE.safeCompare)(n,r)})}});var gh=p(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.process=void 0;var Ar=(k(),R(H)),pe=ua(),Ic=je(),yh=Ar.__importStar(W()),qc=me(),Ui=Er(),QE=Tc(),mh={[pe.StatusCode.Ok]:"OK",[pe.StatusCode.BadRequest]:"Bad Request",[pe.StatusCode.Unauthorized]:"Unauthorized",[pe.StatusCode.NotFound]:"Not Found",[pe.StatusCode.InternalServerError]:"Internal Server Error"};function ZE(e,t){return function(n){var{rawBody:o}=n,i=Ar.__rest(n,["rawBody"]);return Ar.__awaiter(this,void 0,void 0,function*(){let s={statusCode:pe.StatusCode.Ok,statusText:mh[pe.StatusCode.Ok],headers:{}};yield(0,qc.logger)(e).info("Receiving webhook request");let a=yield(0,QE.validateFactory)(e)(Object.assign({rawBody:o},i)),c="Unknown error while handling webhook";if(a.valid){let l=yield eS(e,t,a,o);s.statusCode=l.statusCode,(0,Ic.isOK)(s)||(c=l.errorMessage||c)}else{let l=yield tS(e,a);s.statusCode=l.statusCode,s.statusText=mh[s.statusCode],c=l.errorMessage}let u=yield(0,Ic.abstractConvertResponse)(s,i);if(!(0,Ic.isOK)(s))throw new yh.InvalidWebhookError({message:c,response:u});return Promise.resolve(u)})}}Li.process=ZE;function eS(e,t,r,n){return Ar.__awaiter(this,void 0,void 0,function*(){let o=(0,qc.logger)(e),{hmac:i,valid:s}=r,a=Ar.__rest(r,["hmac","valid"]);yield o.debug("Webhook request is valid, looking for HTTP handlers to call",a);let c=t[r.topic]||[],u={statusCode:pe.StatusCode.Ok},l=!1;for(let d of c)if(d.deliveryMethod===Ui.DeliveryMethod.Http){if(!d.callback)throw u.statusCode=pe.StatusCode.InternalServerError,u.errorMessage="Cannot call webhooks.process with a webhook handler that doesn't have a callback",new yh.MissingWebhookCallbackError({message:u.errorMessage,response:u});l=!0,yield o.debug("Found HTTP handler, triggering it",a);try{yield d.callback(r.topic,r.domain,n,r.webhookId,r.apiVersion)}catch(h){u.statusCode=pe.StatusCode.InternalServerError,u.errorMessage=h.message}}return l||(yield o.debug("No HTTP handlers found",a),u.statusCode=pe.StatusCode.NotFound,u.errorMessage=`No HTTP webhooks registered for topic ${r.topic}`),u})}function tS(e,t){return Ar.__awaiter(this,void 0,void 0,function*(){let r={statusCode:pe.StatusCode.InternalServerError,errorMessage:"Unknown error while handling webhook"};switch(t.reason){case Ui.WebhookValidationErrorReason.MissingHeaders:r.statusCode=pe.StatusCode.BadRequest,r.errorMessage=`Missing one or more of the required HTTP headers to process webhooks: [${t.missingHeaders.join(", ")}]`;break;case Ui.WebhookValidationErrorReason.MissingBody:r.statusCode=pe.StatusCode.BadRequest,r.errorMessage="No body was received when processing webhook";break;case Ui.WebhookValidationErrorReason.InvalidHmac:r.statusCode=pe.StatusCode.Unauthorized,r.errorMessage="Could not validate request HMAC";break}return yield(0,qc.logger)(e).debug(`Webhook request is invalid, returning ${r.statusCode}: ${r.errorMessage}`),r})}});var vh=p(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.shopifyWebhooks=void 0;var Ki=qi(),rS=fh(),nS=gh(),oS=Tc();function iS(e){let t=(0,Ki.registry)();return{addHandlers:(0,Ki.addHandlers)(e,t),getTopicsAdded:(0,Ki.getTopicsAdded)(t),getHandlers:(0,Ki.getHandlers)(t),register:(0,rS.register)(e,t),process:(0,nS.process)(e,t),validate:(0,oS.validateFactory)(e)}}Wi.shopifyWebhooks=iS});var Eh=p(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.check=void 0;var wh=(k(),R(H)),sS=Ge(),aS=W();function cS(e){return function({session:r,plans:n,isTest:o=!0,returnObject:i=!1}){return wh.__awaiter(this,void 0,void 0,function*(){if(!e.billing)throw new aS.BillingError({message:"Attempted to look for purchases without billing configs",errorData:[]});let s=(0,sS.graphqlClientClass)({config:e}),a=new s({session:r}),c=Array.isArray(n)?n:[n];return uS({plans:c,client:a,isTest:o,returnObject:i})})}}Fi.check=cS;function uS({plans:e,client:t,isTest:r,returnObject:n}){return wh.__awaiter(this,void 0,void 0,function*(){let o=n?{hasActivePayment:!1,oneTimePurchases:[],appSubscriptions:[]}:!1,i,s=null;do{if(i=(yield t.query({data:{query:pS,variables:{endCursor:s}}})).body.data.currentAppInstallation,n)i.activeSubscriptions.map(c=>{bh({plans:e,isTest:r,subscription:c})&&(o.hasActivePayment=!0,o.appSubscriptions.push(c))}),i.oneTimePurchases.edges.map(c=>{_h({plans:e,isTest:r,purchase:c.node})&&(o.hasActivePayment=!0,o.oneTimePurchases.push(c.node))});else{let c={plans:e,isTest:r,installation:i};if(lS(c)||dS(c))return!0}s=i.oneTimePurchases.pageInfo.endCursor}while(i?.oneTimePurchases.pageInfo.hasNextPage);return o})}function bh({plans:e,isTest:t,subscription:r}){return e.includes(r.name)&&(t||!r.test)}function _h({plans:e,isTest:t,purchase:r}){return e.includes(r.name)&&(t||!r.test)&&r.status==="ACTIVE"}function lS({plans:e,isTest:t,installation:r}){return r.activeSubscriptions.some(n=>bh({plans:e,isTest:t,subscription:n}))}function dS({plans:e,isTest:t,installation:r}){return r.oneTimePurchases.edges.some(n=>_h({plans:e,isTest:t,purchase:n.node}))}var pS=`
  query appSubscription($endCursor: String) {
    currentAppInstallation {
      activeSubscriptions {
        id
        name
        test
      }

      oneTimePurchases(first: 250, sortKey: CREATED_AT, after: $endCursor) {
        edges {
          node {
            id
            name
            test
            status
          }
        }
        pageInfo {
          hasNextPage
          endCursor
        }
      }
    }
  }
`});var Rh=p(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.request=void 0;var Ji=(k(),R(H)),Sh=be(),Rn=W(),fS=Ec(),hS=Ge(),mS=Ht(),yS=Tt();function gS(e){return function({session:t,plan:r,isTest:n=!0,returnUrl:o,returnObject:i=!1}){var s;return Ji.__awaiter(this,void 0,void 0,function*(){if(!e.billing||!e.billing[r])throw new Rn.BillingError({message:`Could not find plan ${r} in billing settings`,errorData:[]});let a=e.billing[r],c=t.shop.replace(".myshopify.com",""),u=(0,fS.buildEmbeddedAppUrl)(e)((0,mS.hashString)(`admin.shopify.com/store/${c}`,yS.HashFormat.Base64)),l=`${e.hostScheme}://${e.hostName}?shop=${t.shop}`,d=o||(e.isEmbeddedApp?u:l),h=(0,hS.graphqlClientClass)({config:e}),f=new h({session:t}),y;switch(a.interval){case Sh.BillingInterval.OneTime:{y=(yield bS({billingConfig:a,plan:r,client:f,returnUrl:d,isTest:n})).data.appPurchaseOneTimeCreate;break}case Sh.BillingInterval.Usage:{y=(yield wS({billingConfig:a,plan:r,client:f,returnUrl:d,isTest:n})).data.appSubscriptionCreate;break}default:y=(yield vS({billingConfig:a,plan:r,client:f,returnUrl:d,isTest:n})).data.appSubscriptionCreate}if(!((s=y.userErrors)===null||s===void 0)&&s.length)throw new Rn.BillingError({message:"Error while billing the store",errorData:y.userErrors});return i?y:y.confirmationUrl})}}ji.request=gS;function vS({billingConfig:e,plan:t,client:r,returnUrl:n,isTest:o}){var i,s,a,c,u,l;return Ji.__awaiter(this,void 0,void 0,function*(){let d=yield r.query({data:{query:Ah,variables:{name:t,trialDays:e.trialDays,replacementBehavior:e.replacementBehavior,returnUrl:n,test:o,lineItems:[{plan:{appRecurringPricingDetails:{interval:e.interval,price:{amount:e.amount,currencyCode:e.currencyCode},discount:{durationLimitInIntervals:(i=e.discount)===null||i===void 0?void 0:i.durationLimitInIntervals,value:{amount:(a=(s=e.discount)===null||s===void 0?void 0:s.value)===null||a===void 0?void 0:a.amount,percentage:(u=(c=e.discount)===null||c===void 0?void 0:c.value)===null||u===void 0?void 0:u.percentage}}}}}]}}});if(!((l=d.body.errors)===null||l===void 0)&&l.length)throw new Rn.BillingError({message:"Error while billing the store",errorData:d.body.errors});return d.body})}function wS({billingConfig:e,plan:t,client:r,returnUrl:n,isTest:o}){var i;return Ji.__awaiter(this,void 0,void 0,function*(){let s=yield r.query({data:{query:Ah,variables:{name:t,returnUrl:n,test:o,trialDays:e.trialDays,replacementBehavior:e.replacementBehavior,lineItems:[{plan:{appUsagePricingDetails:{terms:e.usageTerms,cappedAmount:{amount:e.amount,currencyCode:e.currencyCode}}}}]}}});if(!((i=s.body.errors)===null||i===void 0)&&i.length)throw new Rn.BillingError({message:`Error while billing the store:: ${s.body.errors}`,errorData:s.body.errors});return s.body})}function bS({billingConfig:e,plan:t,client:r,returnUrl:n,isTest:o}){var i;return Ji.__awaiter(this,void 0,void 0,function*(){let s=yield r.query({data:{query:_S,variables:{name:t,returnUrl:n,test:o,price:{amount:e.amount,currencyCode:e.currencyCode}}}});if(!((i=s.body.errors)===null||i===void 0)&&i.length)throw new Rn.BillingError({message:"Error while billing the store",errorData:s.body.errors});return s.body})}var Ah=`
  mutation test(
    $name: String!
    $lineItems: [AppSubscriptionLineItemInput!]!
    $returnUrl: URL!
    $test: Boolean
    $trialDays: Int
    $replacementBehavior: AppSubscriptionReplacementBehavior
  ) {
    appSubscriptionCreate(
      name: $name
      lineItems: $lineItems
      returnUrl: $returnUrl
      test: $test
      trialDays: $trialDays
      replacementBehavior: $replacementBehavior
    ) {
      appSubscription {
        id
        name
        test
      }
      confirmationUrl
      userErrors {
        field
        message
      }
    }
  }
`,_S=`
  mutation test(
    $name: String!
    $price: MoneyInput!
    $returnUrl: URL!
    $test: Boolean
  ) {
    appPurchaseOneTimeCreate(
      name: $name
      price: $price
      returnUrl: $returnUrl
      test: $test
    ) {
      appPurchaseOneTime {
        id
        name
        test
      }
      confirmationUrl
      userErrors {
        field
        message
      }
    }
  }
`});var xh=p(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.cancel=void 0;var ES=(k(),R(H)),SS=Ge(),Hc=W(),AS=`
  mutation appSubscriptionCancel($id: ID!, $prorate: Boolean) {
    appSubscriptionCancel(id: $id, prorate: $prorate) {
      appSubscription {
        id
        name
        test
      }
      userErrors {
        field
        message
      }
    }
  }
`;function RS(e){return function(t){var r;return ES.__awaiter(this,void 0,void 0,function*(){let{session:n,subscriptionId:o,prorate:i=!0}=t,s=(0,SS.graphqlClientClass)({config:e}),a=new s({session:n});try{let c=yield a.query({data:{query:AS,variables:{id:o,prorate:i}}});if(c.body.data.appSubscriptionCancel.userErrors.length)throw new Hc.BillingError({message:"Error while canceling a subscription",errorData:c.body.data.appSubscriptionCancel.userErrors});return c.body.data.appSubscriptionCancel.appSubscription}catch(c){throw c instanceof Hc.GraphqlQueryError?new Hc.BillingError({message:c.message,errorData:(r=c.response)===null||r===void 0?void 0:r.errors}):c}})}}Bi.cancel=RS});var Ch=p(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.subscriptions=void 0;var xS=(k(),R(H)),CS=W(),PS=Ge(),OS=`
  query appSubscription {
    currentAppInstallation {
      activeSubscriptions {
        id
        name
        test
      }
  }
}
`;function TS(e){return function({session:t}){return xS.__awaiter(this,void 0,void 0,function*(){if(!e.billing)throw new CS.BillingError({message:"Attempted to look for purchases without billing configs",errorData:[]});let r=(0,PS.graphqlClientClass)({config:e});return(yield new r({session:t}).query({data:{query:OS}})).body.data.currentAppInstallation})}}Vi.subscriptions=TS});var Ph=p(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});Gi.shopifyBilling=void 0;var IS=Eh(),qS=Rh(),HS=xh(),kS=Ch();function $S(e){return{check:(0,IS.check)(e),request:(0,qS.request)(e),cancel:(0,HS.cancel)(e),subscriptions:(0,kS.subscriptions)(e)}}Gi.shopifyBilling=$S});var Oh=p(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.Session=void 0;var MS=Yr();Object.defineProperty(zi,"Session",{enumerable:!0,get:function(){return MS.Session}})});var Ih=p(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0})});var Hh=p(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0})});var kh=p(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});var NS=(k(),R(H));NS.__exportStar(Jo(),kc)});var Mh=p($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0})});var Dh=p(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0})});var Lh=p(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0})});var Kh=p(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});var $c=(k(),R(H));$c.__exportStar(zr(),xn);$c.__exportStar(Dh(),xn);$c.__exportStar(Lh(),xn)});var Fh=p(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0})});var et=p(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.shopifyApi=le.Shopify=void 0;var qe=(k(),R(H)),DS=(co(),R(ao)),US=id(),Mc=no(),LS=cd(),KS=_d(),WS=Qf(),FS=Zf(),JS=nh(),jS=vh(),BS=Ph(),VS=me(),GS=Xt();qe.__exportStar(W(),le);qe.__exportStar(Oh(),le);qe.__exportStar(Ih(),le);qe.__exportStar(be(),le);qe.__exportStar(Hh(),le);qe.__exportStar(kh(),le);qe.__exportStar(Mh(),le);qe.__exportStar(Kh(),le);qe.__exportStar(Fh(),le);qe.__exportStar(Er(),le);le.Shopify={};function zS(e){let{restResources:t}=e,r=qe.__rest(e,["restResources"]),n=(0,LS.validateConfig)(r),o={config:n,clients:(0,KS.clientClasses)(n),auth:(0,WS.shopifyAuth)(n),session:(0,FS.shopifySession)(n),utils:(0,JS.shopifyUtils)(n),webhooks:(0,jS.shopifyWebhooks)(n),billing:(0,BS.shopifyBilling)(n),logger:(0,VS.logger)(n),rest:{}};t&&(o.rest=(0,US.loadRestResources)({resources:t,config:n,RestClient:o.clients.Rest})),o.logger.info(`version ${GS.SHOPIFY_API_LIBRARY_VERSION}, environment ${(0,Mc.abstractRuntimeString)()}`).catch(c=>console.log(c));let i=(0,Mc.abstractRuntimeString)().match(/(Node) (v\d+\.\d+\.\d+)/),s=i&&i[1]==="Node",a=i?i[2]:"";return s&&(0,DS.compare)(a,"16.0.0","<")&&o.logger.deprecated("8.0.0",`Support for ${(0,Mc.abstractRuntimeString)()} will be removed - please upgrade to Node v16.0.0 or higher.`),o}le.shopifyApi=zS});var Nc=p(Xi=>{"use strict";Object.defineProperty(Xi,"__esModule",{value:!0});var XS=function(e){return e.AppStore="app_store",e.SingleMerchant="single_merchant",e.ShopifyAdmin="shopify_admin",e}({}),YS=function(e){return e.MissingShop="MISSING_SHOP",e.InvalidShop="INVALID_SHOP",e}({});Xi.AppDistribution=XS;Xi.LoginErrorType=YS});var Uc=p(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});var QS="1.0.3";Dc.SHOPIFY_REMIX_LIBRARY_VERSION=QS});var Jh=p(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});function ZS({api:e,logger:t}){return async function({session:n}){return e.webhooks.register({session:n}).then(o=>(Object.entries(o).forEach(([i,s])=>{s.forEach(({success:a,...c})=>{a?t.debug("Registered webhook",{topic:i,shop:n.shop,operation:c.operation}):t.error("Failed to register webhook",{topic:i,shop:n.shop,result:JSON.stringify(c.result)})})}),o))}}Lc.registerWebhooksFactory=ZS});var jh=p(Kc=>{"use strict";Kc.parse=rA;Kc.serialize=nA;var eA=decodeURIComponent,tA=encodeURIComponent,Yi=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function rA(e,t){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var r={},n=t||{},o=e.split(";"),i=n.decode||eA,s=0;s<o.length;s++){var a=o[s],c=a.indexOf("=");if(!(c<0)){var u=a.substring(0,c).trim();if(r[u]==null){var l=a.substring(c+1,a.length).trim();l[0]==='"'&&(l=l.slice(1,-1)),r[u]=oA(l,i)}}}return r}function nA(e,t,r){var n=r||{},o=n.encode||tA;if(typeof o!="function")throw new TypeError("option encode is invalid");if(!Yi.test(e))throw new TypeError("argument name is invalid");var i=o(t);if(i&&!Yi.test(i))throw new TypeError("argument val is invalid");var s=e+"="+i;if(n.maxAge!=null){var a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");s+="; Max-Age="+Math.floor(a)}if(n.domain){if(!Yi.test(n.domain))throw new TypeError("option domain is invalid");s+="; Domain="+n.domain}if(n.path){if(!Yi.test(n.path))throw new TypeError("option path is invalid");s+="; Path="+n.path}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(s+="; HttpOnly"),n.secure&&(s+="; Secure"),n.sameSite){var c=typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite;switch(c){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return s}function oA(e,t){try{return t(e)}catch{return e}}});function Qi(e,t){!e&&!Bh[t]&&(Bh[t]=!0,console.warn(t))}var Bh,Wc=m(()=>{Bh={}});async function iA(e,t,r){let n=aA(t);return r.length>0&&(n=await e(n,r[0])),n}async function sA(e,t,r){if(r.length>0){for(let n of r){let o=await e(t,n);if(o!==!1)return Vh(o)}return null}return Vh(t)}function aA(e){return btoa(uA(encodeURIComponent(JSON.stringify(e))))}function Vh(e){try{return JSON.parse(decodeURIComponent(cA(atob(e))))}catch{return{}}}function cA(e){let t=e.toString(),r="",n=0,o,i;for(;n<t.length;)o=t.charAt(n++),/[\w*+\-./@]/.exec(o)?r+=o:(i=o.charCodeAt(0),i<256?r+="%"+Gh(i,2):r+="%u"+Gh(i,4).toUpperCase());return r}function Gh(e,t){let r=e.toString(16);for(;r.length<t;)r="0"+r;return r}function uA(e){let t=e.toString(),r="",n=0,o,i;for(;n<t.length;){if(o=t.charAt(n++),o==="%"){if(t.charAt(n)==="u"){if(i=t.slice(n+1,n+5),/^[\da-f]{4}$/i.exec(i)){r+=String.fromCharCode(parseInt(i,16)),n+=5;continue}}else if(i=t.slice(n,n+2),/^[\da-f]{2}$/i.exec(i)){r+=String.fromCharCode(parseInt(i,16)),n+=2;continue}}r+=o}return r}function lA(e,t){Qi(!t,`The "${e}" cookie has an "expires" property set. This will cause the expires value to not be updated when the session is committed. Instead, you should set the expires value when serializing the cookie. You can use \`commitSession(session, { expires })\` if using a session storage object, or \`cookie.serialize("value", { expires })\` if you're using the cookie directly.`)}var Zi,zh,Rr,es=m(()=>{Zi=it(jh());Wc();zh=({sign:e,unsign:t})=>(r,n={})=>{let{secrets:o=[],...i}={path:"/",sameSite:"lax",...n};return lA(r,i.expires),{get name(){return r},get isSigned(){return o.length>0},get expires(){return typeof i.maxAge<"u"?new Date(Date.now()+i.maxAge*1e3):i.expires},async parse(s,a){if(!s)return null;let c=(0,Zi.parse)(s,{...i,...a});return r in c?c[r]===""?"":await sA(t,c[r],o):null},async serialize(s,a){return(0,Zi.serialize)(r,s===""?"":await iA(e,s,o),{...i,...a})}}},Rr=e=>e!=null&&typeof e.name=="string"&&typeof e.isSigned=="boolean"&&typeof e.parse=="function"&&typeof e.serialize=="function"});function xr(e){let t=unescape(encodeURIComponent(e));return Uint8Array.from(t,(r,n)=>t.charCodeAt(n))}function Fc(e){let t=String.fromCharCode.apply(null,e);return decodeURIComponent(escape(t))}function Cr(...e){let t=new Uint8Array(e.reduce((n,o)=>n+o.length,0)),r=0;for(let n of e)t.set(n,r),r+=n.length;return t}function Xh(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var Jc=m(()=>{});function Yh(e){return e instanceof Uint8Array?t=>e[t]:e}function jc(e,t,r,n,o){let i=Yh(e),s=Yh(r);for(let a=0;a<o;++a)if(i(t+a)!==s(n+a))return!1;return!0}function dA(e){let t=new Array(256).fill(e.length);if(e.length>1)for(let r=0;r<e.length-1;r++)t[e[r]]=e.length-1-r;return t}var Ke,Ut,ts,Qh,Zh,em=m(()=>{Jc();Ke=Symbol("Match"),Ut=class{constructor(t){this._lookbehind=new Uint8Array,typeof t=="string"?this._needle=t=xr(t):this._needle=t,this._lastChar=t[t.length-1],this._occ=dA(t)}feed(t){let r=0,n,o=[];for(;r!==t.length;)[r,...n]=this._feed(t,r),o.push(...n);return o}end(){let t=this._lookbehind;return this._lookbehind=new Uint8Array,t}_feed(t,r){let n=[],o=-this._lookbehind.length;if(o<0){for(;o<0&&o<=t.length-this._needle.length;){let i=this._charAt(t,o+this._needle.length-1);if(i===this._lastChar&&this._memcmp(t,o,this._needle.length-1))return o>-this._lookbehind.length&&n.push(this._lookbehind.slice(0,this._lookbehind.length+o)),n.push(Ke),this._lookbehind=new Uint8Array,[o+this._needle.length,...n];o+=this._occ[i]}if(o<0)for(;o<0&&!this._memcmp(t,o,t.length-o);)o++;if(o>=0)n.push(this._lookbehind),this._lookbehind=new Uint8Array;else{let i=this._lookbehind.length+o;return i>0&&(n.push(this._lookbehind.slice(0,i)),this._lookbehind=this._lookbehind.slice(i)),this._lookbehind=Uint8Array.from(new Array(this._lookbehind.length+t.length),(s,a)=>this._charAt(t,a-this._lookbehind.length)),[t.length,...n]}}for(o+=r;o<=t.length-this._needle.length;){let i=t[o+this._needle.length-1];if(i===this._lastChar&&t[o]===this._needle[0]&&jc(this._needle,0,t,o,this._needle.length-1))return o>r&&n.push(t.slice(r,o)),n.push(Ke),[o+this._needle.length,...n];o+=this._occ[i]}if(o<t.length){for(;o<t.length&&(t[o]!==this._needle[0]||!jc(t,o,this._needle,0,t.length-o));)++o;o<t.length&&(this._lookbehind=t.slice(o))}return o>0&&n.push(t.slice(r,o<t.length?o:t.length)),[t.length,...n]}_charAt(t,r){return r<0?this._lookbehind[this._lookbehind.length+r]:t[r]}_memcmp(t,r,n){return jc(this._charAt.bind(this,t),r,this._needle,0,n)}},ts=class{constructor(t,r){this._readableStream=r,this._search=new Ut(t)}async*[Symbol.asyncIterator](){let t=this._readableStream.getReader();try{for(;;){let n=await t.read();if(n.done)break;yield*this._search.feed(n.value)}let r=this._search.end();r.length&&(yield r)}finally{t.releaseLock()}}},Qh=Symbol("End of Queue"),Zh=class{constructor(t){this._chunksQueue=[],this._closed=!1,this._search=new Ut(t)}push(...t){if(this._closed)throw new Error("cannot call push after close");this._chunksQueue.push(...t),this._notify&&this._notify()}close(){if(this._closed)throw new Error("close was already called");this._closed=!0,this._chunksQueue.push(Qh),this._notify&&this._notify()}async*[Symbol.asyncIterator](){for(;;){let r;for(;!(r=this._chunksQueue.shift());)await new Promise(n=>this._notify=n),this._notify=void 0;if(r===Qh)break;yield*this._search.feed(r)}let t=this._search.end();t.length&&(yield t)}}});function fA(e){let t=e.split(";").map(n=>n.trim());if(t.shift()!=="form-data")throw new Error('malformed content-disposition header: missing "form-data" in `'+JSON.stringify(t)+"`");let r={};for(let n of t){let o=n.split("=",2);if(o.length!==2)throw new Error("malformed content-disposition header: key-value pair not found - "+n+" in `"+e+"`");let[i,s]=o;if(s[0]==='"'&&s[s.length-1]==='"')r[i]=s.slice(1,-1).replace(/\\"/g,'"');else if(s[0]!=='"'&&s[s.length-1]!=='"')r[i]=s;else if(s[0]==='"'&&s[s.length-1]!=='"'||s[0]!=='"'&&s[s.length-1]==='"')throw new Error("malformed content-disposition header: mismatched quotations in `"+e+"`")}if(!r.name)throw new Error("malformed content-disposition header: missing field name in `"+e+"`");return r}function hA(e){let t=[],r=!1,n;for(;typeof(n=e.shift())<"u";){let o=n.indexOf(":");if(o===-1)throw new Error("malformed multipart-form header: missing colon");let i=n.slice(0,o).trim().toLowerCase(),s=n.slice(o+1).trim();switch(i){case"content-disposition":r=!0,t.push(...Object.entries(fA(s)));break;case"content-type":t.push(["contentType",s])}}if(!r)throw new Error("malformed multipart-form header: missing content-disposition");return Object.fromEntries(t)}async function mA(e,t){let r=!0,n=!1,o=[[]],i=new Ut(Cn);for(;;){let s=await e.next();if(s.done)throw new Error("malformed multipart-form data: unexpected end of stream");if(r&&s.value!==Ke&&Xh(s.value.slice(0,2),tm))return[void 0,new Uint8Array];let a;if(s.value!==Ke)a=s.value;else if(!n)a=t;else throw new Error("malformed multipart-form data: unexpected boundary");if(!a.length)continue;r&&(r=!1);let c=i.feed(a);for(let[u,l]of c.entries()){let d=l===Ke;if(!(!d&&!l.length)){if(n&&d)return c.push(i.end()),[o.filter(h=>h.length).map(pA).map(Fc),Cr(...c.slice(u+1).map(h=>h===Ke?Cn:h))];(n=d)?o.push([]):o[o.length-1].push(l)}}}}async function*rm(e,t){let r=Cr(tm,xr(t)),n=new ts(r,e)[Symbol.asyncIterator]();for(;;){let i=await n.next();if(i.done)return;if(i.value===Ke)break}let o=new Ut(Cn);for(;;){let u=function(f){let y=[];for(let b of o.feed(f))c&&y.push(Cn),(c=b===Ke)||y.push(b);return Cr(...y)},[i,s]=await mA(n,r);if(!i)return;async function a(){let f=await n.next();if(f.done)throw new Error("malformed multipart-form data: unexpected end of stream");return f}let c=!1,l=!1;async function d(){let f=await a(),y;if(f.value!==Ke)y=f.value;else if(!c)y=Cn;else return l=!0,{value:o.end()};return{value:u(y)}}let h=[{value:u(s)}];for(yield{...hA(i),data:{[Symbol.asyncIterator](){return this},async next(){for(;;){let f=h.shift();if(!f)break;if(f.value.length>0)return f}for(;;){if(l)return{done:l,value:void 0};let f=await d();if(f.value.length>0)return f}}}};!l;)h.push(await d())}}var pA,tm,Cn,nm=m(()=>{em();Jc();pA=Function.prototype.apply.bind(Cr,void 0),tm=xr("--"),Cn=xr(`\r
`)});function om(...e){return async t=>{for(let r of e){let n=await r(t);if(typeof n<"u"&&n!==null)return n}}}async function im(e,t){let r=e.headers.get("Content-Type")||"",[n,o]=r.split(/\s*;\s*boundary=/);if(!e.body||!o||n!=="multipart/form-data")throw new TypeError("Could not parse content as FormData.");let i=new FormData,s=rm(e.body,o);for await(let a of s){if(a.done)break;typeof a.filename=="string"&&(a.filename=a.filename.split(/[/\\]/).pop());let c=await t(a);typeof c<"u"&&c!==null&&i.append(a.name,c)}return i}var sm=m(()=>{nm();});function am(e){return e===tt.Development||e===tt.Production||e===tt.Test}var tt,Bc=m(()=>{tt=function(e){return e.Development="development",e.Production="production",e.Test="test",e}({})});function Vc(e,t){if(e instanceof Error&&t!==tt.Development){let r=new Error("Unexpected Server Error");return r.stack=void 0,r}return e}function Gc(e,t){return Object.entries(e).reduce((r,[n,o])=>Object.assign(r,{[n]:Vc(o,t)}),{})}function Pr(e,t){let r=Vc(e,t);return{message:r.message,stack:r.stack}}function zc(e,t){if(!e)return null;let r=Object.entries(e),n={};for(let[o,i]of r)if(Ot(i))n[o]={...i,__type:"RouteErrorResponse"};else if(i instanceof Error){let s=Vc(i,t);n[o]={message:s.message,stack:s.stack,__type:"Error",...s.name!=="Error"?{__subType:s.name}:{}}}else n[o]=i;return n}var Xc=m(()=>{Wn();Bc();});function lm(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function xt(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Yc(e){return yA.has(e)}function dm(e){return Yc(e.status)}function gA(e){return e!=null&&typeof e.then=="function"&&e._tracked===!0}function pm(e,t,r){let n=new TextEncoder;return new ReadableStream({async start(i){let s={},a=[];for(let[u,l]of Object.entries(e.data))gA(l)?(s[u]=`${vA}${u}`,(typeof l._data<"u"||typeof l._error<"u")&&a.push(u)):s[u]=l;i.enqueue(n.encode(JSON.stringify(s)+`

`));for(let u of a)cm(i,n,u,e.data[u],r);let c=e.subscribe((u,l)=>{l&&cm(i,n,l,e.data[l],r)});await e.resolveData(t),c(),i.close()}})}function cm(e,t,r,n,o){"_error"in n?e.enqueue(t.encode("error:"+JSON.stringify({[r]:n._error instanceof Error?Pr(n._error,o):n._error})+`

`)):e.enqueue(t.encode("data:"+JSON.stringify({[r]:n._data??null})+`

`))}var Pn,um,rs,yA,vA,ns=m(()=>{Wn();Xc();Pn=(e,t={})=>Nr(e,t),um=(e,t={})=>nl(e,t),rs=(e,t=302)=>ol(e,t);yA=new Set([301,302,303,307,308]);vA="__deferred_promise:"});function fm(e){return Object.keys(e).reduce((t,r)=>(t[r]=e[r].module,t),{})}var hm=m(()=>{});var ym=p((m$,On)=>{"use strict";var Or={decodeValues:!0,map:!1,silent:!1};function Qc(e){return typeof e=="string"&&!!e.trim()}function Zc(e,t){var r=e.split(";").filter(Qc),n=r.shift(),o=wA(n),i=o.name,s=o.value;t=t?Object.assign({},Or,t):Or;try{s=t.decodeValues?decodeURIComponent(s):s}catch(c){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+s+"'. Set options.decodeValues to false to disable this feature.",c)}var a={name:i,value:s};return r.forEach(function(c){var u=c.split("="),l=u.shift().trimLeft().toLowerCase(),d=u.join("=");l==="expires"?a.expires=new Date(d):l==="max-age"?a.maxAge=parseInt(d,10):l==="secure"?a.secure=!0:l==="httponly"?a.httpOnly=!0:l==="samesite"?a.sameSite=d:a[l]=d}),a}function wA(e){var t="",r="",n=e.split("=");return n.length>1?(t=n.shift(),r=n.join("=")):r=e,{name:t,value:r}}function mm(e,t){if(t=t?Object.assign({},Or,t):Or,!e)return t.map?{}:[];if(e.headers)if(typeof e.headers.getSetCookie=="function")e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var r=e.headers[Object.keys(e.headers).find(function(o){return o.toLowerCase()==="set-cookie"})];!r&&e.headers.cookie&&!t.silent&&console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=r}if(Array.isArray(e)||(e=[e]),t=t?Object.assign({},Or,t):Or,t.map){var n={};return e.filter(Qc).reduce(function(o,i){var s=Zc(i,t);return o[s.name]=s,o},n)}else return e.filter(Qc).map(function(o){return Zc(o,t)})}function bA(e){if(Array.isArray(e))return e;if(typeof e!="string")return[];var t=[],r=0,n,o,i,s,a;function c(){for(;r<e.length&&/\s/.test(e.charAt(r));)r+=1;return r<e.length}function u(){return o=e.charAt(r),o!=="="&&o!==";"&&o!==","}for(;r<e.length;){for(n=r,a=!1;c();)if(o=e.charAt(r),o===","){for(i=r,r+=1,c(),s=r;r<e.length&&u();)r+=1;r<e.length&&e.charAt(r)==="="?(a=!0,r=s,t.push(e.substring(n,i)),n=r):r=i+1}else r+=1;(!a||r>=e.length)&&t.push(e.substring(n,e.length))}return t}On.exports=mm;On.exports.parse=mm;On.exports.parseString=Zc;On.exports.splitCookiesString=bA});function vm(e,t){let r=t.errors?t.matches.findIndex(i=>t.errors[i.route.id]):-1,n=r>=0?t.matches.slice(0,r+1):t.matches,o;if(r>=0){let{actionHeaders:i,actionData:s,loaderHeaders:a,loaderData:c}=t;t.matches.slice(r).some(u=>{let l=u.route.id;return i[l]&&(!s||s[l]===void 0)?o=i[l]:a[l]&&c[l]===void 0&&(o=a[l]),o!=null})}return n.reduce((i,s,a)=>{let{id:c}=s.route,u=e.routes[c].module,l=t.loaderHeaders[c]||new Headers,d=t.actionHeaders[c]||new Headers,h=o!=null&&a===n.length-1,f=h&&o!==l&&o!==d;if(u.headers==null&&e.future.v2_headers){let b=new Headers(i);return f&&Lt(o,b),Lt(d,b),Lt(l,b),b}let y=new Headers(u.headers?typeof u.headers=="function"?u.headers({loaderHeaders:l,parentHeaders:i,actionHeaders:d,errorHeaders:h?o:void 0}):u.headers:void 0);return f&&Lt(o,y),Lt(d,y),Lt(l,y),Lt(i,y),y},new Headers)}function Lt(e,t){let r=e.get("Set-Cookie");r&&(0,gm.splitCookiesString)(r).forEach(o=>{t.append("Set-Cookie",o)})}var gm,wm=m(()=>{gm=it(ym());});function bm(e,t){if(e===!1||e===null||typeof e>"u")throw console.error("The following error is a bug in Remix; please open an issue! https://github.com/remix-run/remix/issues/new"),new Error(t)}var _m=m(()=>{});function Em(e,t){let r=rl(e,t);return r?r.map(n=>({params:n.params,pathname:n.pathname,route:n.route})):null}var Sm=m(()=>{Wn();});async function Am({loadContext:e,action:t,params:r,request:n,routeId:o}){let i=await t({request:Cm(xm(n)),context:e,params:r});if(i===void 0)throw new Error(`You defined an action for route "${o}" but didn't return anything from your \`action\` function. Please return a value or \`null\`.`);return xt(i)?i:Pn(i)}async function Rm({loadContext:e,loader:t,params:r,request:n,routeId:o}){let i=await t({request:Cm(xm(n)),context:e,params:r});if(i===void 0)throw new Error(`You defined a loader for route "${o}" but didn't return anything from your \`loader\` function. Please return a value or \`null\`.`);return lm(i)?i.init&&Yc(i.init.status||200)?rs(new Headers(i.init.headers).get("Location"),i.init):i:xt(i)?i:Pn(i)}function xm(e){let t=new URL(e.url),r=t.searchParams.getAll("index");t.searchParams.delete("index");let n=[];for(let o of r)o&&n.push(o);for(let o of n)t.searchParams.append("index",o);return new Request(t.href,e)}function Cm(e){let t=new URL(e.url);return t.searchParams.delete("_data"),new Request(t.href,e)}var Pm=m(()=>{ns();});function Om(e){let t={};return Object.values(e).forEach(r=>{let n=r.parentId||"";t[n]||(t[n]=[]),t[n].push(r)}),t}function eu(e,t="",r=Om(e)){return(r[t]||[]).map(n=>({...n,children:eu(e,n.id,r)}))}function tu(e,t,r="",n=Om(e)){return(n[r]||[]).map(o=>{let s={hasErrorBoundary:t.v2_errorBoundary===!0?o.id==="root"||o.module.ErrorBoundary!=null:o.id==="root"||o.module.CatchBoundary!=null||o.module.ErrorBoundary!=null,id:o.id,path:o.path,loader:o.module.loader?a=>Rm({request:a.request,params:a.params,loadContext:a.context,loader:o.module.loader,routeId:o.id}):void 0,action:o.module.action?a=>Am({request:a.request,params:a.params,loadContext:a.context,action:o.module.action,routeId:o.id}):void 0,handle:o.module.handle};return o.index?{index:!0,...s}:{caseSensitive:o.caseSensitive,children:tu(e,t,o.id,n),...s}})}var Tm=m(()=>{Pm();});function Im(e){return e.replace(EA,t=>_A[t])}var _A,EA,qm=m(()=>{_A={"&":"\\u0026",">":"\\u003e","<":"\\u003c","\u2028":"\\u2028","\u2029":"\\u2029"},EA=/[&><\u2028\u2029]/g});function ru(e){return Im(JSON.stringify(e))}var Hm=m(()=>{qm();});async function SA(e,t,r,n,o,i){try{let s=await t.queryRoute(n,{routeId:r,requestContext:o});if(dm(s)){let a=new Headers(s.headers);return a.set("X-Remix-Redirect",a.get("Location")),a.set("X-Remix-Status",s.status),a.delete("Location"),s.headers.get("Set-Cookie")!==null&&a.set("X-Remix-Revalidate","yes"),new Response(null,{status:204,headers:a})}if(Ss in s){let a=s[Ss],c=pm(a,n.signal,e),u=a.init||{},l=new Headers(u.headers);return l.set("Content-Type","text/remix-deferred"),l.set("X-Remix-Response","yes"),u.headers=l,new Response(c,u)}return s.headers.set("X-Remix-Response","yes"),s}catch(s){if(xt(s))return s.headers.set("X-Remix-Catch","yes"),s;if(Ot(s))return s.error&&i(s.error),Nm(s,e);let a=s instanceof Error?s:new Error("Unexpected Server Error");return i(a),Nr(Pr(a,e),{status:500,headers:{"X-Remix-Error":"yes"}})}}function Mm(e,t,r){let n=e[t]||e.root,o=Ot(r)&&(!r.error||r.status===404);return o&&n.module.CatchBoundary||!o&&n.module.ErrorBoundary||!n.parentId?n.id:Mm(e,n.parentId,r)}function km(e,t){if(!t.errors)return;let r={};for(let n of Object.keys(t.errors)){let o=t.errors[n],i=Mm(e.routes,n,o);r[i]=o}t.errors=r}async function AA(e,t,r,n,o,i){let s;try{s=await r.query(n,{requestContext:o})}catch(l){return i(l),new Response(null,{status:500})}if(xt(s))return s;s.errors&&(Object.values(s.errors).forEach(l=>{(!Ot(l)||l.error)&&i(l)}),s.errors=Gc(s.errors,e)),t.future.v2_errorBoundary!==!0&&km(t,s);let a=vm(t,s),c={manifest:t.assets,routeModules:fm(t.routes),staticHandlerContext:s,serverHandoffString:ru({url:s.location.pathname,state:{loaderData:s.loaderData,actionData:s.actionData,errors:zc(s.errors,e)},future:t.future}),future:t.future,serializeError:l=>Pr(l,e)},u=t.entry.module.default;try{return await u(n,s.statusCode,a,c,o)}catch(l){i(l),s=sl(r.dataRoutes,s,l),s.errors&&(s.errors=Gc(s.errors,e)),t.future.v2_errorBoundary!==!0&&km(t,s),c={...c,staticHandlerContext:s,serverHandoffString:ru({url:s.location.pathname,state:{loaderData:s.loaderData,actionData:s.actionData,errors:zc(s.errors,e)},future:t.future})};try{return await u(n,s.statusCode,a,c,o)}catch(d){return i(d),Dm(d,e)}}}async function RA(e,t,r,n,o,i){try{let s=await t.queryRoute(n,{routeId:r,requestContext:o});return bm(xt(s),"Expected a Response to be returned from queryRoute"),s}catch(s){return xt(s)?(s.headers.set("X-Remix-Catch","yes"),s):Ot(s)?(s.error&&i(s.error),Nm(s,e)):(i(s),Dm(s,e))}}function Nm(e,t){return Nr(Pr(e.error||new Error("Unexpected Server Error"),t),{status:e.status,statusText:e.statusText,headers:{"X-Remix-Error":"yes"}})}function Dm(e,t){let r="Unexpected Server Error";return t!==tt.Production&&(r+=`

${String(e)}`),new Response(r,{status:500,headers:{"Content-Type":"text/plain"}})}var $m,Um=m(()=>{Wn();hm();Xc();wm();_m();Bc();Sm();Tm();ns();Hm();$m=(e,t)=>{let r=eu(e.routes),n=tu(e.routes,e.future),o=am(t)?t:tt.Production,i=il(n),s=e.entry.module.handleError||((a,{request:c})=>{o!==tt.Test&&!c.signal.aborted&&console.error(a)});return async function(c,u={}){let l=new URL(c.url),d=Em(r,l.pathname),h=b=>s(b,{context:u,params:d&&d.length>0?d[0].params:{},request:c}),f;if(l.searchParams.has("_data")){let b=l.searchParams.get("_data");if(f=await SA(o,i,b,c,u,h),e.entry.module.handleDataRequest){var y;f=await e.entry.module.handleDataRequest(f,{context:u,params:(d==null||(y=d.find(J=>J.route.id==b))===null||y===void 0?void 0:y.params)||{},request:c})}}else d&&d[d.length-1].route.module.default==null?f=await RA(o,i,d.slice(-1)[0].route.id,c,u,h):f=await AA(o,e,i,c,u,h);return c.method==="HEAD"?new Response(null,{headers:f.headers,status:f.status,statusText:f.statusText}):f}}});function nu(e){return`__flash_${e}__`}function ou(e){Qi(e.isSigned,`The "${e.name}" cookie is not signed, but session cookies should be signed to prevent tampering on the client before they are sent back to the server. See https://remix.run/utils/cookies#signing-cookies for more information.`)}var Tn,Lm,Km,iu=m(()=>{es();Wc();Tn=(e={},t="")=>{let r=new Map(Object.entries(e));return{get id(){return t},get data(){return Object.fromEntries(r)},has(n){return r.has(n)||r.has(nu(n))},get(n){if(r.has(n))return r.get(n);let o=nu(n);if(r.has(o)){let i=r.get(o);return r.delete(o),i}},set(n,o){r.set(n,o)},flash(n,o){r.set(nu(n),o)},unset(n){r.delete(n)}}},Lm=e=>e!=null&&typeof e.id=="string"&&typeof e.data<"u"&&typeof e.has=="function"&&typeof e.get=="function"&&typeof e.set=="function"&&typeof e.flash=="function"&&typeof e.unset=="function",Km=e=>({cookie:t,createData:r,readData:n,updateData:o,deleteData:i})=>{let s=Rr(t)?t:e(t?.name||"__session",t);return ou(s),{async getSession(a,c){let u=a&&await s.parse(a,c),l=u&&await n(u);return Tn(l||{},u||"")},async commitSession(a,c){let{id:u,data:l}=a;return u?await o(u,l,s.expires):u=await r(l,s.expires),s.serialize(u,c)},async destroySession(a,c){return await i(a.id),s.serialize("",{...c,expires:new Date(0)})}}}});var Wm,Fm=m(()=>{es();iu();Wm=e=>({cookie:t}={})=>{let r=Rr(t)?t:e(t?.name||"__session",t);return ou(r),{async getSession(n,o){return Tn(n&&await r.parse(n,o)||{})},async commitSession(n,o){let i=await r.serialize(n.data,o);if(i.length>4096)throw new Error("Cookie length will exceed browser maximum. Length: "+i.length);return i},async destroySession(n,o){return r.serialize("",{...o,expires:new Date(0)})}}}});var Jm,jm=m(()=>{Jm=e=>({cookie:t}={})=>{let r=0,n=new Map;return e({cookie:t,async createData(o,i){let s=(++r).toString();return n.set(s,{data:o,expires:i}),s},async readData(o){if(n.has(o)){let{data:i,expires:s}=n.get(o);if(!s||s>new Date)return i;s&&n.delete(o)}return null},async updateData(o,i,s){n.set(o,{data:i,expires:s})},async deleteData(o){n.delete(o)}})}});var Tr,su=m(()=>{Tr=class extends Error{constructor(t,r){super(`Field "${t}" exceeded upload size of ${r} bytes.`),this.field=t,this.maxBytes=r}}});function Bm({filter:e,maxPartSize:t=3e6}={}){return async({filename:r,contentType:n,name:o,data:i})=>{if(e&&!await e({filename:r,contentType:n,name:o}))return;let s=0,a=[];for await(let c of i){if(s+=c.byteLength,s>t)throw new Tr(o,t);a.push(c)}return typeof r=="string"?new File(a,r,{type:n}):await new Blob(a,{type:n}).text()}}var Vm=m(()=>{su();});async function Gm(e,t){if(t??(t=process.env.REMIX_DEV_HTTP_ORIGIN),!t)throw Error("Dev server origin not set");let r=new URL(t);r.pathname="ping";let n=await fetch(r.href,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({buildHash:e.assets.version})}).catch(o=>{throw console.error(`Could not reach Remix dev server at ${r}`),o});if(!n.ok)throw console.error(`Could not reach Remix dev server at ${r} (${n.status})`),Error(await n.text())}function zm(e){console.log(`[REMIX DEV] ${e.assets.version} ready`)}var Xm=m(()=>{});var We={};Vt(We,{MaxPartSizeExceededError:()=>Tr,broadcastDevReady:()=>Gm,createCookieFactory:()=>zh,createCookieSessionStorageFactory:()=>Wm,createMemorySessionStorageFactory:()=>Jm,createRequestHandler:()=>$m,createSession:()=>Tn,createSessionStorageFactory:()=>Km,defer:()=>um,isCookie:()=>Rr,isSession:()=>Lm,json:()=>Pn,logDevReady:()=>zm,redirect:()=>rs,unstable_composeUploadHandlers:()=>om,unstable_createMemoryUploadHandler:()=>Bm,unstable_parseMultipartFormData:()=>im});var Fe=m(()=>{es();sm();ns();Um();iu();Fm();jm();Vm();su();Xm();});var cu=p(au=>{"use strict";Object.defineProperty(au,"__esModule",{value:!0});async function xA(e,t,r,n){let{api:o,config:i}=e;throw await o.auth.begin({shop:n,callbackPath:i.auth.callbackPath,isOnline:r,rawRequest:t})}au.beginAuth=xA});var lu=p(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});var CA=(Fe(),R(We));function PA(e,t,r){let{api:n,config:o}=e,s=new URL(t.url).searchParams,a=n.utils.sanitizeHost(s.get("host"));throw s.set("shop",r),s.set("exitIframe",`${o.auth.path}?shop=${r}`),a&&s.set("host",a),CA.redirect(`${o.auth.exitIframePath}?${s.toString()}`)}uu.redirectWithExitIframe=PA});var is=p(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});var OA="https://cdn.shopify.com/shopifycloud/app-bridge.js",TA="X-Shopify-API-Request-Failure-Reauthorize-Url";os.APP_BRIDGE_URL=OA;os.REAUTH_URL_HEADER=TA});var du=p(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});var IA=is();function qA(e,t){let{config:r}=e,n=`${r.appUrl}${r.auth.path}?shop=${t}`;throw new Response(void 0,{status:401,statusText:"Unauthorized",headers:Ym(n)})}function Ym(e){return new Headers({[IA.REAUTH_URL_HEADER]:e})}ss.getAppBridgeHeaders=Ym;ss.redirectWithAppBridgeHeaders=qA});var Ir=p(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});var HA=cu(),kA=lu(),$A=du();async function MA(e,t,r,n=!1){let i=new URL(t.url).searchParams.get("embedded")==="1";if(t.headers.get("authorization"))$A.redirectWithAppBridgeHeaders(e,r);else if(i)kA.redirectWithExitIframe(e,t,r);else throw await HA.beginAuth(e,t,n,r)}pu.redirectToAuthPage=MA});var Qm=p(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});var NA=et(),DA=Ir();Fe();pt();function UA(e,t,r){return async function(o){let{api:i,logger:s}=e;s.debug("Cancelling billing",{shop:r.shop,...o});try{return await i.billing.cancel({session:r,subscriptionId:o.subscriptionId,isTest:o.isTest,prorate:o.prorate})}catch(a){throw a instanceof NA.HttpResponseError&&a.response.code===401?(s.debug("API token was invalid, redirecting to OAuth",{shop:r.shop}),await DA.redirectToAuthPage(e,t,r.shop)):a}}}fu.cancelBillingFactory=UA});var Zm=p(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});var LA=et(),KA=Ir();Fe();pt();function WA(e,t,r){let{api:n,logger:o}=e;return async function(s){let a={shop:r.shop,plans:s.plans,isTest:s.isTest};o.debug("Checking billing for the shop",a);let c;try{c=await n.billing.check({session:r,plans:s.plans,isTest:s.isTest,returnObject:!0})}catch(u){throw u instanceof LA.HttpResponseError&&u.response.code===401?(o.debug("API token was invalid, redirecting to OAuth",a),await KA.redirectToAuthPage(e,t,r.shop)):u}if(!c.hasActivePayment)throw o.debug("Billing check failed",a),await s.onFailure(new Error("Billing check failed"));return o.debug("Billing check succeeded",a),c}}hu.requireBillingFactory=WA});var ty=p(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});var FA=et(),ey=(Fe(),R(We)),JA=Ir();pt();var jA=du();function BA(e,t,r){return async function({plan:o,isTest:i,returnUrl:s}){let{api:a,logger:c}=e;c.info("Requesting billing",{shop:r.shop,plan:o,isTest:i,returnUrl:s});let u;try{u=await a.billing.request({plan:o,session:r,isTest:i,returnUrl:s,returnObject:!0})}catch(l){throw l instanceof FA.HttpResponseError&&l.response.code===401?(c.debug("API token was invalid, redirecting to OAuth",{shop:r.shop}),await JA.redirectToAuthPage(e,t,r.shop)):l}throw VA(e,t,u.confirmationUrl,r.shop)}}function VA(e,t,r,n){let{config:o,logger:i}=e;i.debug("Redirecting out of app",{url:r});let s=new URL(t.url),a=s.searchParams.get("embedded")==="1";if(t.headers.get("authorization"))throw new Response(void 0,{status:401,statusText:"Unauthorized",headers:jA.getAppBridgeHeaders(r)});if(a){let u=new URLSearchParams({shop:n,host:s.searchParams.get("host"),exitIframe:r});throw ey.redirect(`${o.auth.exitIframePath}?${u.toString()}`)}else throw ey.redirect(r)}mu.requestBillingFactory=BA});var ny=p(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});var GA=is(),ry;function zA(e){ry=e}function XA(){return ry||GA.APP_BRIDGE_URL}as.appBridgeUrl=XA;as.setAppBridgeUrlOverride=zA});var yu=p(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});function YA(e){let{api:t,config:r}=e;return function(n,o){let{searchParams:i}=new URL(n.url),s=t.utils.sanitizeShop(i.get("shop"));oy(o,r.isEmbeddedApp,s)}}function oy(e,t,r){r&&e.set("Link",'<https://cdn.shopify.com/shopifycloud/app-bridge.js>; rel="preload"; as="script";'),t?r&&e.set("Content-Security-Policy",`frame-ancestors https://${r} https://admin.shopify.com;`):e.set("Content-Security-Policy","frame-ancestors 'none';")}cs.addDocumentResponseHeaders=oy;cs.addDocumentResponseHeadersFactory=YA});var us=p(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});var QA=is();function ZA(e,t){let{logger:r,config:n}=e;return function(i){let s=t.headers.get("Origin");return s&&s!==n.appUrl&&(r.debug("Request comes from a different origin, adding CORS headers"),i.headers.set("Access-Control-Allow-Origin","*"),i.headers.set("Access-Control-Allow-Headers","Authorization"),i.headers.set("Access-Control-Expose-Headers",QA.REAUTH_URL_HEADER)),i}}gu.ensureCORSHeadersFactory=ZA});var wu=p(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});async function eR({api:e,logger:t},r){t.debug("Validating session token");try{let n=await e.session.decodeSessionToken(r);return t.debug("Session token is valid",{payload:JSON.stringify(n)}),n}catch(n){throw t.debug(`Failed to validate session token: ${n.message}`),new Response(void 0,{status:401,statusText:"Unauthorized"})}}vu.validateSessionToken=eR});var _u=p(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});function tR(e){var t;return(t=e.headers.get("authorization"))===null||t===void 0?void 0:t.replace("Bearer ","")}bu.getSessionTokenHeader=tR});var Su=p(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});var rR=pt();function nR(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var oR=nR(rR);function iR({logger:e},t){if(oR.default(t.headers.get("User-Agent")))throw e.debug("Request is from a bot, skipping auth"),new Response(void 0,{status:410,statusText:"Gone"})}Eu.rejectBotRequest=iR});var Ru=p(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});var sR=us();function aR(e,t){if(t.method==="OPTIONS")throw sR.ensureCORSHeadersFactory(e,t)(new Response(null,{status:204,headers:{"Access-Control-Max-Age":"7200"}}))}Au.respondToOptionsRequest=aR});var Cu=p(xu=>{"use strict";Object.defineProperty(xu,"__esModule",{value:!0});var cR=et(),uR=Ir();async function lR({params:e,request:t,error:r,shop:n}){throw r instanceof cR.HttpResponseError?(e.logger.debug(`Got an HTTP response error from the API: ${r.message}`,{code:r.response.code,statusText:r.response.statusText,body:JSON.stringify(r.response.body)}),r.response.code===401?await uR.redirectToAuthPage(e,t,n):new Response(JSON.stringify(r.response.body),{status:r.response.code,headers:{"Content-Type":r.response.headers["Content-Type"]}})):(e.logger.debug(`Got a response error from the API: ${r.message}`),r)}xu.handleClientError=lR});var iy=p(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});var dR=Fr(),pR=Cu();function fR({params:e,request:t,session:r}){return async function(n,o){var i;let{api:s,config:a,logger:c}=e,u=new s.clients.Graphql({session:r,apiVersion:(i=o)===null||i===void 0?void 0:i.apiVersion});try{var l,d,h;let f=await u.query({data:{query:n,variables:(l=o)===null||l===void 0?void 0:l.variables},tries:(d=o)===null||d===void 0?void 0:d.tries,extraHeaders:(h=o)===null||h===void 0?void 0:h.headers});return new Response(JSON.stringify(f.body),{headers:dR.flatHeaders(f.headers)})}catch(f){throw await pR.handleClientError({params:{api:s,config:a,logger:c},request:t,error:f,shop:r.shop})}}}Pu.graphqlClientFactory=fR});var ay=p(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});Fe();pt();var sy=Cu(),Ou=class{constructor({params:t,request:r,session:n}){this.session=void 0,this.resources=void 0,this.params=void 0,this.request=void 0,this.params=t,this.request=r,this.session=n}async get(t){return this.makeRequest({method:"GET",...t})}async post(t){return this.makeRequest({method:"POST",...t})}async put(t){return this.makeRequest({method:"PUT",...t})}async delete(t){return this.makeRequest({method:"DELETE",...t})}async makeRequest(t){let r=new this.params.api.clients.Rest({session:this.session}),n=Reflect.get(r,"request");try{let o=await n.call(r,t);return new Response(JSON.stringify(o.body),{headers:o.headers})}catch(o){throw await sy.handleClientError({params:this.params,request:this.request,shop:this.session.shop,error:o})}}};function hR({params:e,request:t,session:r}){let{api:n,config:o,logger:i}=e,s=n.clients.Rest;return class extends s{async request(c){let u=new n.clients.Rest({session:r}),l=Reflect.get(u,"request");try{return await l.call(u,c)}catch(d){throw await sy.handleClientError({params:{api:n,config:o,logger:i},request:t,shop:r.shop,error:d})}}}}ls.RemixRestClient=Ou;ls.restResourceClientFactory=hR});var fy=p(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});var ds=(Fe(),R(We)),In=et(),mR=Qm(),yR=Zm(),gR=ty(),vR=ny(),wR=yu(),cy=Ir(),uy=lu(),qn=cu(),bR=us(),ly=wu(),_R=_u(),ER=Su(),SR=Ru(),AR=iy(),dy=ay(),py="id_token",Tu=class{constructor({api:t,config:r,logger:n}){this.api=void 0,this.config=void 0,this.logger=void 0,this.api=t,this.config=r,this.logger=n}async authenticateAdmin(t){let{api:r,logger:n,config:o}=this;ER.rejectBotRequest({api:r,logger:n,config:o},t),SR.respondToOptionsRequest({api:r,logger:n,config:o},t);let i=bR.ensureCORSHeadersFactory({api:r,logger:n,config:o},t),s;try{s=await this.authenticateAndGetSessionContext(t)}catch(c){throw c instanceof Response&&i(c),c}let a={admin:this.createAdminApiContext(t,s.session),billing:this.createBillingContext(t,s.session),session:s.session,cors:i};return o.isEmbeddedApp?{...a,sessionToken:s.token}:a}async authenticateAndGetSessionContext(t){let{api:r,logger:n,config:o}=this,i=new URL(t.url),s=i.pathname===o.auth.patchSessionTokenPath,a=i.pathname===o.auth.exitIframePath,c=i.pathname===o.auth.path,u=i.pathname===o.auth.callbackPath,l=_R.getSessionTokenHeader(t);if(n.info("Authenticating admin request"),s)throw n.debug("Rendering bounce page"),this.renderAppBridge(t);if(a){let d=i.searchParams.get("exitIframe");throw n.debug("Rendering exit iframe page",{destination:d}),this.renderAppBridge(t,d)}else{if(u)throw await this.handleAuthCallbackRequest(t);if(c)throw await this.handleAuthBeginRequest(t);if(l){let d=await ly.validateSessionToken({api:r,logger:n,config:o},l);return this.validateAuthenticatedSession(t,d)}else return await this.validateUrlParams(t),await this.ensureInstalledOnShop(t),await this.ensureAppIsEmbeddedIfRequired(t),await this.ensureSessionTokenSearchParamIfRequired(t),this.ensureSessionExists(t)}}async handleAuthBeginRequest(t){let{api:r,config:n,logger:o}=this;o.info("Handling OAuth begin request");let i=this.ensureValidShopParam(t);throw o.debug("OAuth request contained valid shop",{shop:i}),n.isEmbeddedApp&&t.headers.get("Sec-Fetch-Dest")==="iframe"?(o.debug("Auth request in iframe detected, exiting iframe",{shop:i}),uy.redirectWithExitIframe({api:r,config:n,logger:o},t,i)):await qn.beginAuth({api:r,config:n,logger:o},t,!1,i)}async handleAuthCallbackRequest(t){let{api:r,config:n,logger:o}=this;o.info("Handling OAuth callback request");let i=this.ensureValidShopParam(t);try{let{session:s,headers:a}=await r.auth.callback({rawRequest:t});throw await n.sessionStorage.storeSession(s),n.useOnlineTokens&&!s.isOnline&&(o.info("Requesting online access token for offline session"),await qn.beginAuth({api:r,config:n,logger:o},t,!0,i)),n.hooks.afterAuth&&(o.info("Running afterAuth hook"),await n.hooks.afterAuth({session:s,admin:this.createAdminApiContext(t,s)})),await this.redirectToShopifyOrAppRoot(t,a)}catch(s){throw s instanceof Response?s:(o.error("Error during OAuth callback",{error:s.message}),s instanceof In.CookieNotFound?await this.handleAuthBeginRequest(t):s instanceof In.InvalidHmacError||s instanceof In.InvalidOAuthError?new Response(void 0,{status:400,statusText:"Invalid OAuth Request"}):new Response(void 0,{status:500,statusText:"Internal Server Error"}))}}async validateUrlParams(t){let{api:r,config:n,logger:o}=this;if(n.isEmbeddedApp){let i=new URL(t.url),s=r.utils.sanitizeShop(i.searchParams.get("shop"));if(!s)throw o.debug("Missing or invalid shop, redirecting to login path",{shop:s}),ds.redirect(n.auth.loginPath);if(!r.utils.sanitizeHost(i.searchParams.get("host")))throw o.debug("Invalid host, redirecting to login path",{host:i.searchParams.get("host")}),ds.redirect(n.auth.loginPath)}}async ensureInstalledOnShop(t){let{api:r,config:n,logger:o}=this,i=new URL(t.url),s=i.searchParams.get("shop"),a=i.searchParams.get("embedded")==="1";o.debug("Ensuring app is installed on shop",{shop:s});let c=s?r.session.getOfflineId(s):await r.session.getCurrentId({isOnline:!1,rawRequest:t});if(!c)throw o.info("Could not find a shop, can't authenticate request"),new Response(void 0,{status:400,statusText:"Bad Request"});let u=await n.sessionStorage.loadSession(c);if(!u)if(o.info("Shop hasn't installed app yet, redirecting to OAuth",{shop:s}),a)uy.redirectWithExitIframe({api:r,config:n,logger:o},t,s);else throw await qn.beginAuth({api:r,config:n,logger:o},t,!1,s);if(s=s||u.shop,n.isEmbeddedApp&&!a)try{o.debug("Ensuring offline session is valid before embedding",{shop:s}),await this.testSession(u),o.debug("Offline session is still valid, embedding app",{shop:s})}catch(l){if(l instanceof In.HttpResponseError){if(l.response.code===401)throw o.info("Shop session is no longer valid, redirecting to OAuth",{shop:s}),await qn.beginAuth({api:r,config:n,logger:o},t,!1,s);{let d=JSON.stringify(l.response.body,null,2);throw o.error(`Unexpected error during session validation: ${d}`,{shop:s}),new Response(void 0,{status:l.response.code,statusText:l.response.statusText})}}else if(l instanceof In.GraphqlQueryError){let d={shop:s};throw l.response&&(d.response=JSON.stringify(l.response)),o.error(`Unexpected error during session validation: ${l.message}`,d),new Response(void 0,{status:500,statusText:"Internal Server Error"})}}}async testSession(t){let{api:r}=this;await new r.clients.Graphql({session:t}).query({data:`#graphql
        query shopifyAppShopName {
          shop {
            name
          }
        }
      `})}ensureValidShopParam(t){let r=new URL(t.url),{api:n}=this,o=n.utils.sanitizeShop(r.searchParams.get("shop"));if(!o)throw new Response("Shop param is invalid",{status:400});return o}async ensureAppIsEmbeddedIfRequired(t){let{api:r,logger:n}=this,o=new URL(t.url),i=o.searchParams.get("shop");r.config.isEmbeddedApp&&o.searchParams.get("embedded")!=="1"&&(n.debug("App is not embedded, redirecting to Shopify",{shop:i}),await this.redirectToShopifyOrAppRoot(t))}async ensureSessionTokenSearchParamIfRequired(t){let{api:r,logger:n}=this,o=new URL(t.url),i=o.searchParams.get("shop"),s=o.searchParams.get(py);r.config.isEmbeddedApp&&!s&&(n.debug("Missing session token in search params, going to bounce page",{shop:i}),this.redirectToBouncePage(o))}async ensureSessionExists(t){let{api:r,config:n,logger:o}=this,i=new URL(t.url),s=i.searchParams.get("shop"),a=i.searchParams.get(py);if(r.config.isEmbeddedApp){o.debug("Session token is present in query params, validating session",{shop:s});let c=await ly.validateSessionToken({api:r,config:n,logger:o},a);return this.validateAuthenticatedSession(t,c)}else{let c=await r.session.getCurrentId({isOnline:n.useOnlineTokens,rawRequest:t});if(!c)throw o.debug("Session id not found in cookies, redirecting to OAuth",{shop:s}),await qn.beginAuth({api:r,config:n,logger:o},t,!1,s);return{session:await this.loadSession(t,s,c)}}}async validateAuthenticatedSession(t,r){let{config:n,logger:o,api:i}=this,a=new URL(r.dest).hostname,c=n.useOnlineTokens?i.session.getJwtSessionId(a,r.sub):i.session.getOfflineId(a),u=await this.loadSession(t,a,c);return o.debug("Found session, request is valid",{shop:a}),{session:u,token:r}}async loadSession(t,r,n){let{api:o,config:i,logger:s}=this;s.debug("Loading session from storage",{sessionId:n});let a=await i.sessionStorage.loadSession(n);return a?a.isActive(i.scopes)||(s.debug("Found a session, but it has expired, redirecting to OAuth",{shop:r}),await cy.redirectToAuthPage({api:o,config:i,logger:s},t,r)):(s.debug("No session found, redirecting to OAuth",{shop:r}),await cy.redirectToAuthPage({api:o,config:i,logger:s},t,r)),a}async redirectToShopifyOrAppRoot(t,r){let{api:n}=this,o=new URL(t.url),i=n.utils.sanitizeHost(o.searchParams.get("host")),s=n.utils.sanitizeShop(o.searchParams.get("shop")),a=n.config.isEmbeddedApp?await n.auth.getEmbeddedAppUrl({rawRequest:t}):`/?shop=${s}&host=${encodeURIComponent(i)}`;throw ds.redirect(a,{headers:r})}redirectToBouncePage(t){let{api:r,config:n}=this;t.protocol=`${r.config.hostScheme}:`;let o=new URLSearchParams(t.search);throw o.set("shopify-reload",t.href),ds.redirect(`${n.auth.patchSessionTokenPath}?${o.toString()}`)}renderAppBridge(t,r){let{config:n}=this,o="";r&&(o=`<script>window.open("${decodeURIComponent(r.startsWith("/")?`${n.appUrl}${r}`:r)}", "_top")<\/script>`);let i=new Headers({"content-type":"text/html;charset=utf-8"});throw wR.addDocumentResponseHeaders(i,n.isEmbeddedApp,new URL(t.url).searchParams.get("shop")),new Response(`
        <script data-api-key="${n.apiKey}" src="${vR.appBridgeUrl()}"><\/script>
        ${o}
      `,{headers:i})}overriddenRestClient(t,r){let{api:n,config:o,logger:i}=this,s=new dy.RemixRestClient({params:{api:n,config:o,logger:i},request:t,session:r});if(n.rest){s.resources={};let a=dy.restResourceClientFactory({params:{api:n,config:o,logger:i},request:t,session:r});Object.entries(n.rest).forEach(([c,u])=>{class l extends u{}l.Client=a,Reflect.defineProperty(l,"name",{value:c}),Reflect.set(s.resources,c,l)})}return s}createBillingContext(t,r){let{api:n,logger:o,config:i}=this;return{require:yR.requireBillingFactory({api:n,logger:o,config:i},t,r),request:gR.requestBillingFactory({api:n,logger:o,config:i},t,r),cancel:mR.cancelBillingFactory({api:n,logger:o,config:i},t,r)}}createAdminApiContext(t,r){let{api:n,config:o,logger:i}=this;return{rest:this.overriddenRestClient(t,r),graphql:AR.graphqlClientFactory({params:{api:n,config:o,logger:i},request:t,session:r})}}};Iu.AuthStrategy=Tu});var hy=p(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});function RR({api:e,config:t,logger:r}){return async function(o){if(o.method!=="POST")throw r.debug("Received a non-POST request for a webhook. Only POST requests are allowed.",{url:o.url,method:o.method}),new Response(void 0,{status:405,statusText:"Method not allowed"});let i=await o.text(),s=await e.webhooks.validate({rawBody:i,rawRequest:o});if(!s.valid)throw r.debug("Webhook validation failed",s),new Response(void 0,{status:400,statusText:"Bad Request"});let a=e.session.getOfflineId(s.domain),c=await t.sessionStorage.loadSession(a),u={apiVersion:s.apiVersion,shop:s.domain,topic:s.topic,webhookId:s.webhookId,payload:JSON.parse(i),session:void 0,admin:void 0};if(!c)return u;let l=new e.clients.Rest({session:c,apiVersion:s.apiVersion}),d=new e.clients.Graphql({session:c,apiVersion:s.apiVersion});return Object.entries(e.rest).forEach(([h,f])=>{Reflect.set(l,h,f)}),{...u,session:c,admin:{rest:l,graphql:d}}}}qu.authenticateWebhookFactory=RR});var my=p(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Fe();var xR=us(),CR=wu(),PR=_u(),OR=Su(),TR=Ru();et();function IR(e){return async function(r){let{logger:n}=e;OR.rejectBotRequest(e,r),TR.respondToOptionsRequest(e,r);let o=PR.getSessionTokenHeader(r);if(n.info("Authenticating public request"),!o)throw n.debug("Request did not contain a session token"),new Response(void 0,{status:401,statusText:"Unauthorized"});return{sessionToken:await CR.validateSessionToken(e,o),cors:xR.ensureCORSHeadersFactory(e,r)}}}Hu.authenticatePublicFactory=IR});var Hn=p((CM,yy)=>{var qR="2.0.0",HR=Number.MAX_SAFE_INTEGER||9007199254740991,kR=16,$R=256-6,MR=["major","premajor","minor","preminor","patch","prepatch","prerelease"];yy.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:kR,MAX_SAFE_BUILD_LENGTH:$R,MAX_SAFE_INTEGER:HR,RELEASE_TYPES:MR,SEMVER_SPEC_VERSION:qR,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var kn=p((PM,gy)=>{var NR=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};gy.exports=NR});var qr=p((rt,vy)=>{var{MAX_SAFE_COMPONENT_LENGTH:ku,MAX_SAFE_BUILD_LENGTH:DR,MAX_LENGTH:UR}=Hn(),LR=kn();rt=vy.exports={};var KR=rt.re=[],WR=rt.safeRe=[],v=rt.src=[],w=rt.t={},FR=0,$u="[a-zA-Z0-9-]",JR=[["\\s",1],["\\d",UR],[$u,DR]],jR=e=>{for(let[t,r]of JR)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e},C=(e,t,r)=>{let n=jR(t),o=FR++;LR(e,o,t),w[e]=o,v[o]=t,KR[o]=new RegExp(t,r?"g":void 0),WR[o]=new RegExp(n,r?"g":void 0)};C("NUMERICIDENTIFIER","0|[1-9]\\d*");C("NUMERICIDENTIFIERLOOSE","\\d+");C("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${$u}*`);C("MAINVERSION",`(${v[w.NUMERICIDENTIFIER]})\\.(${v[w.NUMERICIDENTIFIER]})\\.(${v[w.NUMERICIDENTIFIER]})`);C("MAINVERSIONLOOSE",`(${v[w.NUMERICIDENTIFIERLOOSE]})\\.(${v[w.NUMERICIDENTIFIERLOOSE]})\\.(${v[w.NUMERICIDENTIFIERLOOSE]})`);C("PRERELEASEIDENTIFIER",`(?:${v[w.NUMERICIDENTIFIER]}|${v[w.NONNUMERICIDENTIFIER]})`);C("PRERELEASEIDENTIFIERLOOSE",`(?:${v[w.NUMERICIDENTIFIERLOOSE]}|${v[w.NONNUMERICIDENTIFIER]})`);C("PRERELEASE",`(?:-(${v[w.PRERELEASEIDENTIFIER]}(?:\\.${v[w.PRERELEASEIDENTIFIER]})*))`);C("PRERELEASELOOSE",`(?:-?(${v[w.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${v[w.PRERELEASEIDENTIFIERLOOSE]})*))`);C("BUILDIDENTIFIER",`${$u}+`);C("BUILD",`(?:\\+(${v[w.BUILDIDENTIFIER]}(?:\\.${v[w.BUILDIDENTIFIER]})*))`);C("FULLPLAIN",`v?${v[w.MAINVERSION]}${v[w.PRERELEASE]}?${v[w.BUILD]}?`);C("FULL",`^${v[w.FULLPLAIN]}$`);C("LOOSEPLAIN",`[v=\\s]*${v[w.MAINVERSIONLOOSE]}${v[w.PRERELEASELOOSE]}?${v[w.BUILD]}?`);C("LOOSE",`^${v[w.LOOSEPLAIN]}$`);C("GTLT","((?:<|>)?=?)");C("XRANGEIDENTIFIERLOOSE",`${v[w.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);C("XRANGEIDENTIFIER",`${v[w.NUMERICIDENTIFIER]}|x|X|\\*`);C("XRANGEPLAIN",`[v=\\s]*(${v[w.XRANGEIDENTIFIER]})(?:\\.(${v[w.XRANGEIDENTIFIER]})(?:\\.(${v[w.XRANGEIDENTIFIER]})(?:${v[w.PRERELEASE]})?${v[w.BUILD]}?)?)?`);C("XRANGEPLAINLOOSE",`[v=\\s]*(${v[w.XRANGEIDENTIFIERLOOSE]})(?:\\.(${v[w.XRANGEIDENTIFIERLOOSE]})(?:\\.(${v[w.XRANGEIDENTIFIERLOOSE]})(?:${v[w.PRERELEASELOOSE]})?${v[w.BUILD]}?)?)?`);C("XRANGE",`^${v[w.GTLT]}\\s*${v[w.XRANGEPLAIN]}$`);C("XRANGELOOSE",`^${v[w.GTLT]}\\s*${v[w.XRANGEPLAINLOOSE]}$`);C("COERCE",`(^|[^\\d])(\\d{1,${ku}})(?:\\.(\\d{1,${ku}}))?(?:\\.(\\d{1,${ku}}))?(?:$|[^\\d])`);C("COERCERTL",v[w.COERCE],!0);C("LONETILDE","(?:~>?)");C("TILDETRIM",`(\\s*)${v[w.LONETILDE]}\\s+`,!0);rt.tildeTrimReplace="$1~";C("TILDE",`^${v[w.LONETILDE]}${v[w.XRANGEPLAIN]}$`);C("TILDELOOSE",`^${v[w.LONETILDE]}${v[w.XRANGEPLAINLOOSE]}$`);C("LONECARET","(?:\\^)");C("CARETTRIM",`(\\s*)${v[w.LONECARET]}\\s+`,!0);rt.caretTrimReplace="$1^";C("CARET",`^${v[w.LONECARET]}${v[w.XRANGEPLAIN]}$`);C("CARETLOOSE",`^${v[w.LONECARET]}${v[w.XRANGEPLAINLOOSE]}$`);C("COMPARATORLOOSE",`^${v[w.GTLT]}\\s*(${v[w.LOOSEPLAIN]})$|^$`);C("COMPARATOR",`^${v[w.GTLT]}\\s*(${v[w.FULLPLAIN]})$|^$`);C("COMPARATORTRIM",`(\\s*)${v[w.GTLT]}\\s*(${v[w.LOOSEPLAIN]}|${v[w.XRANGEPLAIN]})`,!0);rt.comparatorTrimReplace="$1$2$3";C("HYPHENRANGE",`^\\s*(${v[w.XRANGEPLAIN]})\\s+-\\s+(${v[w.XRANGEPLAIN]})\\s*$`);C("HYPHENRANGELOOSE",`^\\s*(${v[w.XRANGEPLAINLOOSE]})\\s+-\\s+(${v[w.XRANGEPLAINLOOSE]})\\s*$`);C("STAR","(<|>)?=?\\s*\\*");C("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");C("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var ps=p((OM,wy)=>{var BR=Object.freeze({loose:!0}),VR=Object.freeze({}),GR=e=>e?typeof e!="object"?BR:e:VR;wy.exports=GR});var Mu=p((TM,Ey)=>{var by=/^[0-9]+$/,_y=(e,t)=>{let r=by.test(e),n=by.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1},zR=(e,t)=>_y(t,e);Ey.exports={compareIdentifiers:_y,rcompareIdentifiers:zR}});var de=p((IM,xy)=>{var fs=kn(),{MAX_LENGTH:Sy,MAX_SAFE_INTEGER:hs}=Hn(),{safeRe:Ay,t:Ry}=qr(),XR=ps(),{compareIdentifiers:Hr}=Mu(),_e=class{constructor(t,r){if(r=XR(r),t instanceof _e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Sy)throw new TypeError(`version is longer than ${Sy} characters`);fs("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=t.trim().match(r.loose?Ay[Ry.LOOSE]:Ay[Ry.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>hs||this.major<0)throw new TypeError("Invalid major version");if(this.minor>hs||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>hs||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let i=+o;if(i>=0&&i<hs)return i}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(fs("SemVer.compare",this.version,this.options,t),!(t instanceof _e)){if(typeof t=="string"&&t===this.version)return 0;t=new _e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof _e||(t=new _e(t,this.options)),Hr(this.major,t.major)||Hr(this.minor,t.minor)||Hr(this.patch,t.patch)}comparePre(t){if(t instanceof _e||(t=new _e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],o=t.prerelease[r];if(fs("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Hr(n,o)}while(++r)}compareBuild(t){t instanceof _e||(t=new _e(t,this.options));let r=0;do{let n=this.build[r],o=t.build[r];if(fs("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Hr(n,o)}while(++r)}inc(t,r,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(r){let i=[r,o];n===!1&&(i=[r]),Hr(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};xy.exports=_e});var Kt=p((qM,Py)=>{var Cy=de(),YR=(e,t,r=!1)=>{if(e instanceof Cy)return e;try{return new Cy(e,t)}catch(n){if(!r)return null;throw n}};Py.exports=YR});var Ty=p((HM,Oy)=>{var QR=Kt(),ZR=(e,t)=>{let r=QR(e,t);return r?r.version:null};Oy.exports=ZR});var qy=p((kM,Iy)=>{var ex=Kt(),tx=(e,t)=>{let r=ex(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};Iy.exports=tx});var $y=p(($M,ky)=>{var Hy=de(),rx=(e,t,r,n,o)=>{typeof r=="string"&&(o=n,n=r,r=void 0);try{return new Hy(e instanceof Hy?e.version:e,r).inc(t,n,o).version}catch{return null}};ky.exports=rx});var Dy=p((MM,Ny)=>{var My=Kt(),nx=(e,t)=>{let r=My(e,null,!0),n=My(t,null,!0),o=r.compare(n);if(o===0)return null;let i=o>0,s=i?r:n,a=i?n:r,c=!!s.prerelease.length;if(!!a.prerelease.length&&!c)return!a.patch&&!a.minor?"major":s.patch?"patch":s.minor?"minor":"major";let l=c?"pre":"";return r.major!==n.major?l+"major":r.minor!==n.minor?l+"minor":r.patch!==n.patch?l+"patch":"prerelease"};Ny.exports=nx});var Ly=p((NM,Uy)=>{var ox=de(),ix=(e,t)=>new ox(e,t).major;Uy.exports=ix});var Wy=p((DM,Ky)=>{var sx=de(),ax=(e,t)=>new sx(e,t).minor;Ky.exports=ax});var Jy=p((UM,Fy)=>{var cx=de(),ux=(e,t)=>new cx(e,t).patch;Fy.exports=ux});var By=p((LM,jy)=>{var lx=Kt(),dx=(e,t)=>{let r=lx(e,t);return r&&r.prerelease.length?r.prerelease:null};jy.exports=dx});var Se=p((KM,Gy)=>{var Vy=de(),px=(e,t,r)=>new Vy(e,r).compare(new Vy(t,r));Gy.exports=px});var Xy=p((WM,zy)=>{var fx=Se(),hx=(e,t,r)=>fx(t,e,r);zy.exports=hx});var Qy=p((FM,Yy)=>{var mx=Se(),yx=(e,t)=>mx(e,t,!0);Yy.exports=yx});var ms=p((JM,eg)=>{var Zy=de(),gx=(e,t,r)=>{let n=new Zy(e,r),o=new Zy(t,r);return n.compare(o)||n.compareBuild(o)};eg.exports=gx});var rg=p((jM,tg)=>{var vx=ms(),wx=(e,t)=>e.sort((r,n)=>vx(r,n,t));tg.exports=wx});var og=p((BM,ng)=>{var bx=ms(),_x=(e,t)=>e.sort((r,n)=>bx(n,r,t));ng.exports=_x});var $n=p((VM,ig)=>{var Ex=Se(),Sx=(e,t,r)=>Ex(e,t,r)>0;ig.exports=Sx});var ys=p((GM,sg)=>{var Ax=Se(),Rx=(e,t,r)=>Ax(e,t,r)<0;sg.exports=Rx});var Nu=p((zM,ag)=>{var xx=Se(),Cx=(e,t,r)=>xx(e,t,r)===0;ag.exports=Cx});var Du=p((XM,cg)=>{var Px=Se(),Ox=(e,t,r)=>Px(e,t,r)!==0;cg.exports=Ox});var gs=p((YM,ug)=>{var Tx=Se(),Ix=(e,t,r)=>Tx(e,t,r)>=0;ug.exports=Ix});var vs=p((QM,lg)=>{var qx=Se(),Hx=(e,t,r)=>qx(e,t,r)<=0;lg.exports=Hx});var Uu=p((ZM,dg)=>{var kx=Nu(),$x=Du(),Mx=$n(),Nx=gs(),Dx=ys(),Ux=vs(),Lx=(e,t,r,n)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return kx(e,r,n);case"!=":return $x(e,r,n);case">":return Mx(e,r,n);case">=":return Nx(e,r,n);case"<":return Dx(e,r,n);case"<=":return Ux(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};dg.exports=Lx});var fg=p((eN,pg)=>{var Kx=de(),Wx=Kt(),{safeRe:ws,t:bs}=qr(),Fx=(e,t)=>{if(e instanceof Kx)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let r=null;if(!t.rtl)r=e.match(ws[bs.COERCE]);else{let n;for(;(n=ws[bs.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)(!r||n.index+n[0].length!==r.index+r[0].length)&&(r=n),ws[bs.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;ws[bs.COERCERTL].lastIndex=-1}return r===null?null:Wx(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)};pg.exports=Fx});var mg=p((tN,hg)=>{"use strict";hg.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}});var gg=p((rN,yg)=>{"use strict";yg.exports=q;q.Node=Wt;q.create=q;function q(e){var t=this;if(t instanceof q||(t=new q),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(o){t.push(o)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}q.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t};q.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};q.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};q.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)jx(this,arguments[e]);return this.length};q.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Bx(this,arguments[e]);return this.length};q.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};q.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};q.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;r!==null;n++)e.call(t,r.value,n,this),r=r.next};q.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;r!==null;n--)e.call(t,r.value,n,this),r=r.prev};q.prototype.get=function(e){for(var t=0,r=this.head;r!==null&&t<e;t++)r=r.next;if(t===e&&r!==null)return r.value};q.prototype.getReverse=function(e){for(var t=0,r=this.tail;r!==null&&t<e;t++)r=r.prev;if(t===e&&r!==null)return r.value};q.prototype.map=function(e,t){t=t||this;for(var r=new q,n=this.head;n!==null;)r.push(e.call(t,n.value,this)),n=n.next;return r};q.prototype.mapReverse=function(e,t){t=t||this;for(var r=new q,n=this.tail;n!==null;)r.push(e.call(t,n.value,this)),n=n.prev;return r};q.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=0;n!==null;o++)r=e(r,n.value,o),n=n.next;return r};q.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=this.length-1;n!==null;o--)r=e(r,n.value,o),n=n.prev;return r};q.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;r!==null;t++)e[t]=r.value,r=r.next;return e};q.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;r!==null;t++)e[t]=r.value,r=r.prev;return e};q.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new q;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,o=this.head;o!==null&&n<e;n++)o=o.next;for(;o!==null&&n<t;n++,o=o.next)r.push(o.value);return r};q.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new q;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,o=this.tail;o!==null&&n>t;n--)o=o.prev;for(;o!==null&&n>e;n--,o=o.prev)r.push(o.value);return r};q.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,o=this.head;o!==null&&n<e;n++)o=o.next;for(var i=[],n=0;o&&n<t;n++)i.push(o.value),o=this.removeNode(o);o===null&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(var n=0;n<r.length;n++)o=Jx(this,o,r[n]);return i};q.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};function Jx(e,t,r){var n=t===e.head?new Wt(r,null,t,e):new Wt(r,t,t.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function jx(e,t){e.tail=new Wt(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Bx(e,t){e.head=new Wt(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Wt(e,t,r,n){if(!(this instanceof Wt))return new Wt(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{mg()(q)}catch{}});var Eg=p((nN,_g)=>{"use strict";var Vx=gg(),Ft=Symbol("max"),ot=Symbol("length"),kr=Symbol("lengthCalculator"),Nn=Symbol("allowStale"),Jt=Symbol("maxAge"),nt=Symbol("dispose"),vg=Symbol("noDisposeOnSet"),Q=Symbol("lruList"),He=Symbol("cache"),bg=Symbol("updateAgeOnGet"),Lu=()=>1,Wu=class{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");let r=this[Ft]=t.max||1/0,n=t.length||Lu;if(this[kr]=typeof n!="function"?Lu:n,this[Nn]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Jt]=t.maxAge||0,this[nt]=t.dispose,this[vg]=t.noDisposeOnSet||!1,this[bg]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Ft]=t||1/0,Mn(this)}get max(){return this[Ft]}set allowStale(t){this[Nn]=!!t}get allowStale(){return this[Nn]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Jt]=t,Mn(this)}get maxAge(){return this[Jt]}set lengthCalculator(t){typeof t!="function"&&(t=Lu),t!==this[kr]&&(this[kr]=t,this[ot]=0,this[Q].forEach(r=>{r.length=this[kr](r.value,r.key),this[ot]+=r.length})),Mn(this)}get lengthCalculator(){return this[kr]}get length(){return this[ot]}get itemCount(){return this[Q].length}rforEach(t,r){r=r||this;for(let n=this[Q].tail;n!==null;){let o=n.prev;wg(this,t,n,r),n=o}}forEach(t,r){r=r||this;for(let n=this[Q].head;n!==null;){let o=n.next;wg(this,t,n,r),n=o}}keys(){return this[Q].toArray().map(t=>t.key)}values(){return this[Q].toArray().map(t=>t.value)}reset(){this[nt]&&this[Q]&&this[Q].length&&this[Q].forEach(t=>this[nt](t.key,t.value)),this[He]=new Map,this[Q]=new Vx,this[ot]=0}dump(){return this[Q].map(t=>_s(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Q]}set(t,r,n){if(n=n||this[Jt],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let o=n?Date.now():0,i=this[kr](r,t);if(this[He].has(t)){if(i>this[Ft])return $r(this,this[He].get(t)),!1;let c=this[He].get(t).value;return this[nt]&&(this[vg]||this[nt](t,c.value)),c.now=o,c.maxAge=n,c.value=r,this[ot]+=i-c.length,c.length=i,this.get(t),Mn(this),!0}let s=new Fu(t,r,i,o,n);return s.length>this[Ft]?(this[nt]&&this[nt](t,r),!1):(this[ot]+=s.length,this[Q].unshift(s),this[He].set(t,this[Q].head),Mn(this),!0)}has(t){if(!this[He].has(t))return!1;let r=this[He].get(t).value;return!_s(this,r)}get(t){return Ku(this,t,!0)}peek(t){return Ku(this,t,!1)}pop(){let t=this[Q].tail;return t?($r(this,t),t.value):null}del(t){$r(this,this[He].get(t))}load(t){this.reset();let r=Date.now();for(let n=t.length-1;n>=0;n--){let o=t[n],i=o.e||0;if(i===0)this.set(o.k,o.v);else{let s=i-r;s>0&&this.set(o.k,o.v,s)}}}prune(){this[He].forEach((t,r)=>Ku(this,r,!1))}},Ku=(e,t,r)=>{let n=e[He].get(t);if(n){let o=n.value;if(_s(e,o)){if($r(e,n),!e[Nn])return}else r&&(e[bg]&&(n.value.now=Date.now()),e[Q].unshiftNode(n));return o.value}},_s=(e,t)=>{if(!t||!t.maxAge&&!e[Jt])return!1;let r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[Jt]&&r>e[Jt]},Mn=e=>{if(e[ot]>e[Ft])for(let t=e[Q].tail;e[ot]>e[Ft]&&t!==null;){let r=t.prev;$r(e,t),t=r}},$r=(e,t)=>{if(t){let r=t.value;e[nt]&&e[nt](r.key,r.value),e[ot]-=r.length,e[He].delete(r.key),e[Q].removeNode(t)}},Fu=class{constructor(t,r,n,o,i){this.key=t,this.value=r,this.length=n,this.now=o,this.maxAge=i||0}},wg=(e,t,r,n)=>{let o=r.value;_s(e,o)&&($r(e,r),e[Nn]||(o=void 0)),o&&t.call(n,o.value,o.key,e)};_g.exports=Wu});var Ae=p((oN,xg)=>{var jt=class{constructor(t,r){if(r=zx(r),t instanceof jt)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new jt(t.raw,r);if(t instanceof Ju)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!Ag(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&rC(o[0])){this.set=[o];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){let n=((this.options.includePrerelease&&eC)|(this.options.loose&&tC))+":"+t,o=Sg.get(n);if(o)return o;let i=this.options.loose,s=i?we[fe.HYPHENRANGELOOSE]:we[fe.HYPHENRANGE];t=t.replace(s,pC(this.options.includePrerelease)),K("hyphen replace",t),t=t.replace(we[fe.COMPARATORTRIM],Yx),K("comparator trim",t),t=t.replace(we[fe.TILDETRIM],Qx),K("tilde trim",t),t=t.replace(we[fe.CARETTRIM],Zx),K("caret trim",t);let a=t.split(" ").map(d=>nC(d,this.options)).join(" ").split(/\s+/).map(d=>dC(d,this.options));i&&(a=a.filter(d=>(K("loose invalid filter",d,this.options),!!d.match(we[fe.COMPARATORLOOSE])))),K("range list",a);let c=new Map,u=a.map(d=>new Ju(d,this.options));for(let d of u){if(Ag(d))return[d];c.set(d.value,d)}c.size>1&&c.has("")&&c.delete("");let l=[...c.values()];return Sg.set(n,l),l}intersects(t,r){if(!(t instanceof jt))throw new TypeError("a Range is required");return this.set.some(n=>Rg(n,r)&&t.set.some(o=>Rg(o,r)&&n.every(i=>o.every(s=>i.intersects(s,r)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new Xx(t,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(fC(this.set[r],t,this.options))return!0;return!1}};xg.exports=jt;var Gx=Eg(),Sg=new Gx({max:1e3}),zx=ps(),Ju=Dn(),K=kn(),Xx=de(),{safeRe:we,t:fe,comparatorTrimReplace:Yx,tildeTrimReplace:Qx,caretTrimReplace:Zx}=qr(),{FLAG_INCLUDE_PRERELEASE:eC,FLAG_LOOSE:tC}=Hn(),Ag=e=>e.value==="<0.0.0-0",rC=e=>e.value==="",Rg=(e,t)=>{let r=!0,n=e.slice(),o=n.pop();for(;r&&n.length;)r=n.every(i=>o.intersects(i,t)),o=n.pop();return r},nC=(e,t)=>(K("comp",e,t),e=sC(e,t),K("caret",e),e=oC(e,t),K("tildes",e),e=cC(e,t),K("xrange",e),e=lC(e,t),K("stars",e),e),he=e=>!e||e.toLowerCase()==="x"||e==="*",oC=(e,t)=>e.trim().split(/\s+/).map(r=>iC(r,t)).join(" "),iC=(e,t)=>{let r=t.loose?we[fe.TILDELOOSE]:we[fe.TILDE];return e.replace(r,(n,o,i,s,a)=>{K("tilde",e,n,o,i,s,a);let c;return he(o)?c="":he(i)?c=`>=${o}.0.0 <${+o+1}.0.0-0`:he(s)?c=`>=${o}.${i}.0 <${o}.${+i+1}.0-0`:a?(K("replaceTilde pr",a),c=`>=${o}.${i}.${s}-${a} <${o}.${+i+1}.0-0`):c=`>=${o}.${i}.${s} <${o}.${+i+1}.0-0`,K("tilde return",c),c})},sC=(e,t)=>e.trim().split(/\s+/).map(r=>aC(r,t)).join(" "),aC=(e,t)=>{K("caret",e,t);let r=t.loose?we[fe.CARETLOOSE]:we[fe.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(o,i,s,a,c)=>{K("caret",e,o,i,s,a,c);let u;return he(i)?u="":he(s)?u=`>=${i}.0.0${n} <${+i+1}.0.0-0`:he(a)?i==="0"?u=`>=${i}.${s}.0${n} <${i}.${+s+1}.0-0`:u=`>=${i}.${s}.0${n} <${+i+1}.0.0-0`:c?(K("replaceCaret pr",c),i==="0"?s==="0"?u=`>=${i}.${s}.${a}-${c} <${i}.${s}.${+a+1}-0`:u=`>=${i}.${s}.${a}-${c} <${i}.${+s+1}.0-0`:u=`>=${i}.${s}.${a}-${c} <${+i+1}.0.0-0`):(K("no pr"),i==="0"?s==="0"?u=`>=${i}.${s}.${a}${n} <${i}.${s}.${+a+1}-0`:u=`>=${i}.${s}.${a}${n} <${i}.${+s+1}.0-0`:u=`>=${i}.${s}.${a} <${+i+1}.0.0-0`),K("caret return",u),u})},cC=(e,t)=>(K("replaceXRanges",e,t),e.split(/\s+/).map(r=>uC(r,t)).join(" ")),uC=(e,t)=>{e=e.trim();let r=t.loose?we[fe.XRANGELOOSE]:we[fe.XRANGE];return e.replace(r,(n,o,i,s,a,c)=>{K("xRange",e,n,o,i,s,a,c);let u=he(i),l=u||he(s),d=l||he(a),h=d;return o==="="&&h&&(o=""),c=t.includePrerelease?"-0":"",u?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&h?(l&&(s=0),a=0,o===">"?(o=">=",l?(i=+i+1,s=0,a=0):(s=+s+1,a=0)):o==="<="&&(o="<",l?i=+i+1:s=+s+1),o==="<"&&(c="-0"),n=`${o+i}.${s}.${a}${c}`):l?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${s}.0${c} <${i}.${+s+1}.0-0`),K("xRange return",n),n})},lC=(e,t)=>(K("replaceStars",e,t),e.trim().replace(we[fe.STAR],"")),dC=(e,t)=>(K("replaceGTE0",e,t),e.trim().replace(we[t.includePrerelease?fe.GTE0PRE:fe.GTE0],"")),pC=e=>(t,r,n,o,i,s,a,c,u,l,d,h,f)=>(he(n)?r="":he(o)?r=`>=${n}.0.0${e?"-0":""}`:he(i)?r=`>=${n}.${o}.0${e?"-0":""}`:s?r=`>=${r}`:r=`>=${r}${e?"-0":""}`,he(u)?c="":he(l)?c=`<${+u+1}.0.0-0`:he(d)?c=`<${u}.${+l+1}.0-0`:h?c=`<=${u}.${l}.${d}-${h}`:e?c=`<${u}.${l}.${+d+1}-0`:c=`<=${c}`,`${r} ${c}`.trim()),fC=(e,t,r)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let n=0;n<e.length;n++)if(K(e[n].semver),e[n].semver!==Ju.ANY&&e[n].semver.prerelease.length>0){let o=e[n].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}});var Dn=p((iN,qg)=>{var Un=Symbol("SemVer ANY"),Mr=class{static get ANY(){return Un}constructor(t,r){if(r=Cg(r),t instanceof Mr){if(t.loose===!!r.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),Bu("comparator",t,r),this.options=r,this.loose=!!r.loose,this.parse(t),this.semver===Un?this.value="":this.value=this.operator+this.semver.version,Bu("comp",this)}parse(t){let r=this.options.loose?Pg[Og.COMPARATORLOOSE]:Pg[Og.COMPARATOR],n=t.match(r);if(!n)throw new TypeError(`Invalid comparator: ${t}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Tg(n[2],this.options.loose):this.semver=Un}toString(){return this.value}test(t){if(Bu("Comparator.test",t,this.options.loose),this.semver===Un||t===Un)return!0;if(typeof t=="string")try{t=new Tg(t,this.options)}catch{return!1}return ju(t,this.operator,this.semver,this.options)}intersects(t,r){if(!(t instanceof Mr))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Ig(t.value,r).test(this.value):t.operator===""?t.value===""?!0:new Ig(this.value,r).test(t.semver):(r=Cg(r),r.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||ju(this.semver,"<",t.semver,r)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||ju(this.semver,">",t.semver,r)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};qg.exports=Mr;var Cg=ps(),{safeRe:Pg,t:Og}=qr(),ju=Uu(),Bu=kn(),Tg=de(),Ig=Ae()});var Ln=p((sN,Hg)=>{var hC=Ae(),mC=(e,t,r)=>{try{t=new hC(t,r)}catch{return!1}return t.test(e)};Hg.exports=mC});var $g=p((aN,kg)=>{var yC=Ae(),gC=(e,t)=>new yC(e,t).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));kg.exports=gC});var Ng=p((cN,Mg)=>{var vC=de(),wC=Ae(),bC=(e,t,r)=>{let n=null,o=null,i=null;try{i=new wC(t,r)}catch{return null}return e.forEach(s=>{i.test(s)&&(!n||o.compare(s)===-1)&&(n=s,o=new vC(n,r))}),n};Mg.exports=bC});var Ug=p((uN,Dg)=>{var _C=de(),EC=Ae(),SC=(e,t,r)=>{let n=null,o=null,i=null;try{i=new EC(t,r)}catch{return null}return e.forEach(s=>{i.test(s)&&(!n||o.compare(s)===1)&&(n=s,o=new _C(n,r))}),n};Dg.exports=SC});var Wg=p((lN,Kg)=>{var Vu=de(),AC=Ae(),Lg=$n(),RC=(e,t)=>{e=new AC(e,t);let r=new Vu("0.0.0");if(e.test(r)||(r=new Vu("0.0.0-0"),e.test(r)))return r;r=null;for(let n=0;n<e.set.length;++n){let o=e.set[n],i=null;o.forEach(s=>{let a=new Vu(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||Lg(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),i&&(!r||Lg(r,i))&&(r=i)}return r&&e.test(r)?r:null};Kg.exports=RC});var Jg=p((dN,Fg)=>{var xC=Ae(),CC=(e,t)=>{try{return new xC(e,t).range||"*"}catch{return null}};Fg.exports=CC});var Es=p((pN,Gg)=>{var PC=de(),Vg=Dn(),{ANY:OC}=Vg,TC=Ae(),IC=Ln(),jg=$n(),Bg=ys(),qC=vs(),HC=gs(),kC=(e,t,r,n)=>{e=new PC(e,n),t=new TC(t,n);let o,i,s,a,c;switch(r){case">":o=jg,i=qC,s=Bg,a=">",c=">=";break;case"<":o=Bg,i=HC,s=jg,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(IC(e,t,n))return!1;for(let u=0;u<t.set.length;++u){let l=t.set[u],d=null,h=null;if(l.forEach(f=>{f.semver===OC&&(f=new Vg(">=0.0.0")),d=d||f,h=h||f,o(f.semver,d.semver,n)?d=f:s(f.semver,h.semver,n)&&(h=f)}),d.operator===a||d.operator===c||(!h.operator||h.operator===a)&&i(e,h.semver))return!1;if(h.operator===c&&s(e,h.semver))return!1}return!0};Gg.exports=kC});var Xg=p((fN,zg)=>{var $C=Es(),MC=(e,t,r)=>$C(e,t,">",r);zg.exports=MC});var Qg=p((hN,Yg)=>{var NC=Es(),DC=(e,t,r)=>NC(e,t,"<",r);Yg.exports=DC});var tv=p((mN,ev)=>{var Zg=Ae(),UC=(e,t,r)=>(e=new Zg(e,r),t=new Zg(t,r),e.intersects(t,r));ev.exports=UC});var nv=p((yN,rv)=>{var LC=Ln(),KC=Se();rv.exports=(e,t,r)=>{let n=[],o=null,i=null,s=e.sort((l,d)=>KC(l,d,r));for(let l of s)LC(l,t,r)?(i=l,o||(o=l)):(i&&n.push([o,i]),i=null,o=null);o&&n.push([o,null]);let a=[];for(let[l,d]of n)l===d?a.push(l):!d&&l===s[0]?a.push("*"):d?l===s[0]?a.push(`<=${d}`):a.push(`${l} - ${d}`):a.push(`>=${l}`);let c=a.join(" || "),u=typeof t.raw=="string"?t.raw:String(t);return c.length<u.length?c:t}});var uv=p((gN,cv)=>{var ov=Ae(),zu=Dn(),{ANY:Gu}=zu,Kn=Ln(),Xu=Se(),WC=(e,t,r={})=>{if(e===t)return!0;e=new ov(e,r),t=new ov(t,r);let n=!1;e:for(let o of e.set){for(let i of t.set){let s=JC(o,i,r);if(n=n||s!==null,s)continue e}if(n)return!1}return!0},FC=[new zu(">=0.0.0-0")],iv=[new zu(">=0.0.0")],JC=(e,t,r)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Gu){if(t.length===1&&t[0].semver===Gu)return!0;r.includePrerelease?e=FC:e=iv}if(t.length===1&&t[0].semver===Gu){if(r.includePrerelease)return!0;t=iv}let n=new Set,o,i;for(let f of e)f.operator===">"||f.operator===">="?o=sv(o,f,r):f.operator==="<"||f.operator==="<="?i=av(i,f,r):n.add(f.semver);if(n.size>1)return null;let s;if(o&&i){if(s=Xu(o.semver,i.semver,r),s>0)return null;if(s===0&&(o.operator!==">="||i.operator!=="<="))return null}for(let f of n){if(o&&!Kn(f,String(o),r)||i&&!Kn(f,String(i),r))return null;for(let y of t)if(!Kn(f,String(y),r))return!1;return!0}let a,c,u,l,d=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,h=o&&!r.includePrerelease&&o.semver.prerelease.length?o.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let f of t){if(l=l||f.operator===">"||f.operator===">=",u=u||f.operator==="<"||f.operator==="<=",o){if(h&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===h.major&&f.semver.minor===h.minor&&f.semver.patch===h.patch&&(h=!1),f.operator===">"||f.operator===">="){if(a=sv(o,f,r),a===f&&a!==o)return!1}else if(o.operator===">="&&!Kn(o.semver,String(f),r))return!1}if(i){if(d&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===d.major&&f.semver.minor===d.minor&&f.semver.patch===d.patch&&(d=!1),f.operator==="<"||f.operator==="<="){if(c=av(i,f,r),c===f&&c!==i)return!1}else if(i.operator==="<="&&!Kn(i.semver,String(f),r))return!1}if(!f.operator&&(i||o)&&s!==0)return!1}return!(o&&u&&!i&&s!==0||i&&l&&!o&&s!==0||h||d)},sv=(e,t,r)=>{if(!e)return t;let n=Xu(e.semver,t.semver,r);return n>0?e:n<0||t.operator===">"&&e.operator===">="?t:e},av=(e,t,r)=>{if(!e)return t;let n=Xu(e.semver,t.semver,r);return n<0?e:n>0||t.operator==="<"&&e.operator==="<="?t:e};cv.exports=WC});var fv=p((vN,pv)=>{var Yu=qr(),lv=Hn(),jC=de(),dv=Mu(),BC=Kt(),VC=Ty(),GC=qy(),zC=$y(),XC=Dy(),YC=Ly(),QC=Wy(),ZC=Jy(),eP=By(),tP=Se(),rP=Xy(),nP=Qy(),oP=ms(),iP=rg(),sP=og(),aP=$n(),cP=ys(),uP=Nu(),lP=Du(),dP=gs(),pP=vs(),fP=Uu(),hP=fg(),mP=Dn(),yP=Ae(),gP=Ln(),vP=$g(),wP=Ng(),bP=Ug(),_P=Wg(),EP=Jg(),SP=Es(),AP=Xg(),RP=Qg(),xP=tv(),CP=nv(),PP=uv();pv.exports={parse:BC,valid:VC,clean:GC,inc:zC,diff:XC,major:YC,minor:QC,patch:ZC,prerelease:eP,compare:tP,rcompare:rP,compareLoose:nP,compareBuild:oP,sort:iP,rsort:sP,gt:aP,lt:cP,eq:uP,neq:lP,gte:dP,lte:pP,cmp:fP,coerce:hP,Comparator:mP,Range:yP,satisfies:gP,toComparators:vP,maxSatisfying:wP,minSatisfying:bP,minVersion:_P,validRange:EP,outside:SP,gtr:AP,ltr:RP,intersects:xP,simplifyRange:CP,subset:PP,SemVer:jC,re:Yu.re,src:Yu.src,tokens:Yu.t,SEMVER_SPEC_VERSION:lv.SEMVER_SPEC_VERSION,RELEASE_TYPES:lv.RELEASE_TYPES,compareIdentifiers:dv.compareIdentifiers,rcompareIdentifiers:dv.rcompareIdentifiers}});var hv=p(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});var OP=fv(),TP=et(),IP=Uc();function qP(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var HP=qP(OP);function kP(e){let t={package:"shopify-app"},r=(o,i={})=>e.warning(o,{...t,...i});function n(o){return function(i,s){if(HP.default.gte(IP.SHOPIFY_REMIX_LIBRARY_VERSION,i))throw new TP.FeatureDeprecatedError(`Feature was deprecated in version ${i}`);return o(`[Deprecated | ${i}] ${s}`)}}return{...e,log:(o,i,s={})=>e.log(o,i,{...t,...s}),debug:(o,i={})=>e.debug(o,{...t,...i}),info:(o,i={})=>e.info(o,{...t,...i}),warning:r,error:(o,i={})=>e.error(o,{...t,...i}),deprecated:n(r)}}Qu.overrideLogger=kP});var yv=p(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});var $P=(Fe(),R(We)),mv=Nc();function MP(e){let{api:t,config:r,logger:n}=e;return async function(i){let a=new URL(i.url).searchParams.get("shop");if(i.method==="GET"&&!a)return{};let c=a||(await i.formData()).get("shop");if(!c)return n.debug("Missing shop parameter",{shop:c}),{shop:mv.LoginErrorType.MissingShop};let u=c.replace(/^https?:\/\//,""),l=c?.indexOf(".")===-1?`${u}.myshopify.com`:u,d=t.utils.sanitizeShop(l);if(!d)return n.debug("Invalid shop parameter",{shop:c}),{shop:mv.LoginErrorType.InvalidShop};let h=`${r.appUrl}${r.auth.path}?shop=${d}`;throw n.info(`Redirecting login request to ${h}`,{shop:d}),$P.redirect(h)}}Zu.loginFactory=MP});var gv=p(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});function NP(e){let{parentHeaders:t,loaderHeaders:r,actionHeaders:n,errorHeaders:o}=e;return o&&Array.from(o.entries()).length>0?o:new Headers([...t?Array.from(t.entries()):[],...r?Array.from(r.entries()):[],...n?Array.from(n.entries()):[]])}el.headersBoundary=NP});var vv=p(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});function DP(e){if(e.constructor.name==="ErrorResponse")return"Handling response";throw e}tl.errorBoundary=DP});var wv=p(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});zl();var Ct=et(),UP=Fr(),Bt=Nc(),LP=Uc(),KP=Jh(),WP=fy(),FP=hy(),JP=my(),jP=hv(),BP=yu();Fe();pt();var VP=yv(),GP=gv(),zP=vv();UP.setAbstractRuntimeString(()=>"Remix");function XP(e){let t=e1(e),r=t1(e,t.config),n=jP.overrideLogger(t.logger);e.webhooks&&t.webhooks.addHandlers(e.webhooks);let o={api:t,config:r,logger:n},i=new WP.AuthStrategy(o),s={sessionStorage:r.sessionStorage,addDocumentResponseHeaders:BP.addDocumentResponseHeadersFactory(o),registerWebhooks:KP.registerWebhooksFactory(o),authenticate:{admin:i.authenticateAdmin.bind(i),public:JP.authenticatePublicFactory(o),webhook:FP.authenticateWebhookFactory(o)}};return(QP(s,e)||ZP(s,e))&&(s.login=VP.loginFactory(o)),s}var YP={error:zP.errorBoundary,headers:GP.headersBoundary};function QP(e,t){return t.distribution===Bt.AppDistribution.AppStore}function ZP(e,t){return t.distribution===Bt.AppDistribution.SingleMerchant}function e1(e){var t,r;let n;try{n=new URL(e.appUrl)}catch{throw new Ct.ShopifyError("Invalid appUrl provided. Please provide a valid URL.")}n.hostname==="localhost"&&!n.port&&process.env.PORT&&(n.port=process.env.PORT),e.appUrl=n.origin;let o=`Shopify Remix Library v${LP.SHOPIFY_REMIX_LIBRARY_VERSION}`;e.userAgentPrefix&&(o=`${e.userAgentPrefix} | ${o}`);let i={...e,hostName:n.host,hostScheme:n.protocol.replace(":",""),userAgentPrefix:o,isEmbeddedApp:(t=e.isEmbeddedApp)!==null&&t!==void 0?t:!0,apiVersion:(r=e.apiVersion)!==null&&r!==void 0?r:Ct.LATEST_API_VERSION,isCustomStoreApp:e.distribution===Bt.AppDistribution.ShopifyAdmin};return Ct.shopifyApi(i)}function t1(e,t){var r,n,o;if(!e.sessionStorage)throw new Ct.ShopifyError("Please provide a valid session storage. See https://github.com/Shopify/shopify-app-js/blob/main/README.md#session-storage-options for options.");let i=e.authPathPrefix||"/auth";return e.distribution=(r=e.distribution)!==null&&r!==void 0?r:Bt.AppDistribution.AppStore,{...e,...t,canUseLoginForm:e.distribution!==Bt.AppDistribution.ShopifyAdmin,useOnlineTokens:(n=e.useOnlineTokens)!==null&&n!==void 0?n:!1,hooks:(o=e.hooks)!==null&&o!==void 0?o:{},sessionStorage:e.sessionStorage,auth:{path:i,callbackPath:`${i}/callback`,patchSessionTokenPath:`${i}/session-token`,exitIframePath:`${i}/exit-iframe`,loginPath:`${i}/login`}}}Object.defineProperty(Je,"BillingInterval",{enumerable:!0,get:function(){return Ct.BillingInterval}});Object.defineProperty(Je,"DeliveryMethod",{enumerable:!0,get:function(){return Ct.DeliveryMethod}});Object.defineProperty(Je,"LATEST_API_VERSION",{enumerable:!0,get:function(){return Ct.LATEST_API_VERSION}});Object.defineProperty(Je,"LogSeverity",{enumerable:!0,get:function(){return Ct.LogSeverity}});Je.AppDistribution=Bt.AppDistribution;Je.LoginErrorType=Bt.LoginErrorType;Je.boundary=YP;Je.shopifyApp=XP});var bv=it(Sv()),r1=it(Av());var _v=it(wv()),n1=it(Rv()),Re=it(ll()),o1=()=>[{rel:"stylesheet",href:pl}];function Ev(){let{apiKey:e,polarisTranslations:t}=ul();return(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)("script",{src:"https://cdn.shopify.com/shopifycloud/app-bridge.js","data-api-key":e}),(0,Re.jsxs)("ui-nav-menu",{children:[(0,Re.jsx)(Fn,{to:"/app",rel:"home",children:"Home"}),(0,Re.jsx)(Fn,{to:"/app/additional",children:"Additional page"})]}),(0,Re.jsx)(dl,{i18n:t,linkComponent:i1,children:(0,Re.jsx)(cl,{})})]})}var i1=bv.default.forwardRef((e,t)=>{var r;return(0,Re.jsx)(Fn,{...e,to:(r=e.url)!=null?r:e.to,ref:t,children:e.children})});function s1(){return _v.boundary.error(al())}export{s1 as ErrorBoundary,Ev as default,o1 as links};
/*! Bundled license information:

cookie/index.js:
  (*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)

@remix-run/server-runtime/dist/esm/warnings.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/cookies.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/formData.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/mode.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/errors.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/responses.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/entry.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/headers.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/invariant.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/routeMatching.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/data.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/routes.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/markup.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/serverHandoff.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/server.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/sessions.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/sessions/cookieStorage.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/sessions/memoryStorage.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/upload/errors.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/upload/memoryUploadHandler.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/dev.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)

@remix-run/server-runtime/dist/esm/index.js:
  (**
   * @remix-run/server-runtime v1.19.1
   *
   * Copyright (c) Remix Software Inc.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   *)
*/
